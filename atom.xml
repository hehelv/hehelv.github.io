<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://hehelv.github.io/</id>
    <title>ğŸ’¤ISpiker</title>
    <updated>2020-02-28T06:37:53.682Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://hehelv.github.io/"/>
    <link rel="self" href="https://hehelv.github.io//atom.xml"/>
    <subtitle>The proof is in the pudding.</subtitle>
    <logo>https://hehelv.github.io//images/avatar.png</logo>
    <icon>https://hehelv.github.io//favicon.ico</icon>
    <rights>All rights reserved 2020, ğŸ’¤ISpiker</rights>
    <entry>
        <title type="html"><![CDATA[6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—]]></title>
        <id>https://hehelv.github.io//post/6-zheng-ze-biao-da-shi-he-re-mo-kuai</id>
        <link href="https://hehelv.github.io//post/6-zheng-ze-biao-da-shi-he-re-mo-kuai">
        </link>
        <updated>2020-02-28T06:37:22.000Z</updated>
        <content type="html"><![CDATA[<h1 id="6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—">6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—</h1>
<h2 id="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼">ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼š</h2>
<p>é€šä¿—ç†è§£ï¼šæŒ‰ç…§ä¸€å®šçš„è§„åˆ™ï¼Œä»æŸä¸ªå­—ç¬¦ä¸²ä¸­åŒ¹é…å‡ºæƒ³è¦çš„æ•°æ®ã€‚è¿™ä¸ªè§„åˆ™å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚<br>
æ ‡å‡†ç­”æ¡ˆï¼šhttps://baike.baidu.com/item/æ­£åˆ™è¡¨è¾¾å¼/1700215?fr=aladdin</p>
<h2 id="ä¸€ä¸ªæ®µå­">ä¸€ä¸ªæ®µå­ï¼š</h2>
<p>ä¸–ç•Œæ˜¯åˆ†ä¸ºä¸¤ç§äººï¼Œä¸€ç§æ˜¯æ‡‚æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œä¸€ç§æ˜¯ä¸æ‡‚æ­£åˆ™è¡¨è¾¾å¼çš„ã€‚</p>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨åŒ¹é…è§„åˆ™">æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨åŒ¹é…è§„åˆ™ï¼š</h2>
<h3 id="åŒ¹é…æŸä¸ªå­—ç¬¦ä¸²">åŒ¹é…æŸä¸ªå­—ç¬¦ä¸²ï¼š</h3>
<pre><code class="language-python">text = 'hello'
ret = re.match('he',text)
print(ret.group())
&gt;&gt; he
</code></pre>
<p>ä»¥ä¸Šä¾¿å¯ä»¥åœ¨<code>hello</code>ä¸­ï¼ŒåŒ¹é…å‡º<code>he</code>ã€‚</p>
<h3 id="ç‚¹åŒ¹é…ä»»æ„çš„å­—ç¬¦">ç‚¹ï¼ˆ.ï¼‰åŒ¹é…ä»»æ„çš„å­—ç¬¦ï¼š</h3>
<pre><code class="language-python">text = &quot;ab&quot;
ret = re.match('.',text)
print(ret.group())
&gt;&gt; a
</code></pre>
<p>ä½†æ˜¯ç‚¹ï¼ˆ.ï¼‰ä¸èƒ½åŒ¹é…ä¸åˆ°æ¢è¡Œç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;ab&quot;
ret = re.match('.',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="dåŒ¹é…ä»»æ„çš„æ•°å­—">\dåŒ¹é…ä»»æ„çš„æ•°å­—ï¼š</h3>
<pre><code class="language-python">text = &quot;123&quot;
ret = re.match('\d',text)
print(ret.group())
&gt;&gt; 1
</code></pre>
<h3 id="dåŒ¹é…ä»»æ„çš„éæ•°å­—">\DåŒ¹é…ä»»æ„çš„éæ•°å­—ï¼š</h3>
<pre><code class="language-python">text = &quot;a&quot;
ret = re.match('\D',text)
print(ret.group())
&gt;&gt; a
</code></pre>
<p>è€Œå¦‚æœtextæ˜¯ç­‰äºä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸æˆåŠŸäº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;1&quot;
ret = re.match('\D',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="såŒ¹é…çš„æ˜¯ç©ºç™½å­—ç¬¦åŒ…æ‹¬ntrå’Œç©ºæ ¼">\såŒ¹é…çš„æ˜¯ç©ºç™½å­—ç¬¦ï¼ˆåŒ…æ‹¬ï¼š\nï¼Œ\tï¼Œ\rå’Œç©ºæ ¼ï¼‰ï¼š</h3>
<pre><code class="language-python">text = &quot;\t&quot;
ret = re.match('\s',text)
print(ret.group())
&gt;&gt; ç©ºç™½
</code></pre>
<h3 id="wåŒ¹é…çš„æ˜¯a-zå’Œa-zä»¥åŠæ•°å­—å’Œä¸‹åˆ’çº¿">\wåŒ¹é…çš„æ˜¯<code>a-z</code>å’Œ<code>A-Z</code>ä»¥åŠæ•°å­—å’Œä¸‹åˆ’çº¿ï¼š</h3>
<pre><code class="language-python">text = &quot;_&quot;
ret = re.match('\w',text)
print(ret.group())
&gt;&gt; _
</code></pre>
<p>è€Œå¦‚æœè¦åŒ¹é…ä¸€ä¸ªå…¶ä»–çš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;+&quot;
ret = re.match('\w',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
<h3 id="wåŒ¹é…çš„æ˜¯å’Œwç›¸åçš„">\WåŒ¹é…çš„æ˜¯å’Œ\wç›¸åçš„ï¼š</h3>
<pre><code class="language-python">text = &quot;+&quot;
ret = re.match('\W',text)
print(ret.group())
&gt;&gt; +
</code></pre>
<p>è€Œå¦‚æœä½ çš„textæ˜¯ä¸€ä¸ªä¸‹åˆ’çº¿æˆ–è€…è‹±æ–‡å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;_&quot;
ret = re.match('\W',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
<h3 id="ç»„åˆçš„æ–¹å¼åªè¦æ»¡è¶³ä¸­æ‹¬å·ä¸­çš„æŸä¸€é¡¹éƒ½ç®—åŒ¹é…æˆåŠŸ">[]ç»„åˆçš„æ–¹å¼ï¼Œåªè¦æ»¡è¶³ä¸­æ‹¬å·ä¸­çš„æŸä¸€é¡¹éƒ½ç®—åŒ¹é…æˆåŠŸï¼š</h3>
<pre><code class="language-python">text = &quot;0731-88888888&quot;
ret = re.match('[\d\-]+',text)
print(ret.group())
&gt;&gt; 0731-88888888
</code></pre>
<p>ä¹‹å‰è®²åˆ°çš„å‡ ç§åŒ¹é…è§„åˆ™ï¼Œå…¶å®å¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·çš„å½¢å¼æ¥è¿›è¡Œæ›¿ä»£ï¼š</p>
<ul>
<li>\dï¼š[0-9]</li>
<li>\Dï¼š<a href="#fn_0-9">0-9</a></li>
<li>\wï¼š[0-9a-zA-Z_]</li>
<li>\Wï¼š[^0-9a-zA-Z_]</li>
</ul>
<h3 id="åŒ¹é…å¤šä¸ªå­—ç¬¦">åŒ¹é…å¤šä¸ªå­—ç¬¦ï¼š</h3>
<ol>
<li>
<p><code>*</code>ï¼šå¯ä»¥åŒ¹é…0æˆ–è€…ä»»æ„å¤šä¸ªå­—ç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;0731&quot;
 ret = re.match('\d*',text)
 print(ret.group())
 &gt;&gt; 0731
</code></pre>
<p>ä»¥ä¸Šå› ä¸ºåŒ¹é…çš„è¦æ±‚æ˜¯<code>\d</code>ï¼Œé‚£ä¹ˆå°±è¦æ±‚æ˜¯æ•°å­—ï¼Œåé¢è·Ÿäº†ä¸€ä¸ªæ˜Ÿå·ï¼Œå°±å¯ä»¥åŒ¹é…åˆ°0731è¿™å››ä¸ªå­—ç¬¦ã€‚</p>
</li>
<li>
<p><code>+</code>ï¼šå¯ä»¥åŒ¹é…1ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ã€‚æœ€å°‘ä¸€ä¸ªã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;abc&quot;
 ret = re.match('\w+',text)
 print(ret.group())
 &gt;&gt; abc
</code></pre>
<p>å› ä¸ºåŒ¹é…çš„æ˜¯<code>\w</code>ï¼Œé‚£ä¹ˆå°±è¦æ±‚æ˜¯è‹±æ–‡å­—ç¬¦ï¼Œåé¢è·Ÿäº†ä¸€ä¸ªåŠ å·ï¼Œæ„å‘³ç€æœ€å°‘è¦æœ‰ä¸€ä¸ªæ»¡è¶³<code>\w</code>çš„å­—ç¬¦æ‰èƒ½å¤ŸåŒ¹é…åˆ°ã€‚å¦‚æœtextæ˜¯ä¸€ä¸ªç©ºç™½å­—ç¬¦æˆ–è€…æ˜¯ä¸€ä¸ªä¸æ»¡è¶³\wçš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;&quot;
 ret = re.match('\w+',text)
 print(ret.group())
 &gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
</li>
<li>
<p><code>?</code>ï¼šåŒ¹é…çš„å­—ç¬¦å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…ä¸å‡ºç°ï¼ˆ0æˆ–è€…1ï¼‰ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d?',text)
 print(ret.group())
 &gt;&gt; 1
</code></pre>
</li>
<li>
<p><code>{m}</code>ï¼šåŒ¹é…mä¸ªå­—ç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d{2}',text)
 print(ret.group())
 &gt;&gt; 12
</code></pre>
</li>
<li>
<p><code>{m,n}</code>ï¼šåŒ¹é…m-nä¸ªå­—ç¬¦ã€‚åœ¨è¿™ä¸­é—´çš„å­—ç¬¦éƒ½å¯ä»¥åŒ¹é…åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d{1,2}',text)
 prit(ret.group())
 &gt;&gt; 12
</code></pre>
<p>å¦‚æœtextåªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥åŒ¹é…å‡ºæ¥ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;1&quot;
 ret = re.match('\d{1,2}',text)
 prit(ret.group())
 &gt;&gt; 1
</code></pre>
</li>
</ol>
<h3 id="å°æ¡ˆä¾‹">å°æ¡ˆä¾‹ï¼š</h3>
<ol>
<li>
<p>éªŒè¯æ‰‹æœºå·ç ï¼šæ‰‹æœºå·ç çš„è§„åˆ™æ˜¯ä»¥<code>1</code>å¼€å¤´ï¼Œç¬¬äºŒä½å¯ä»¥æ˜¯<code>34587</code>ï¼Œåé¢é‚£9ä½å°±å¯ä»¥éšæ„äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;18570631587&quot;
 ret = re.match('1[34587]\d{9}',text)
 print(ret.group())
 &gt;&gt; 18570631587
</code></pre>
<p>è€Œå¦‚æœæ˜¯ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„æ‰‹æœºå·ç ã€‚é‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;1857063158&quot;
 ret = re.match('1[34587]\d{9}',text)
 print(ret.group())
 &gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
</li>
<li>
<p>éªŒè¯é‚®ç®±ï¼šé‚®ç®±çš„è§„åˆ™æ˜¯é‚®ç®±åç§°æ˜¯ç”¨<code>æ•°å­—ã€æ•°å­—ã€ä¸‹åˆ’çº¿</code>ç»„æˆçš„ï¼Œç„¶åæ˜¯<code>@</code>ç¬¦å·ï¼Œåé¢å°±æ˜¯åŸŸåäº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;hynever@163.com&quot;
 ret = re.match('\w+@\w+\.[a-zA-Z\.]+',text)
 print(ret.group())
</code></pre>
</li>
<li>
<p>éªŒè¯URLï¼šURLçš„è§„åˆ™æ˜¯å‰é¢æ˜¯<code>http</code>æˆ–è€…<code>https</code>æˆ–è€…æ˜¯<code>ftp</code>ç„¶åå†åŠ ä¸Šä¸€ä¸ªå†’å·ï¼Œå†åŠ ä¸Šä¸€ä¸ªæ–œæ ï¼Œå†åé¢å°±æ˜¯å¯ä»¥å‡ºç°ä»»æ„éç©ºç™½å­—ç¬¦äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;http://www.baidu.com/&quot;
 ret = re.match('(http|https|ftp)://[^\s]+',text)
 print(ret.group())
</code></pre>
</li>
<li>
<p>éªŒè¯èº«ä»½è¯ï¼šèº«ä»½è¯çš„è§„åˆ™æ˜¯ï¼Œæ€»å…±æœ‰18ä½ï¼Œå‰é¢17ä½éƒ½æ˜¯æ•°å­—ï¼Œåé¢ä¸€ä½å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯å°å†™çš„xï¼Œä¹Ÿå¯ä»¥æ˜¯å¤§å†™çš„Xã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;3113111890812323X&quot;
 ret = re.match('\d{17}[\dxX]',text)
 print(ret.group())
</code></pre>
</li>
</ol>
<h3 id="è„±å­—å·è¡¨ç¤ºä»¥å¼€å§‹">^ï¼ˆè„±å­—å·ï¼‰ï¼šè¡¨ç¤ºä»¥...å¼€å§‹ï¼š</h3>
<pre><code class="language-python">text = &quot;hello&quot;
ret = re.match('^h',text)
print(ret.group())
</code></pre>
<p>å¦‚æœæ˜¯åœ¨ä¸­æ‹¬å·ä¸­ï¼Œé‚£ä¹ˆä»£è¡¨çš„æ˜¯å–åæ“ä½œ.</p>
<h3 id="è¡¨ç¤ºä»¥ç»“æŸ">$ï¼šè¡¨ç¤ºä»¥...ç»“æŸï¼š</h3>
<pre><code class="language-python"># åŒ¹é…163.comçš„é‚®ç®±
text = &quot;xxx@163.com&quot;
ret = re.search('\w+@163\.com$',text)
print(ret.group())
&gt;&gt; xxx@163.com
</code></pre>
<h3 id="åŒ¹é…å¤šä¸ªè¡¨è¾¾å¼æˆ–è€…å­—ç¬¦ä¸²">|ï¼šåŒ¹é…å¤šä¸ªè¡¨è¾¾å¼æˆ–è€…å­—ç¬¦ä¸²ï¼š</h3>
<pre><code class="language-python">text = &quot;hello|world&quot;
ret = re.search('hello',text)
print(ret.group())
&gt;&gt; hello
</code></pre>
<h3 id="è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼">è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼ï¼š</h3>
<p>è´ªå©ªæ¨¡å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…å°½é‡å¤šçš„å­—ç¬¦ã€‚é»˜è®¤æ˜¯è´ªå©ªæ¨¡å¼ã€‚<br>
éè´ªå©ªæ¨¡å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¼šå°½é‡å°‘çš„åŒ¹é…å­—ç¬¦ã€‚<br>
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;0123456&quot;
ret = re.match('\d+',text)
print(ret.group())
# å› ä¸ºé»˜è®¤é‡‡ç”¨è´ªå©ªæ¨¡å¼ï¼Œæ‰€ä»¥ä¼šè¾“å‡º0123456
&gt;&gt; 0123456
</code></pre>
<p>å¯ä»¥æ”¹æˆéè´ªå©ªæ¨¡å¼ï¼Œé‚£ä¹ˆå°±åªä¼šåŒ¹é…åˆ°0ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;0123456&quot;
ret = re.match('\d+?',text)
print(ret.group())
</code></pre>
<h3 id="æ¡ˆä¾‹åŒ¹é…0-100ä¹‹é—´çš„æ•°å­—">æ¡ˆä¾‹ï¼šåŒ¹é…<code>0-100</code>ä¹‹é—´çš„æ•°å­—ï¼š</h3>
<pre><code class="language-python">text = '99'
ret = re.match('[1-9]?\d$|100$',text)
print(ret.group())
&gt;&gt; 99
</code></pre>
<p>è€Œå¦‚æœ<code>text=101</code>ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = '101'
ret = re.match('[1-9]?\d$|100$',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="è½¬ä¹‰å­—ç¬¦å’ŒåŸç”Ÿå­—ç¬¦ä¸²">è½¬ä¹‰å­—ç¬¦å’ŒåŸç”Ÿå­—ç¬¦ä¸²ï¼š</h3>
<p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œæœ‰äº›å­—ç¬¦æ˜¯æœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦ã€‚å› æ­¤å¦‚æœæƒ³è¦åŒ¹é…è¿™äº›å­—ç¬¦ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ã€‚æ¯”å¦‚<code>$</code>ä»£è¡¨çš„æ˜¯ä»¥...ç»“å°¾ï¼Œå¦‚æœæƒ³è¦åŒ¹é…<code>$</code>ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨<code>\$</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;apple price is \$99,orange paice is $88&quot;
ret = re.search('\$(\d+)',text)
print(ret.group())
&gt;&gt; $99
</code></pre>
<p>åŸç”Ÿå­—ç¬¦ä¸²ï¼š<br>
åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ<code>\</code>æ˜¯ä¸“é—¨ç”¨æ¥åšè½¬ä¹‰çš„ã€‚åœ¨Pythonä¸­<code>\</code>ä¹Ÿæ˜¯ç”¨æ¥åšè½¬ä¹‰çš„ã€‚å› æ­¤å¦‚æœæƒ³è¦åœ¨æ™®é€šçš„å­—ç¬¦ä¸²ä¸­åŒ¹é…å‡º<code>\</code>ï¼Œé‚£ä¹ˆè¦ç»™å‡ºå››ä¸ª<code>\</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;apple \c&quot;
ret = re.search('\\\\c',text)
print(ret.group())
</code></pre>
<p>å› æ­¤è¦ä½¿ç”¨åŸç”Ÿå­—ç¬¦ä¸²å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="language-python">text = &quot;apple \c&quot;
ret = re.search(r'\\c',text)
print(ret.group())
</code></pre>
<hr>
<h2 id="reæ¨¡å—ä¸­å¸¸ç”¨å‡½æ•°">reæ¨¡å—ä¸­å¸¸ç”¨å‡½æ•°ï¼š</h2>
<h3 id="match">matchï¼š</h3>
<p>ä»å¼€å§‹çš„ä½ç½®è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœå¼€å§‹çš„ä½ç½®æ²¡æœ‰åŒ¹é…åˆ°ã€‚å°±ç›´æ¥å¤±è´¥äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = 'hello'
ret = re.match('h',text)
print(ret.group())
&gt;&gt; h
</code></pre>
<p>å¦‚æœç¬¬ä¸€ä¸ªå­—æ¯ä¸æ˜¯<code>h</code>ï¼Œé‚£ä¹ˆå°±ä¼šå¤±è´¥ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = 'ahello'
ret = re.match('h',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<p>å¦‚æœæƒ³è¦åŒ¹é…æ¢è¡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆå°±è¦ä¼ å…¥ä¸€ä¸ª<code>flag=re.DOTALL</code>ï¼Œå°±å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;abc\nabc&quot;
ret = re.match('abc.*abc',text,re.DOTALL)
print(ret.group())
</code></pre>
<h3 id="search">searchï¼š</h3>
<p>åœ¨å­—ç¬¦ä¸²ä¸­æ‰¾æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚å¦‚æœæ‰¾åˆ°ï¼Œå°±è¿”å›ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯åªä¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.search('\d+',text)
print(ret.group())
&gt;&gt; 99
</code></pre>
<h3 id="åˆ†ç»„">åˆ†ç»„ï¼š</h3>
<p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå¯ä»¥å¯¹è¿‡æ»¤åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œåˆ†ç»„ã€‚åˆ†ç»„ä½¿ç”¨åœ†æ‹¬å·çš„æ–¹å¼ã€‚</p>
<ol>
<li><code>group</code>ï¼šå’Œ<code>group(0)</code>æ˜¯ç­‰ä»·çš„ï¼Œè¿”å›çš„æ˜¯æ•´ä¸ªæ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ã€‚</li>
<li><code>groups</code>ï¼šè¿”å›çš„æ˜¯é‡Œé¢çš„å­ç»„ã€‚ç´¢å¼•ä»1å¼€å§‹ã€‚</li>
<li><code>group(1)</code>ï¼šè¿”å›çš„æ˜¯ç¬¬ä¸€ä¸ªå­ç»„ï¼Œå¯ä»¥ä¼ å…¥å¤šä¸ªã€‚<br>
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-python">text = &quot;apple price is $99,orange price is $10&quot;
ret = re.search(r&quot;.*(\$\d+).*(\$\d+)&quot;,text)
print(ret.group())
print(ret.group(0))
print(ret.group(1))
print(ret.group(2))
print(ret.groups())
</code></pre>
<h3 id="findall">findallï¼š</h3>
<p>æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.findall('\d+',text)
print(ret)
&gt;&gt; ['99', '88']
</code></pre>
<h3 id="sub">subï¼š</h3>
<p>ç”¨æ¥æ›¿æ¢å­—ç¬¦ä¸²ã€‚å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºå…¶ä»–å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.sub('\d+','0',text)
print(ret)
&gt;&gt; apple price $0 orange price $0
</code></pre>
<p><code>sub</code>å‡½æ•°çš„æ¡ˆä¾‹ï¼Œè·å–æ‹‰å‹¾ç½‘ä¸­çš„æ•°æ®ï¼š</p>
<pre><code class="language-python">html = &quot;&quot;&quot;
&lt;div&gt;
&lt;p&gt;åŸºæœ¬è¦æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç²¾é€šHTML5ã€CSS3ã€ JavaScriptç­‰Webå‰ç«¯å¼€å‘æŠ€æœ¯ï¼Œå¯¹html5é¡µé¢é€‚é…å……åˆ†äº†è§£ï¼Œç†Ÿæ‚‰ä¸åŒæµè§ˆå™¨é—´çš„å·®å¼‚ï¼Œç†Ÿç»ƒå†™å‡ºå…¼å®¹å„ç§æµè§ˆå™¨çš„ä»£ç ï¼›&lt;/p&gt;
&lt;p&gt;2ã€ç†Ÿæ‚‰è¿ç”¨å¸¸è§JSå¼€å‘æ¡†æ¶ï¼Œå¦‚JQueryã€vueã€angularï¼Œèƒ½å¿«é€Ÿé«˜æ•ˆå®ç°å„ç§äº¤äº’æ•ˆæœï¼›&lt;/p&gt;
&lt;p&gt;3ã€ç†Ÿæ‚‰ç¼–å†™èƒ½å¤Ÿè‡ªåŠ¨é€‚åº”HTML5ç•Œé¢ï¼Œèƒ½è®©ç½‘é¡µæ ¼å¼è‡ªåŠ¨é€‚åº”å„æ¬¾å„å¤§å°çš„æ‰‹æœºï¼›&lt;/p&gt;
&lt;p&gt;4ã€åˆ©ç”¨HTML5ç›¸å…³æŠ€æœ¯å¼€å‘ç§»åŠ¨å¹³å°ã€PCç»ˆç«¯çš„å‰ç«¯é¡µé¢ï¼Œå®ç°HTML5æ¨¡æ¿åŒ–ï¼›&lt;/p&gt;
&lt;p&gt;5ã€ç†Ÿæ‚‰æ‰‹æœºç«¯å’ŒPCç«¯webå®ç°çš„å·®å¼‚ï¼Œæœ‰ç§»åŠ¨å¹³å°webå‰ç«¯å¼€å‘ç»éªŒï¼Œäº†è§£ç§»åŠ¨äº’è”ç½‘äº§å“å’Œè¡Œä¸šï¼Œæœ‰åœ¨Android,iOSç­‰å¹³å°ä¸‹HTML5+CSS+JavaScriptï¼ˆæˆ–ç§»åŠ¨JSæ¡†æ¶ï¼‰å¼€å‘ç»éªŒè€…ä¼˜å…ˆè€ƒè™‘ï¼›6ã€è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåä½œç²¾ç¥ï¼Œå¯¹ç§»åŠ¨äº’è”ç½‘è¡Œä¸šæœ‰æµ“åšå…´è¶£ï¼Œæœ‰è¾ƒå¼ºçš„ç ”ç©¶èƒ½åŠ›å’Œå­¦ä¹ èƒ½åŠ›ï¼›&lt;/p&gt;
&lt;p&gt;7ã€èƒ½å¤Ÿæ‰¿æ‹…å…¬å¸å‰ç«¯åŸ¹è®­å·¥ä½œï¼Œå¯¹å…¬å¸å„ä¸šåŠ¡çº¿çš„å‰ç«¯ï¼ˆHTML5\CSS3ï¼‰å·¥ä½œè¿›è¡Œæ”¯æ’‘å’ŒæŒ‡å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;å²—ä½èŒè´£ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åˆ©ç”¨html5åŠç›¸å…³æŠ€æœ¯å¼€å‘ç§»åŠ¨å¹³å°ã€å¾®ä¿¡ã€APPç­‰å‰ç«¯é¡µé¢ï¼Œå„ç±»äº¤äº’çš„å®ç°ï¼›&lt;/p&gt;
&lt;p&gt;2ã€æŒç»­çš„ä¼˜åŒ–å‰ç«¯ä½“éªŒå’Œé¡µé¢å“åº”é€Ÿåº¦ï¼Œå¹¶ä¿è¯å…¼å®¹æ€§å’Œæ‰§è¡Œæ•ˆç‡ï¼›&lt;/p&gt;
&lt;p&gt;3ã€æ ¹æ®äº§å“éœ€æ±‚ï¼Œåˆ†æå¹¶ç»™å‡ºæœ€ä¼˜çš„é¡µé¢å‰ç«¯ç»“æ„è§£å†³æ–¹æ¡ˆï¼›&lt;/p&gt;
&lt;p&gt;4ã€ååŠ©åå°åŠå®¢æˆ·ç«¯å¼€å‘äººå‘˜å®ŒæˆåŠŸèƒ½å¼€å‘å’Œè°ƒè¯•ï¼›&lt;/p&gt;
&lt;p&gt;5ã€ç§»åŠ¨ç«¯ä¸»æµæµè§ˆå™¨çš„é€‚é…ã€ç§»åŠ¨ç«¯ç•Œé¢è‡ªé€‚åº”ç ”å‘ã€‚&lt;/p&gt;
&lt;/div&gt;
&quot;&quot;&quot;

ret = re.sub('&lt;/?[a-zA-Z0-9]+&gt;',&quot;&quot;,html)
print(ret)
</code></pre>
<h3 id="split">splitï¼š</h3>
<p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ†å‰²å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-python">text = &quot;hello world ni hao&quot;
ret = re.split('\W',text)
print(ret)
&gt;&gt; [&quot;hello&quot;,&quot;world&quot;,&quot;ni&quot;,&quot;hao&quot;]
</code></pre>
<h3 id="compile">compileï¼š</h3>
<p>å¯¹äºä¸€äº›ç»å¸¸è¦ç”¨åˆ°çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>compile</code>è¿›è¡Œç¼–è¯‘ï¼ŒåæœŸå†ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥æ‹¿è¿‡æ¥ç”¨ï¼Œæ‰§è¡Œæ•ˆç‡ä¼šæ›´å¿«ã€‚è€Œä¸”<code>compile</code>è¿˜å¯ä»¥æŒ‡å®š<code>flag=re.VERBOSE</code>ï¼Œåœ¨å†™æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™å¯ä»¥åšå¥½æ³¨é‡Šã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;the number is 20.50&quot;
r = re.compile(r&quot;&quot;&quot;
                \d+ # å°æ•°ç‚¹å‰é¢çš„æ•°å­—
                \.? # å°æ•°ç‚¹
                \d* # å°æ•°ç‚¹åé¢çš„æ•°å­—
                &quot;&quot;&quot;,re.VERBOSE)
ret = re.search(r,text)
print(ret.group())
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[5-BeautifulSoup4åº“]]></title>
        <id>https://hehelv.github.io//post/5-beautifulsoup4-ku</id>
        <link href="https://hehelv.github.io//post/5-beautifulsoup4-ku">
        </link>
        <updated>2020-02-28T06:36:42.000Z</updated>
        <content type="html"><![CDATA[<h1 id="5-beautifulsoup4åº“">5-BeautifulSoup4åº“</h1>
<p>å’Œ lxml ä¸€æ ·ï¼ŒBeautiful Soup ä¹Ÿæ˜¯ä¸€ä¸ªHTML/XMLçš„è§£æå™¨ï¼Œä¸»è¦çš„åŠŸèƒ½ä¹Ÿæ˜¯å¦‚ä½•è§£æå’Œæå– HTML/XML æ•°æ®ã€‚<br>
lxml åªä¼šå±€éƒ¨éå†ï¼Œè€ŒBeautiful Soup æ˜¯åŸºäºHTML DOMï¼ˆDocument Object Modelï¼‰çš„ï¼Œä¼šè½½å…¥æ•´ä¸ªæ–‡æ¡£ï¼Œè§£ææ•´ä¸ªDOMæ ‘ï¼Œå› æ­¤æ—¶é—´å’Œå†…å­˜å¼€é”€éƒ½ä¼šå¤§å¾ˆå¤šï¼Œæ‰€ä»¥æ€§èƒ½è¦ä½äºlxmlã€‚<br>
BeautifulSoup ç”¨æ¥è§£æ HTML æ¯”è¾ƒç®€å•ï¼ŒAPIéå¸¸äººæ€§åŒ–ï¼Œæ”¯æŒCSSé€‰æ‹©å™¨ã€Pythonæ ‡å‡†åº“ä¸­çš„HTMLè§£æå™¨ï¼Œä¹Ÿæ”¯æŒ lxml çš„ XMLè§£æå™¨ã€‚<br>
Beautiful Soup 3 ç›®å‰å·²ç»åœæ­¢å¼€å‘ï¼Œæ¨èç°åœ¨çš„é¡¹ç›®ä½¿ç”¨Beautiful Soup 4ã€‚</p>
<h2 id="å®‰è£…å’Œæ–‡æ¡£">å®‰è£…å’Œæ–‡æ¡£ï¼š</h2>
<ol>
<li>å®‰è£…ï¼š<code>pip install bs4</code>ã€‚</li>
<li>ä¸­æ–‡æ–‡æ¡£ï¼šhttps://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</li>
</ol>
<h2 id="å‡ å¤§è§£æå·¥å…·å¯¹æ¯”">å‡ å¤§è§£æå·¥å…·å¯¹æ¯”ï¼š</h2>
<table>
<thead>
<tr>
<th>è§£æå·¥å…·</th>
<th>è§£æé€Ÿåº¦</th>
<th>ä½¿ç”¨éš¾åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>BeautifulSoup</td>
<td>æœ€æ…¢</td>
<td>æœ€ç®€å•</td>
</tr>
<tr>
<td>lxml</td>
<td>å¿«</td>
<td>ç®€å•</td>
</tr>
<tr>
<td>æ­£åˆ™</td>
<td>æœ€å¿«</td>
<td>æœ€éš¾</td>
</tr>
</tbody>
</table>
<h2 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨ï¼š</h2>
<pre><code class="language-python">from bs4 import BeautifulSoup

html = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

#åˆ›å»º Beautiful Soup å¯¹è±¡
# ä½¿ç”¨lxmlæ¥è¿›è¡Œè§£æ
soup = BeautifulSoup(html,&quot;lxml&quot;)

print(soup.prettify())
</code></pre>
<h2 id="å››ä¸ªå¸¸ç”¨çš„å¯¹è±¡">å››ä¸ªå¸¸ç”¨çš„å¯¹è±¡ï¼š</h2>
<p>Beautiful Soupå°†å¤æ‚HTMLæ–‡æ¡£è½¬æ¢æˆä¸€ä¸ªå¤æ‚çš„æ ‘å½¢ç»“æ„,æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯Pythonå¯¹è±¡,æ‰€æœ‰å¯¹è±¡å¯ä»¥å½’çº³ä¸º4ç§:</p>
<ol>
<li>Tag</li>
<li>NavigatableString</li>
<li>BeautifulSoup</li>
<li>Comment</li>
</ol>
<h3 id="1-tag">1. Tagï¼š</h3>
<p>Tag é€šä¿—ç‚¹è®²å°±æ˜¯ HTML ä¸­çš„ä¸€ä¸ªä¸ªæ ‡ç­¾ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">(from bs4 import BeautifulSoup)

html = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

#åˆ›å»º Beautiful Soup å¯¹è±¡
soup = BeautifulSoup(html,'lxml')


print (soup.title)
# &lt;title&gt;The Dormouse's story&lt;/title&gt;

print (soup.head)
# &lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;

print (soup.a)
# &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;

print( soup.p)
# &lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;

print (type(soup.p))
# &lt;class 'bs4.element.Tag'&gt;
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ soup åŠ æ ‡ç­¾åè½»æ¾åœ°è·å–è¿™äº›æ ‡ç­¾çš„å†…å®¹ï¼Œè¿™äº›å¯¹è±¡çš„ç±»å‹æ˜¯bs4.element.Tagã€‚ä½†æ˜¯æ³¨æ„ï¼Œå®ƒæŸ¥æ‰¾çš„æ˜¯åœ¨æ‰€æœ‰å†…å®¹ä¸­çš„ç¬¬ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„æ ‡ç­¾ã€‚å¦‚æœè¦æŸ¥è¯¢æ‰€æœ‰çš„æ ‡ç­¾ï¼Œåé¢ä¼šè¿›è¡Œä»‹ç»ã€‚<br>
å¯¹äºTagï¼Œå®ƒæœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼Œåˆ†åˆ«æ˜¯nameå’Œattrsã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print soup.name
# [document] #soup å¯¹è±¡æœ¬èº«æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„ name å³ä¸º [document]

print soup.head.name
# head #å¯¹äºå…¶ä»–å†…éƒ¨æ ‡ç­¾ï¼Œè¾“å‡ºçš„å€¼ä¾¿ä¸ºæ ‡ç­¾æœ¬èº«çš„åç§°

print soup.p.attrs
# {'class': ['title'], 'name': 'dromouse'}
# åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ p æ ‡ç­¾çš„æ‰€æœ‰å±æ€§æ‰“å°è¾“å‡ºäº†å‡ºæ¥ï¼Œå¾—åˆ°çš„ç±»å‹æ˜¯ä¸€ä¸ªå­—å…¸ã€‚

print soup.p['class'] # soup.p.get('class')
# ['title'] #è¿˜å¯ä»¥åˆ©ç”¨getæ–¹æ³•ï¼Œä¼ å…¥å±æ€§çš„åç§°ï¼ŒäºŒè€…æ˜¯ç­‰ä»·çš„

soup.p['class'] = &quot;newClass&quot;
print soup.p # å¯ä»¥å¯¹è¿™äº›å±æ€§å’Œå†…å®¹ç­‰ç­‰è¿›è¡Œä¿®æ”¹
# &lt;p class=&quot;newClass&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
</code></pre>
<h3 id="2-navigablestring">2. NavigableStringï¼š</h3>
<p>å¦‚æœæ‹¿åˆ°æ ‡ç­¾åï¼Œè¿˜æƒ³è·å–æ ‡ç­¾ä¸­çš„å†…å®¹ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡<code>tag.string</code>è·å–æ ‡ç­¾ä¸­çš„æ–‡å­—ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print (soup.p.string)
# The Dormouse's story

print (type(soup.p.string))
# &lt;class 'bs4.element.NavigableString'&gt;thon
</code></pre>
<h3 id="3-beautifulsoup">3. BeautifulSoupï¼š</h3>
<p>BeautifulSoup å¯¹è±¡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ–‡æ¡£çš„å…¨éƒ¨å†…å®¹.å¤§éƒ¨åˆ†æ—¶å€™,å¯ä»¥æŠŠå®ƒå½“ä½œ Tag å¯¹è±¡,å®ƒæ”¯æŒ éå†æ–‡æ¡£æ ‘ å’Œ æœç´¢æ–‡æ¡£æ ‘ ä¸­æè¿°çš„å¤§éƒ¨åˆ†çš„æ–¹æ³•.<br>
å› ä¸º BeautifulSoup å¯¹è±¡å¹¶ä¸æ˜¯çœŸæ­£çš„HTMLæˆ–XMLçš„tag,æ‰€ä»¥å®ƒæ²¡æœ‰nameå’Œattributeå±æ€§.ä½†æœ‰æ—¶æŸ¥çœ‹å®ƒçš„ .name å±æ€§æ˜¯å¾ˆæ–¹ä¾¿çš„,æ‰€ä»¥ BeautifulSoup å¯¹è±¡åŒ…å«äº†ä¸€ä¸ªå€¼ä¸º â€œ[document]â€ çš„ç‰¹æ®Šå±æ€§ .name</p>
<pre><code class="language-python">soup.name
# '[document]'
</code></pre>
<h3 id="4-comment">4. Commentï¼š</h3>
<p>Tag , NavigableString , BeautifulSoup å‡ ä¹è¦†ç›–äº†htmlå’Œxmlä¸­çš„æ‰€æœ‰å†…å®¹,ä½†æ˜¯è¿˜æœ‰ä¸€äº›ç‰¹æ®Šå¯¹è±¡.å®¹æ˜“è®©äººæ‹…å¿ƒçš„å†…å®¹æ˜¯æ–‡æ¡£çš„æ³¨é‡Šéƒ¨åˆ†:</p>
<pre><code class="language-python">markup = &quot;&lt;b&gt;&lt;!--Hey, buddy. Want to buy a used parser?--&gt;&lt;/b&gt;&quot;
soup = BeautifulSoup(markup)
comment = soup.b.string
type(comment)
# &lt;class 'bs4.element.Comment'&gt;
</code></pre>
<p>Comment å¯¹è±¡æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„ NavigableString å¯¹è±¡:</p>
<pre><code class="language-python">comment
# 'Hey, buddy. Want to buy a used parser'
</code></pre>
<h2 id="éå†æ–‡æ¡£æ ‘">éå†æ–‡æ¡£æ ‘ï¼š</h2>
<h3 id="1-contentså’Œchildren">1. contentså’Œchildrenï¼š</h3>
<pre><code class="language-python">html_doc = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;

&lt;p class=&quot;title&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;

&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;

&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

from bs4 import BeautifulSoup
soup = BeautifulSoup(html_doc,'lxml')

head_tag = soup.head
# è¿”å›æ‰€æœ‰å­èŠ‚ç‚¹çš„åˆ—è¡¨
print(head_tag.contents)

# è¿”å›æ‰€æœ‰å­èŠ‚ç‚¹çš„è¿­ä»£å™¨
for child in head_tag.children:
    print(child)
</code></pre>
<h3 id="2-strings-å’Œ-stripped_strings">2. strings å’Œ stripped_strings</h3>
<p>å¦‚æœtagä¸­åŒ…å«å¤šä¸ªå­—ç¬¦ä¸² [2] ,å¯ä»¥ä½¿ç”¨ .strings æ¥å¾ªç¯è·å–ï¼š</p>
<pre><code class="language-python">for string in soup.strings:
    print(repr(string))
    # u&quot;The Dormouse's story&quot;
    # u'\n\n'
    # u&quot;The Dormouse's story&quot;
    # u'\n\n'
    # u'Once upon a time there were three little sisters; and their names were\n'
    # u'Elsie'
    # u',\n'
    # u'Lacie'
    # u' and\n'
    # u'Tillie'
    # u';\nand they lived at the bottom of a well.'
    # u'\n\n'
    # u'...'
    # u'\n'
</code></pre>
<p>è¾“å‡ºçš„å­—ç¬¦ä¸²ä¸­å¯èƒ½åŒ…å«äº†å¾ˆå¤šç©ºæ ¼æˆ–ç©ºè¡Œ,ä½¿ç”¨ .stripped_strings å¯ä»¥å»é™¤å¤šä½™ç©ºç™½å†…å®¹ï¼š</p>
<pre><code class="language-python">for string in soup.stripped_strings:
    print(repr(string))
    # u&quot;The Dormouse's story&quot;
    # u&quot;The Dormouse's story&quot;
    # u'Once upon a time there were three little sisters; and their names were'
    # u'Elsie'
    # u','
    # u'Lacie'
    # u'and'
    # u'Tillie'
    # u';\nand they lived at the bottom of a well.'
    # u'...'
</code></pre>
<h3 id="è·å–æ ‡ç­¾å±æ€§">è·å–æ ‡ç­¾å±æ€§</h3>
<p>1.é€šè¿‡ä¸‹æ ‡è·å–</p>
<pre><code class="language-python">href = a['href']
</code></pre>
<p>2.é€šè¿‡attrså±æ€§è·å–</p>
<pre><code class="language-python">href=a.attrs['href']
</code></pre>
<h3 id="å°ç»“">å°ç»“</h3>
<ol>
<li>string: è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚è¿”å›æ¥çš„æ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>strings: è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚è¿”å›æ¥çš„æ˜¯ä¸ªç”Ÿæˆå™¨ã€‚</li>
<li>stripped_strings:è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ï¼Œä¼šå»æ‰ç©ºç™½å­—ç¬¦ã€‚è¿”å›æ¥çš„<br>
æ˜¯ä¸ªç”Ÿæˆå™¨ã€‚</li>
<li>get_ _text:è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚ä¸æ˜¯ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›ï¼Œæ˜¯ä»¥æ™®é€šå­—<br>
ç¬¦ä¸²è¿”å›ã€‚</li>
</ol>
<h2 id="æœç´¢æ–‡æ¡£æ ‘">æœç´¢æ–‡æ¡£æ ‘ï¼š</h2>
<h3 id="1-findå’Œfind_allæ–¹æ³•">1. findå’Œfind_allæ–¹æ³•ï¼š</h3>
<p>æœç´¢æ–‡æ¡£æ ‘ï¼Œä¸€èˆ¬ç”¨å¾—æ¯”è¾ƒå¤šçš„å°±æ˜¯ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯<code>find</code>ï¼Œä¸€ä¸ªæ˜¯<code>find_all</code>ã€‚<code>find</code>æ–¹æ³•æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ ‡ç­¾åå°±ç«‹å³è¿”å›ï¼Œåªè¿”å›ä¸€ä¸ªå…ƒç´ ã€‚<code>find_all</code>æ–¹æ³•æ˜¯æŠŠæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ ‡ç­¾éƒ½é€‰åˆ°ï¼Œç„¶åè¿”å›å›å»ã€‚ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯å‡ºå…¥<code>name</code>ä»¥åŠ<code>attr</code>å‚æ•°æ‰¾å‡ºç¬¦åˆè¦æ±‚çš„æ ‡ç­¾ã€‚</p>
<pre><code class="language-python">soup.find_all(&quot;a&quot;,attrs={&quot;id&quot;:&quot;link2&quot;})
</code></pre>
<p>æˆ–è€…æ˜¯ç›´æ¥ä¼ å…¥å±æ€§çš„çš„åå­—ä½œä¸ºå…³é”®å­—å‚æ•°ï¼š</p>
<pre><code class="language-python">soup.find_all(&quot;a&quot;,id='link2')
</code></pre>
<h3 id="2-selectæ–¹æ³•">2. selectæ–¹æ³•ï¼š</h3>
<p>ä½¿ç”¨ä»¥ä¸Šæ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æ‰¾å‡ºå…ƒç´ ã€‚ä½†æœ‰æ—¶å€™ä½¿ç”¨<code>css</code>é€‰æ‹©å™¨çš„æ–¹å¼å¯ä»¥æ›´åŠ çš„æ–¹ä¾¿ã€‚ä½¿ç”¨<code>css</code>é€‰æ‹©å™¨çš„è¯­æ³•ï¼Œåº”è¯¥ä½¿ç”¨<code>select</code>æ–¹æ³•ã€‚ä»¥ä¸‹åˆ—å‡ºå‡ ç§å¸¸ç”¨çš„<code>css</code>é€‰æ‹©å™¨æ–¹æ³•ï¼š</p>
<h4 id="1é€šè¿‡æ ‡ç­¾åæŸ¥æ‰¾">ï¼ˆ1ï¼‰é€šè¿‡æ ‡ç­¾åæŸ¥æ‰¾ï¼š</h4>
<pre><code class="language-python">print(soup.select('a'))
</code></pre>
<h4 id="2é€šè¿‡ç±»åæŸ¥æ‰¾">ï¼ˆ2ï¼‰é€šè¿‡ç±»åæŸ¥æ‰¾ï¼š</h4>
<p>é€šè¿‡ç±»åï¼Œåˆ™åº”è¯¥åœ¨ç±»çš„å‰é¢åŠ ä¸€ä¸ª<code>.</code>ã€‚æ¯”å¦‚è¦æŸ¥æ‰¾<code>class=sister</code>çš„æ ‡ç­¾ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select('.sister'))
</code></pre>
<h4 id="3é€šè¿‡idæŸ¥æ‰¾">ï¼ˆ3ï¼‰é€šè¿‡idæŸ¥æ‰¾ï¼š</h4>
<p>é€šè¿‡idæŸ¥æ‰¾ï¼Œåº”è¯¥åœ¨idçš„åå­—å‰é¢åŠ ä¸€ä¸ªï¼ƒå·ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;#link1&quot;))
</code></pre>
<h4 id="4ç»„åˆæŸ¥æ‰¾">ï¼ˆ4ï¼‰ç»„åˆæŸ¥æ‰¾ï¼š</h4>
<p>ç»„åˆæŸ¥æ‰¾å³å’Œå†™ class æ–‡ä»¶æ—¶ï¼Œæ ‡ç­¾åä¸ç±»åã€idåè¿›è¡Œçš„ç»„åˆåŸç†æ˜¯ä¸€æ ·çš„ï¼Œä¾‹å¦‚æŸ¥æ‰¾ p æ ‡ç­¾ä¸­ï¼Œid ç­‰äº link1çš„å†…å®¹ï¼ŒäºŒè€…éœ€è¦ç”¨ç©ºæ ¼åˆ†å¼€ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;p #link1&quot;))
</code></pre>
<p>ç›´æ¥å­æ ‡ç­¾æŸ¥æ‰¾ï¼Œåˆ™ä½¿ç”¨ &gt; åˆ†éš”ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;head &gt; title&quot;))
</code></pre>
<h4 id="5é€šè¿‡å±æ€§æŸ¥æ‰¾">ï¼ˆ5ï¼‰é€šè¿‡å±æ€§æŸ¥æ‰¾ï¼š</h4>
<p>æŸ¥æ‰¾æ—¶è¿˜å¯ä»¥åŠ å…¥å±æ€§å…ƒç´ ï¼Œå±æ€§éœ€è¦ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ï¼Œæ³¨æ„å±æ€§å’Œæ ‡ç­¾å±äºåŒä¸€èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸­é—´ä¸èƒ½åŠ ç©ºæ ¼ï¼Œå¦åˆ™ä¼šæ— æ³•åŒ¹é…åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select('a[href=&quot;http://example.com/elsie&quot;]'))
</code></pre>
<h4 id="6è·å–å†…å®¹">ï¼ˆ6ï¼‰è·å–å†…å®¹</h4>
<p>ä»¥ä¸Šçš„ select æ–¹æ³•è¿”å›çš„ç»“æœéƒ½æ˜¯åˆ—è¡¨å½¢å¼ï¼Œå¯ä»¥éå†å½¢å¼è¾“å‡ºï¼Œç„¶åç”¨ get_text() æ–¹æ³•æ¥è·å–å®ƒçš„å†…å®¹ã€‚</p>
<pre><code class="language-python">soup = BeautifulSoup(html, 'lxml')
print type(soup.select('title'))
print soup.select('title')[0].get_text()

for title in soup.select('title'):
    print title.get_text()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[4-xpathè¯­æ³•ä¸lxmlåº“]]></title>
        <id>https://hehelv.github.io//post/4-xpath-yu-fa-yu-lxml-ku</id>
        <link href="https://hehelv.github.io//post/4-xpath-yu-fa-yu-lxml-ku">
        </link>
        <updated>2020-02-28T06:36:15.000Z</updated>
        <content type="html"><![CDATA[<h1 id="4-xpathè¯­æ³•ä¸lxmlåº“">4-xpathè¯­æ³•ä¸lxmlåº“</h1>
<h2 id="ä»€ä¹ˆæ˜¯xpath">ä»€ä¹ˆæ˜¯XPathï¼Ÿ</h2>
<p>xpathï¼ˆXML Path Languageï¼‰æ˜¯ä¸€é—¨åœ¨XMLå’ŒHTMLæ–‡æ¡£ä¸­æŸ¥æ‰¾ä¿¡æ¯çš„è¯­è¨€ï¼Œå¯ç”¨æ¥åœ¨XMLå’ŒHTMLæ–‡æ¡£ä¸­å¯¹å…ƒç´ å’Œå±æ€§è¿›è¡Œéå†ã€‚</p>
<h2 id="xpathå¼€å‘å·¥å…·">XPathå¼€å‘å·¥å…·</h2>
<ol>
<li>Chromeæ’ä»¶XPath Helperã€‚</li>
<li>Firefoxæ’ä»¶Try XPathã€‚</li>
</ol>
<h2 id="xpathè¯­æ³•">XPathè¯­æ³•</h2>
<h3 id="é€‰å–èŠ‚ç‚¹">é€‰å–èŠ‚ç‚¹ï¼š</h3>
<p>XPath ä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼æ¥é€‰å– XML æ–‡æ¡£ä¸­çš„èŠ‚ç‚¹æˆ–è€…èŠ‚ç‚¹é›†ã€‚è¿™äº›è·¯å¾„è¡¨è¾¾å¼å’Œæˆ‘ä»¬åœ¨å¸¸è§„çš„ç”µè„‘æ–‡ä»¶ç³»ç»Ÿä¸­çœ‹åˆ°çš„è¡¨è¾¾å¼éå¸¸ç›¸ä¼¼ã€‚</p>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
<th>ç»“æœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodename</td>
<td>é€‰å–æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹</td>
<td>bookstore</td>
<td>é€‰å–bookstoreä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹</td>
</tr>
<tr>
<td>/</td>
<td>å¦‚æœæ˜¯åœ¨æœ€å‰é¢ï¼Œä»£è¡¨ä»æ ¹èŠ‚ç‚¹é€‰å–ã€‚å¦åˆ™é€‰æ‹©æŸèŠ‚ç‚¹ä¸‹çš„æŸä¸ªèŠ‚ç‚¹</td>
<td>/bookstore</td>
<td>é€‰å–æ ¹å…ƒç´ ä¸‹æ‰€æœ‰çš„bookstoreèŠ‚ç‚¹</td>
</tr>
<tr>
<td>//</td>
<td>ä»å…¨å±€èŠ‚ç‚¹ä¸­é€‰æ‹©èŠ‚ç‚¹ï¼Œéšä¾¿åœ¨å“ªä¸ªä½ç½®</td>
<td>//book</td>
<td>ä»å…¨å±€èŠ‚ç‚¹ä¸­æ‰¾åˆ°æ‰€æœ‰çš„bookèŠ‚ç‚¹</td>
</tr>
<tr>
<td>@</td>
<td>é€‰å–æŸä¸ªèŠ‚ç‚¹çš„å±æ€§</td>
<td>//book[@price]</td>
<td>é€‰æ‹©æ‰€æœ‰æ‹¥æœ‰priceå±æ€§çš„bookèŠ‚ç‚¹</td>
</tr>
<tr>
<td>.</td>
<td>å½“å‰èŠ‚ç‚¹</td>
<td>./a</td>
<td>é€‰å–å½“å‰èŠ‚ç‚¹ä¸‹çš„aæ ‡ç­¾</td>
</tr>
</tbody>
</table>
<h3 id="è°“è¯­">è°“è¯­ï¼š</h3>
<p>è°“è¯­ç”¨æ¥æŸ¥æ‰¾æŸä¸ªç‰¹å®šçš„èŠ‚ç‚¹æˆ–è€…åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼çš„èŠ‚ç‚¹ï¼Œè¢«åµŒåœ¨æ–¹æ‹¬å·ä¸­ã€‚<br>
åœ¨ä¸‹é¢çš„è¡¨æ ¼ä¸­ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†å¸¦æœ‰è°“è¯­çš„ä¸€äº›è·¯å¾„è¡¨è¾¾å¼ï¼Œä»¥åŠè¡¨è¾¾å¼çš„ç»“æœï¼š</p>
<table>
<thead>
<tr>
<th>è·¯å¾„è¡¨è¾¾å¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>/bookstore/book[1]</td>
<td>é€‰å–bookstoreä¸‹çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ </td>
</tr>
<tr>
<td>/bookstore/book[last()]</td>
<td>é€‰å–bookstoreä¸‹çš„å€’æ•°ç¬¬äºŒä¸ªbookå…ƒç´ ã€‚</td>
</tr>
<tr>
<td>bookstore/book[position()â¤ï¸]</td>
<td>é€‰å–bookstoreä¸‹å‰é¢ä¸¤ä¸ªå­å…ƒç´ ã€‚</td>
</tr>
<tr>
<td>//book[@price]</td>
<td>é€‰å–æ‹¥æœ‰priceå±æ€§çš„bookå…ƒç´ </td>
</tr>
<tr>
<td>//book[@price=10]</td>
<td>é€‰å–æ‰€æœ‰å±æ€§priceç­‰äº10çš„bookå…ƒç´ </td>
</tr>
</tbody>
</table>
<h3 id="é€šé…ç¬¦">é€šé…ç¬¦</h3>
<p>*è¡¨ç¤ºé€šé…ç¬¦ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">é€šé…ç¬¦</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">ç¤ºä¾‹</th>
<th style="text-align:left">ç»“æœ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">åŒ¹é…ä»»æ„èŠ‚ç‚¹</td>
<td style="text-align:left">/bookstore/*</td>
<td style="text-align:left">é€‰å–bookstoreä¸‹çš„æ‰€æœ‰å­å…ƒç´ ã€‚</td>
</tr>
<tr>
<td style="text-align:left">@*</td>
<td style="text-align:left">åŒ¹é…èŠ‚ç‚¹ä¸­çš„ä»»ä½•å±æ€§</td>
<td style="text-align:left">//book[@*]</td>
<td style="text-align:left">é€‰å–æ‰€æœ‰å¸¦æœ‰å±æ€§çš„bookå…ƒç´ ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="é€‰å–å¤šä¸ªè·¯å¾„">é€‰å–å¤šä¸ªè·¯å¾„ï¼š</h3>
<p>é€šè¿‡åœ¨è·¯å¾„è¡¨è¾¾å¼ä¸­ä½¿ç”¨â€œ|â€è¿ç®—ç¬¦ï¼Œå¯ä»¥é€‰å–è‹¥å¹²ä¸ªè·¯å¾„ã€‚<br>
ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code>//bookstore/book | //book/title
# é€‰å–æ‰€æœ‰bookå…ƒç´ ä»¥åŠbookå…ƒç´ ä¸‹æ‰€æœ‰çš„titleå…ƒç´ 
</code></pre>
<h3 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦ï¼š</h3>
<table>
<thead>
<tr>
<th style="text-align:left">è¿ç®—ç¬¦</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">å®ä¾‹</th>
<th style="text-align:left">è¿”å›å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">|</td>
<td style="text-align:left">è®¡ç®—ä¸¤ä¸ªèŠ‚ç‚¹é›†</td>
<td style="text-align:left">//book | //cd</td>
<td style="text-align:left">è¿”å›æ‰€æœ‰æ‹¥æœ‰ book å’Œ cd å…ƒç´ çš„èŠ‚ç‚¹é›†</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">åŠ æ³•</td>
<td style="text-align:left">6 + 4</td>
<td style="text-align:left">10</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">å‡æ³•</td>
<td style="text-align:left">6 - 4</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">ä¹˜æ³•</td>
<td style="text-align:left">6 * 4</td>
<td style="text-align:left">24</td>
</tr>
<tr>
<td style="text-align:left">div</td>
<td style="text-align:left">é™¤æ³•</td>
<td style="text-align:left">8 div 4</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">=</td>
<td style="text-align:left">ç­‰äº</td>
<td style="text-align:left">price=9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">!=</td>
<td style="text-align:left">ä¸ç­‰äº</td>
<td style="text-align:left">price!=9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&lt;</td>
<td style="text-align:left">å°äº</td>
<td style="text-align:left">price&lt;9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.00ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&lt;=</td>
<td style="text-align:left">å°äºæˆ–ç­‰äº</td>
<td style="text-align:left">price&lt;=9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.00ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">å¤§äº</td>
<td style="text-align:left">price&gt;9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&gt;=</td>
<td style="text-align:left">å¤§äºæˆ–ç­‰äº</td>
<td style="text-align:left">price&gt;=9.80</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.70ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">or</td>
<td style="text-align:left">æˆ–</td>
<td style="text-align:left">price=9.80 or price=9.70</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.50ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">and</td>
<td style="text-align:left">ä¸</td>
<td style="text-align:left">price&gt;9.00 and price&lt;9.90</td>
<td style="text-align:left">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 8.50ï¼Œåˆ™è¿”å› falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">mod</td>
<td style="text-align:left">è®¡ç®—é™¤æ³•çš„ä½™æ•°</td>
<td style="text-align:left">5 mod 2</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
<h2 id="lxmlåº“">lxmlåº“</h2>
<p>lxml æ˜¯ ä¸€ä¸ªHTML/XMLçš„è§£æå™¨ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯å¦‚ä½•è§£æå’Œæå– HTML/XML æ•°æ®ã€‚</p>
<p>lxmlå’Œæ­£åˆ™ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”¨ C å®ç°çš„ï¼Œæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„ Python HTML/XML è§£æå™¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¹‹å‰å­¦ä¹ çš„XPathè¯­æ³•ï¼Œæ¥å¿«é€Ÿçš„å®šä½ç‰¹å®šå…ƒç´ ä»¥åŠèŠ‚ç‚¹ä¿¡æ¯ã€‚</p>
<p>lxml python å®˜æ–¹æ–‡æ¡£ï¼šhttp://lxml.de/index.html</p>
<p>éœ€è¦å®‰è£…Cè¯­è¨€åº“ï¼Œå¯ä½¿ç”¨ pip å®‰è£…ï¼špip install lxml</p>
<h3 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨ï¼š</h3>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥è§£æHTMLä»£ç ï¼Œå¹¶ä¸”åœ¨è§£æHTMLä»£ç çš„æ—¶å€™ï¼Œå¦‚æœHTMLä»£ç ä¸è§„èŒƒï¼Œä»–ä¼šè‡ªåŠ¨çš„è¿›è¡Œè¡¥å…¨ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"># ä½¿ç”¨ lxml çš„ etree åº“
from lxml import etree 

text = '''
&lt;div&gt;
    &lt;ul&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt; # æ³¨æ„ï¼Œæ­¤å¤„ç¼ºå°‘ä¸€ä¸ª &lt;/li&gt; é—­åˆæ ‡ç­¾
     &lt;/ul&gt;
 &lt;/div&gt;
'''

#åˆ©ç”¨etree.HTMLï¼Œå°†å­—ç¬¦ä¸²è§£æä¸ºHTMLæ–‡æ¡£
html = etree.HTML(text) 

# æŒ‰å­—ç¬¦ä¸²åºåˆ—åŒ–HTMLæ–‡æ¡£
result = etree.tostring(html) 

print(result)
</code></pre>
<p>è¾“å…¥ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-html">&lt;html&gt;&lt;body&gt;
&lt;div&gt;
    &lt;ul&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
 &lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ã€‚lxmlä¼šè‡ªåŠ¨ä¿®æ”¹HTMLä»£ç ã€‚ä¾‹å­ä¸­ä¸ä»…è¡¥å…¨äº†liæ ‡ç­¾ï¼Œè¿˜æ·»åŠ äº†bodyï¼Œhtmlæ ‡ç­¾ã€‚</p>
<h3 id="ä»æ–‡ä»¶ä¸­è¯»å–htmlä»£ç ">ä»æ–‡ä»¶ä¸­è¯»å–htmlä»£ç ï¼š</h3>
<p>é™¤äº†ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œlxmlè¿˜æ”¯æŒä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹ã€‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ªhello.htmlæ–‡ä»¶ï¼š</p>
<pre><code class="language-html">&lt;!-- hello.html --&gt;
&lt;div&gt;
    &lt;ul&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
 &lt;/div&gt;
</code></pre>
<p>ç„¶ååˆ©ç”¨<code>etree.parse()</code>æ–¹æ³•æ¥è¯»å–æ–‡ä»¶ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from lxml import etree

# è¯»å–å¤–éƒ¨æ–‡ä»¶ hello.html
html = etree.parse('hello.html')
result = etree.tostring(html, pretty_print=True)

print(result)
</code></pre>
<p>è¾“å…¥ç»“æœå’Œä¹‹å‰æ˜¯ç›¸åŒçš„ã€‚</p>
<h3 id="åœ¨lxmlä¸­ä½¿ç”¨xpathè¯­æ³•">åœ¨lxmlä¸­ä½¿ç”¨XPathè¯­æ³•ï¼š</h3>
<ol>
<li>
<p>è·å–æ‰€æœ‰liæ ‡ç­¾ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 print type(html)  # æ˜¾ç¤ºetree.parse() è¿”å›ç±»å‹

 result = html.xpath('//li')

 print(result)  # æ‰“å°&lt;li&gt;æ ‡ç­¾çš„å…ƒç´ é›†åˆ
</code></pre>
</li>
<li>
<p>è·å–æ‰€æœ‰liå…ƒç´ ä¸‹çš„æ‰€æœ‰classå±æ€§çš„å€¼ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 result = html.xpath('//li/@class')

 print(result)
</code></pre>
</li>
<li>
<p>è·å–liæ ‡ç­¾ä¸‹hrefä¸º<code>www.baidu.com</code>çš„aæ ‡ç­¾ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 result = html.xpath('//li/a[@href=&quot;www.baidu.com&quot;]')

 print(result)
</code></pre>
</li>
<li>
<p>è·å–liæ ‡ç­¾ä¸‹æ‰€æœ‰spanæ ‡ç­¾ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')

 #result = html.xpath('//li/span')
 #æ³¨æ„è¿™ä¹ˆå†™æ˜¯ä¸å¯¹çš„ï¼š
 #å› ä¸º / æ˜¯ç”¨æ¥è·å–å­å…ƒç´ çš„ï¼Œè€Œ &lt;span&gt; å¹¶ä¸æ˜¯ &lt;li&gt; çš„å­å…ƒç´ ï¼Œæ‰€ä»¥ï¼Œè¦ç”¨åŒæ–œæ 

 result = html.xpath('//li//span')

 print(result)
</code></pre>
</li>
<li>
<p>è·å–liæ ‡ç­¾ä¸‹çš„aæ ‡ç­¾é‡Œçš„æ‰€æœ‰classï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 result = html.xpath('//li/a//@class')

 print(result)
</code></pre>
</li>
<li>
<p>è·å–æœ€åä¸€ä¸ªliçš„açš„hrefå±æ€§å¯¹åº”çš„å€¼ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')

 result = html.xpath('//li[last()]/a/@href')
 # è°“è¯­ [last()] å¯ä»¥æ‰¾åˆ°æœ€åä¸€ä¸ªå…ƒç´ 

 print(result)
</code></pre>
</li>
<li>
<p>è·å–å€’æ•°ç¬¬äºŒä¸ªliå…ƒç´ çš„å†…å®¹ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 result = html.xpath('//li[last()-1]/a')

 # text æ–¹æ³•å¯ä»¥è·å–å…ƒç´ å†…å®¹
 print(result[0].text)
</code></pre>
</li>
<li>
<p>è·å–å€’æ•°ç¬¬äºŒä¸ªliå…ƒç´ çš„å†…å®¹çš„ç¬¬äºŒç§æ–¹å¼ï¼š</p>
<pre><code class="language-python"> from lxml import etree

 html = etree.parse('hello.html')
 result = html.xpath('//li[last()-1]/a/text()')

 print(result)
</code></pre>
</li>
</ol>
<h2 id="ä½¿ç”¨requestså’Œxpathçˆ¬å–ç”µå½±å¤©å ‚">ä½¿ç”¨requestså’Œxpathçˆ¬å–ç”µå½±å¤©å ‚</h2>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import requests
from lxml import etree

BASE_DOMAIN = 'http://www.dytt8.net'
HEADERS = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36',
    'Referer': 'http://www.dytt8.net/html/gndy/dyzz/list_23_2.html'
}

def spider():
    url = 'http://www.dytt8.net/html/gndy/dyzz/list_23_1.html'
    resp = requests.get(url,headers=HEADERS)
    # resp.contentï¼šç»è¿‡ç¼–ç åçš„å­—ç¬¦ä¸²
    # resp.textï¼šæ²¡æœ‰ç»è¿‡ç¼–ç ï¼Œä¹Ÿå°±æ˜¯unicodeå­—ç¬¦ä¸²
    # textï¼šç›¸å½“äºæ˜¯ç½‘é¡µä¸­çš„æºä»£ç äº†
    text = resp.content.decode('gbk')
    # treeï¼šç»è¿‡lxmlè§£æåçš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥åä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„xpathæ–¹æ³•ï¼Œå°±å¯ä»¥
    # æå–ä¸€äº›æƒ³è¦çš„æ•°æ®äº†
    tree = etree.HTML(text)
    # xpath/beautifulsou4
    all_a = tree.xpath(&quot;//div[@class='co_content8']//a&quot;)
    for a in all_a:
        title = a.xpath(&quot;text()&quot;)[0]
        href = a.xpath(&quot;@href&quot;)[0]
        if href.startswith('/'):
            detail_url = BASE_DOMAIN + href
            crawl_detail(detail_url)
            break

def crawl_detail(url):
    resp = requests.get(url,headers=HEADERS)
    text = resp.content.decode('gbk')
    tree = etree.HTML(text)
    create_time = tree.xpath(&quot;//div[@class='co_content8']/ul/text()&quot;)[0].strip()
    imgs = tree.xpath(&quot;//div[@id='Zoom']//img/@src&quot;)
    # ç”µå½±æµ·æŠ¥
    cover = imgs[0]
    # ç”µå½±æˆªå›¾
    screenshoot = imgs[1]
    # è·å–spanæ ‡ç­¾ä¸‹æ‰€æœ‰çš„æ–‡æœ¬
    infos = tree.xpath(&quot;//div[@id='Zoom']//text()&quot;)
    for index,info in enumerate(infos):
        if info.startswith(&quot;â—å¹´ã€€ã€€ä»£&quot;):
            year = info.replace(&quot;â—å¹´ã€€ã€€ä»£&quot;,&quot;&quot;).strip()

        if info.startswith(&quot;â—è±†ç“£è¯„åˆ†&quot;):
            douban_rating = info.replace(&quot;â—è±†ç“£è¯„åˆ†&quot;,'').strip()
            print(douban_rating)

        if info.startswith(&quot;â—ä¸»ã€€ã€€æ¼”&quot;):
            # ä»å½“å‰ä½ç½®ï¼Œä¸€ç›´å¾€ä¸‹é¢éå†
            actors = [info]
            for x in range(index+1,len(infos)):
                actor = infos[x]
                if actor.startswith(&quot;â—&quot;):
                    break
                actors.append(actor.strip())
            print(&quot;,&quot;.join(actors))


if __name__ == '__main__':
    spider()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[3-requestsåº“]]></title>
        <id>https://hehelv.github.io//post/3-requests-ku</id>
        <link href="https://hehelv.github.io//post/3-requests-ku">
        </link>
        <updated>2020-02-28T06:33:40.000Z</updated>
        <content type="html"><![CDATA[<h1 id="3-requestsåº“">3-requestsåº“</h1>
<p>è™½ç„¶Pythonçš„æ ‡å‡†åº“ä¸­ urllibæ¨¡å—å·²ç»åŒ…å«äº†å¹³å¸¸æˆ‘ä»¬ä½¿ç”¨çš„å¤§å¤šæ•°åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ API ä½¿ç”¨èµ·æ¥è®©äººæ„Ÿè§‰ä¸å¤ªå¥½ï¼Œè€Œ Requestså®£ä¼ æ˜¯ â€œHTTP for Humansâ€ï¼Œè¯´æ˜ä½¿ç”¨æ›´ç®€æ´æ–¹ä¾¿ã€‚</p>
<h2 id="å®‰è£…å’Œæ–‡æ¡£åœ°å€">å®‰è£…å’Œæ–‡æ¡£åœ°å€ï¼š</h2>
<p>åˆ©ç”¨<code>pip</code>å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®‰è£…ï¼š</p>
<pre><code>pip install requests
</code></pre>
<p>ä¸­æ–‡æ–‡æ¡£ï¼šhttp://docs.python-requests.org/zh_CN/latest/index.html<br>
githubåœ°å€ï¼šhttps://github.com/requests/requests</p>
<h2 id="å‘é€getè¯·æ±‚">å‘é€GETè¯·æ±‚ï¼š</h2>
<ol>
<li>
<p>æœ€ç®€å•çš„å‘é€<code>get</code>è¯·æ±‚å°±æ˜¯é€šè¿‡<code>requests.get</code>æ¥è°ƒç”¨ï¼š</p>
<pre><code class="language-python">response = requests.get(&quot;http://www.baidu.com/&quot;)
</code></pre>
</li>
<li>
<p>æ·»åŠ headerså’ŒæŸ¥è¯¢å‚æ•°ï¼š<br>
å¦‚æœæƒ³æ·»åŠ  headersï¼Œå¯ä»¥ä¼ å…¥headerså‚æ•°æ¥å¢åŠ è¯·æ±‚å¤´ä¸­çš„headersä¿¡æ¯ã€‚å¦‚æœè¦å°†å‚æ•°æ”¾åœ¨urlä¸­ä¼ é€’ï¼Œå¯ä»¥åˆ©ç”¨ params å‚æ•°ã€‚ç›¸å…³ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> import requests

 kw = {'wd':'ä¸­å›½'}

 headers = {&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&quot;}

 # params æ¥æ”¶ä¸€ä¸ªå­—å…¸æˆ–è€…å­—ç¬¦ä¸²çš„æŸ¥è¯¢å‚æ•°ï¼Œå­—å…¸ç±»å‹è‡ªåŠ¨è½¬æ¢ä¸ºurlç¼–ç ï¼Œä¸éœ€è¦urlencode()
 response = requests.get(&quot;http://www.baidu.com/s&quot;, params = kw, headers = headers)

 # æŸ¥çœ‹å“åº”å†…å®¹ï¼Œresponse.text è¿”å›çš„æ˜¯Unicodeæ ¼å¼çš„æ•°æ®
 print(response.text)

 # æŸ¥çœ‹å“åº”å†…å®¹ï¼Œresponse.contentè¿”å›çš„å­—èŠ‚æµæ•°æ®
 print(response.content)

 # æŸ¥çœ‹å®Œæ•´urlåœ°å€
 print(response.url)

 # æŸ¥çœ‹å“åº”å¤´éƒ¨å­—ç¬¦ç¼–ç 
 print(response.encoding)

 # æŸ¥çœ‹å“åº”ç 
 print(response.status_code)
</code></pre>
</li>
</ol>
<h2 id="å‘é€postè¯·æ±‚">å‘é€POSTè¯·æ±‚ï¼š</h2>
<ol>
<li>
<p>æœ€åŸºæœ¬çš„POSTè¯·æ±‚å¯ä»¥ä½¿ç”¨<code>post</code>æ–¹æ³•ï¼š</p>
<pre><code class="language-python">response = requests.post(&quot;http://www.baidu.com/&quot;,data=data)
</code></pre>
</li>
<li>
<p>ä¼ å…¥dataæ•°æ®ï¼š<br>
è¿™æ—¶å€™å°±ä¸è¦å†ä½¿ç”¨<code>urlencode</code>è¿›è¡Œç¼–ç äº†ï¼Œç›´æ¥ä¼ å…¥ä¸€ä¸ªå­—å…¸è¿›å»å°±å¯ä»¥äº†ã€‚æ¯”å¦‚è¯·æ±‚æ‹‰å‹¾ç½‘çš„æ•°æ®çš„ä»£ç ï¼š</p>
<pre><code class="language-python"> import requests

 url = &quot;https://www.lagou.com/jobs/positionAjax.json?city=%E6%B7%B1%E5%9C%B3&amp;needAddtionalResult=false&amp;isSchoolJob=0&quot;

 headers = {
     'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',
     'Referer': 'https://www.lagou.com/jobs/list_python?labelWords=&amp;fromSearch=true&amp;suginput='
 }

 data = {
     'first': 'true',
     'pn': 1,
     'kd': 'python'
 }

 resp = requests.post(url,headers=headers,data=data)
 # å¦‚æœæ˜¯jsonæ•°æ®ï¼Œç›´æ¥å¯ä»¥è°ƒç”¨jsonæ–¹æ³•
 print(resp.json())
</code></pre>
</li>
</ol>
<h2 id="ä½¿ç”¨ä»£ç†">ä½¿ç”¨ä»£ç†ï¼š</h2>
<p>ä½¿ç”¨<code>requests</code>æ·»åŠ ä»£ç†ä¹Ÿéå¸¸ç®€å•ï¼Œåªè¦åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸­ï¼ˆæ¯”å¦‚<code>get</code>æˆ–è€…<code>post</code>ï¼‰ä¼ é€’<code>proxies</code>å‚æ•°å°±å¯ä»¥äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import requests

url = &quot;http://httpbin.org/get&quot;

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',
}

proxy = {
    'http': '171.14.209.180:27829'
}

resp = requests.get(url,headers=headers,proxies=proxy)
with open('xx.html','w',encoding='utf-8') as fp:
    fp.write(resp.text)
</code></pre>
<h2 id="cookie">cookieï¼š</h2>
<p>å¦‚æœåœ¨ä¸€ä¸ªå“åº”ä¸­åŒ…å«äº†<code>cookie</code>ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨<code>cookies</code>å±æ€§æ‹¿åˆ°è¿™ä¸ªè¿”å›çš„<code>cookie</code>å€¼ï¼š</p>
<pre><code class="language-python">import requests

url = &quot;http://www.renren.com/PLogin.do&quot;
data = {&quot;email&quot;:&quot;970138074@qq.com&quot;,'password':&quot;pythonspider&quot;}
resp = requests.get('http://www.baidu.com/')
print(resp.cookies)
print(resp.cookies.get_dict())
</code></pre>
<h2 id="session">sessionï¼š</h2>
<p>ä¹‹å‰ä½¿ç”¨<code>urllib</code>åº“ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨<code>opener</code>å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå¤šä¸ªè¯·æ±‚ä¹‹é—´æ˜¯å¯ä»¥å…±äº«<code>cookie</code>çš„ã€‚é‚£ä¹ˆå¦‚æœä½¿ç”¨<code>requests</code>ï¼Œä¹Ÿè¦è¾¾åˆ°å…±äº«<code>cookie</code>çš„ç›®çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>requests</code>åº“ç»™æˆ‘ä»¬æä¾›çš„<code>session</code>å¯¹è±¡ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„<code>session</code>ä¸æ˜¯webå¼€å‘ä¸­çš„é‚£ä¸ªsessionï¼Œè¿™ä¸ªåœ°æ–¹åªæ˜¯ä¸€ä¸ªä¼šè¯çš„å¯¹è±¡è€Œå·²ã€‚è¿˜æ˜¯ä»¥ç™»å½•äººäººç½‘ä¸ºä¾‹ï¼Œä½¿ç”¨<code>requests</code>æ¥å®ç°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import requests

url = &quot;http://www.renren.com/PLogin.do&quot;
data = {&quot;email&quot;:&quot;970138074@qq.com&quot;,'password':&quot;pythonspider&quot;}
headers = {
    'User-Agent': &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&quot;
}

# ç™»å½•
session = requests.session()
session.post(url,data=data,headers=headers)

# è®¿é—®å¤§é¹ä¸ªäººä¸­å¿ƒ
resp = session.get('http://www.renren.com/880151247/profile')

print(resp.text)
</code></pre>
<h2 id="å¤„ç†ä¸ä¿¡ä»»çš„sslè¯ä¹¦">å¤„ç†ä¸ä¿¡ä»»çš„SSLè¯ä¹¦ï¼š</h2>
<p>å¯¹äºé‚£äº›å·²ç»è¢«ä¿¡ä»»çš„SSLæ•´æ•°çš„ç½‘ç«™ï¼Œæ¯”å¦‚<code>https://www.baidu.com/</code>ï¼Œé‚£ä¹ˆä½¿ç”¨<code>requests</code>ç›´æ¥å°±å¯ä»¥æ­£å¸¸çš„è¿”å›å“åº”ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">resp = requests.get('http://www.12306.cn/mormhweb/',verify=False)
print(resp.content.decode())
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[2-urllibåº“]]></title>
        <id>https://hehelv.github.io//post/2-urllib-ku</id>
        <link href="https://hehelv.github.io//post/2-urllib-ku">
        </link>
        <updated>2020-02-28T06:30:14.000Z</updated>
        <summary type="html"><![CDATA[<h1 id="2-urllibåº“">2-urllibåº“</h1>
<p><code>urllib</code>åº“æ˜¯<code>Python</code>ä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„ç½‘ç»œè¯·æ±‚åº“ã€‚å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºï¼Œå‘æŒ‡å®šçš„æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶å¯ä»¥ä¿å­˜æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚</p>
<h3 id="urlopenå‡½æ•°">urlopenå‡½æ•°ï¼š</h3>
<p>åœ¨<code>Python3</code>çš„<code>urllib</code>åº“ä¸­ï¼Œæ‰€æœ‰å’Œç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ–¹æ³•ï¼Œéƒ½è¢«é›†åˆ°<code>urllib.request</code>æ¨¡å—ä¸‹é¢äº†ï¼Œä»¥å…ˆæ¥çœ‹ä¸‹<code>urlopen</code>å‡½æ•°åŸºæœ¬çš„ä½¿ç”¨ï¼š</p>
<pre><code class="language-python">from urllib import request
resp = request.urlopen('http://www.baidu.com')
print(resp.read())
</code></pre>
<p>å®é™…ä¸Šï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®ç™¾åº¦ï¼Œå³é”®æŸ¥çœ‹æºä»£ç ã€‚ä½ ä¼šå‘ç°ï¼Œè·Ÿæˆ‘ä»¬åˆšæ‰æ‰“å°å‡ºæ¥çš„æ•°æ®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä¸‰è¡Œä»£ç å°±å·²ç»å¸®æˆ‘ä»¬æŠŠç™¾åº¦çš„é¦–é¡µçš„å…¨éƒ¨ä»£ç çˆ¬ä¸‹æ¥äº†ã€‚ä¸€ä¸ªåŸºæœ¬çš„urlè¯·æ±‚å¯¹åº”çš„pythonä»£ç çœŸçš„éå¸¸ç®€å•ã€‚<br>
ä»¥ä¸‹å¯¹<code>urlopen</code>å‡½æ•°çš„è¿›è¡Œè¯¦ç»†è®²è§£ï¼š</p>
<ol>
<li><code>url</code>ï¼šè¯·æ±‚çš„urlã€‚</li>
<li><code>data</code>ï¼šè¯·æ±‚çš„<code>data</code>ï¼Œå¦‚æœè®¾ç½®äº†è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆå°†å˜æˆ<code>post</code>è¯·æ±‚ã€‚</li>
<li>è¿”å›å€¼ï¼šè¿”å›å€¼æ˜¯ä¸€ä¸ª<code>http.client.HTTPResponse</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªç±»æ–‡ä»¶å¥æŸ„å¯¹è±¡ã€‚æœ‰<code>read(size)</code>ã€<code>readline</code>ã€<code>readlines</code>ä»¥åŠ<code>getcode</code>ç­‰æ–¹æ³•ã€‚</li>
</ol>
<h3 id="urlretrieveå‡½æ•°">urlretrieveå‡½æ•°ï¼š</h3>
<p>è¿™ä¸ªå‡½æ•°å¯ä»¥æ–¹ä¾¿çš„å°†ç½‘é¡µä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ã€‚ä»¥ä¸‹ä»£ç å¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†ç™¾åº¦çš„é¦–é¡µä¸‹è½½åˆ°æœ¬åœ°ï¼š</p>
<pre><code class="language-python">from urllib import request
request.urlretrieve('http://www.baidu.com/','baidu.html')
</code></pre>
<h3 id="urlencodeå‡½æ•°">urlencodeå‡½æ•°ï¼š</h3>
<p>ç”¨æµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœurlä¸­åŒ…å«äº†ä¸­æ–‡æˆ–è€…å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬è¿›è¡Œç¼–ç ã€‚è€Œå¦‚æœä½¿ç”¨ä»£ç å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨çš„è¿›è¡Œç¼–ç ï¼Œè¿™æ—¶å€™å°±åº”è¯¥ä½¿ç”¨<code>urlencode</code>å‡½æ•°æ¥å®ç°ã€‚<code>urlencode</code>å¯ä»¥æŠŠå­—å…¸æ•°æ®è½¬æ¢ä¸º<code>URL</code>ç¼–ç çš„æ•°æ®ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
data = {'name':'çˆ¬è™«åŸºç¡€','greet':'hello world','age':100}
qs = parse.urlencode(data)
print(qs)
</code></pre>
<h3 id="parse_qså‡½æ•°">parse_qså‡½æ•°ï¼š</h3>
<p>å¯ä»¥å°†ç»è¿‡ç¼–ç åçš„urlå‚æ•°è¿›è¡Œè§£ç ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
qs = &quot;name=%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80&amp;greet=hello+world&amp;age=100&quot;
print(parse.parse_qs(qs))
</code></pre>
<h3 id="urlparseå’Œurlsplit">urlparseå’Œurlsplitï¼š</h3>
<p>æœ‰æ—¶å€™æ‹¿åˆ°ä¸€ä¸ªurlï¼Œæƒ³è¦å¯¹è¿™ä¸ªurlä¸­çš„å„ä¸ªç»„æˆéƒ¨åˆ†è¿›è¡Œåˆ†å‰²ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<code>urlparse</code>æˆ–è€…æ˜¯<code>urlsplit</code>æ¥è¿›è¡Œåˆ†å‰²ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse

url = 'http://www.baidu.com/s?username=python'

result = parse.urlsplit(url)
# result = parse.urlparse(url)

print('scheme:',result.scheme)
print('netloc:',result.netloc)
print('path:',result.path)
print('query:',result.query)
</code></pre>
<p><code>urlparse</code>å’Œ<code>urlsplit</code>åŸºæœ¬ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å”¯ä¸€ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œ<code>urlparse</code>é‡Œé¢å¤šäº†ä¸€ä¸ª<code>params</code>å±æ€§ï¼Œè€Œ<code>urlsplit</code>æ²¡æœ‰è¿™ä¸ª<code>params</code>å±æ€§ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª<code>url</code>ä¸ºï¼š<code>url = 'http://www.baidu.com/s;hello?wd=python&amp;username=abc#1'</code>ï¼Œ<br>
é‚£ä¹ˆ<code>urlparse</code>å¯ä»¥è·å–åˆ°<code>hello</code>ï¼Œè€Œ<code>urlsplit</code>ä¸å¯ä»¥è·å–åˆ°ã€‚<code>url</code>ä¸­çš„<code>params</code>ä¹Ÿç”¨å¾—æ¯”è¾ƒå°‘ã€‚</p>
<h3 id="requestrequestç±»">request.Requestç±»ï¼š</h3>
<p>å¦‚æœæƒ³è¦åœ¨è¯·æ±‚çš„æ—¶å€™å¢åŠ ä¸€äº›è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨<code>request.Request</code>ç±»æ¥å®ç°ã€‚æ¯”å¦‚è¦å¢åŠ ä¸€ä¸ª<code>User-Agent</code>ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request(&quot;http://www.baidu.com/&quot;,headers=headers)
resp = request.urlopen(req)
print(resp.read())
</code></pre>
<h3 id="å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸š">å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸šï¼š</h3>
<ol>
<li>urlé“¾æ¥ï¼šhttp://neihanshequ.com/bar/1/</li>
<li>è¦æ±‚ï¼šèƒ½çˆ¬å–ä¸€é¡µçš„æ•°æ®å°±å¯ä»¥äº†ã€‚</li>
</ol>
<h3 id="proxyhandlerå¤„ç†å™¨ä»£ç†è®¾ç½®">ProxyHandlerå¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰</h3>
<p>å¾ˆå¤šç½‘ç«™ä¼šæ£€æµ‹æŸä¸€æ®µæ—¶é—´æŸä¸ªIPçš„è®¿é—®æ¬¡æ•°(é€šè¿‡æµé‡ç»Ÿè®¡ï¼Œç³»ç»Ÿæ—¥å¿—ç­‰)ï¼Œå¦‚æœè®¿é—®æ¬¡æ•°å¤šçš„ä¸åƒæ­£å¸¸äººï¼Œå®ƒä¼šç¦æ­¢è¿™ä¸ªIPçš„è®¿é—®ã€‚<br>
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›ä»£ç†æœåŠ¡å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ¢ä¸€ä¸ªä»£ç†ï¼Œå°±ç®—IPè¢«ç¦æ­¢ï¼Œä¾ç„¶å¯ä»¥æ¢ä¸ªIPç»§ç»­çˆ¬å–ã€‚<br>
urllibä¸­é€šè¿‡ProxyHandleræ¥è®¾ç½®ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸‹é¢ä»£ç è¯´æ˜å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰openeræ¥ä½¿ç”¨ä»£ç†ï¼š</p>
<pre><code class="language-python">from urllib import request

# è¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨ä»£ç†çš„
# resp = request.urlopen('http://httpbin.org/get')
# print(resp.read().decode(&quot;utf-8&quot;))

# è¿™ä¸ªæ˜¯ä½¿ç”¨äº†ä»£ç†çš„
handler = request.ProxyHandler({&quot;http&quot;:&quot;218.66.161.88:31769&quot;})

opener = request.build_opener(handler)
req = request.Request(&quot;http://httpbin.org/ip&quot;)
resp = opener.open(req)
print(resp.read())
</code></pre>
<p>å¸¸ç”¨çš„ä»£ç†æœ‰ï¼š</p>
<ul>
<li>è¥¿åˆºå…è´¹ä»£ç†IPï¼šhttp://www.xicidaili.com/</li>
<li>å¿«ä»£ç†ï¼šhttp://www.kuaidaili.com/</li>
<li>ä»£ç†äº‘ï¼šhttp://www.dailiyun.com/</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯cookie">ä»€ä¹ˆæ˜¯cookieï¼š</h3>
<p>åœ¨ç½‘ç«™ä¸­ï¼Œhttpè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å³ä½¿ç¬¬ä¸€æ¬¡å’ŒæœåŠ¡å™¨è¿æ¥åå¹¶ä¸”ç™»å½•æˆåŠŸåï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶ä¸èƒ½çŸ¥é“å½“å‰è¯·æ±‚æ˜¯å“ªä¸ªç”¨æˆ·ã€‚<code>cookie</code>çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ¬¡ç™»å½•åæœåŠ¡å™¨è¿”å›ä¸€äº›æ•°æ®ï¼ˆcookieï¼‰ç»™æµè§ˆå™¨ï¼Œç„¶åæµè§ˆå™¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œå½“è¯¥ç”¨æˆ·å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨çš„æŠŠä¸Šæ¬¡è¯·æ±‚å­˜å‚¨çš„<code>cookie</code>æ•°æ®è‡ªåŠ¨çš„æºå¸¦ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡æµè§ˆå™¨æºå¸¦çš„æ•°æ®å°±èƒ½åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å“ªä¸ªäº†ã€‚<code>cookie</code>å­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å­˜å‚¨å¤§å°ï¼Œä½†ä¸€èˆ¬ä¸è¶…è¿‡4KBã€‚å› æ­¤ä½¿ç”¨<code>cookie</code>åªèƒ½å­˜å‚¨ä¸€äº›å°é‡çš„æ•°æ®ã€‚</p>
<h4 id="cookieçš„æ ¼å¼">cookieçš„æ ¼å¼ï¼š</h4>
<pre><code>Set-Cookie: NAME=VALUEï¼›Expires/Max-age=DATEï¼›Path=PATHï¼›Domain=DOMAIN_NAMEï¼›SECURE
</code></pre>
<p>å‚æ•°æ„ä¹‰ï¼š</p>
<ul>
<li>NAMEï¼šcookieçš„åå­—ã€‚</li>
<li>VALUEï¼šcookieçš„å€¼ã€‚</li>
<li>Expiresï¼šcookieçš„è¿‡æœŸæ—¶é—´ã€‚</li>
<li>Pathï¼šcookieä½œç”¨çš„è·¯å¾„ã€‚</li>
<li>Domainï¼šcookieä½œç”¨çš„åŸŸåã€‚</li>
<li>SECUREï¼šæ˜¯å¦åªåœ¨httpsåè®®ä¸‹èµ·ä½œç”¨ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨cookielibåº“å’Œhttpcookieprocessoræ¨¡æ‹Ÿç™»å½•">ä½¿ç”¨cookielibåº“å’ŒHTTPCookieProcessoræ¨¡æ‹Ÿç™»å½•ï¼š</h3>
<p>Cookie æ˜¯æŒ‡ç½‘ç«™æœåŠ¡å™¨ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½å’Œè¿›è¡ŒSessionè·Ÿè¸ªï¼Œè€Œå‚¨å­˜åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„æ–‡æœ¬æ–‡ä»¶ï¼ŒCookieå¯ä»¥ä¿æŒç™»å½•ä¿¡æ¯åˆ°ç”¨æˆ·ä¸‹æ¬¡ä¸æœåŠ¡å™¨çš„ä¼šè¯ã€‚<br>
è¿™é‡Œä»¥äººäººç½‘ä¸ºä¾‹ã€‚äººäººç½‘ä¸­ï¼Œè¦è®¿é—®æŸä¸ªäººçš„ä¸»é¡µï¼Œå¿…é¡»å…ˆç™»å½•æ‰èƒ½è®¿é—®ï¼Œç™»å½•è¯´ç™½äº†å°±æ˜¯è¦æœ‰cookieä¿¡æ¯ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦ç”¨ä»£ç çš„æ–¹å¼è®¿é—®ï¼Œå°±å¿…é¡»è¦æœ‰æ­£ç¡®çš„cookieä¿¡æ¯æ‰èƒ½è®¿é—®ã€‚è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œç„¶åå°†cookieä¿¡æ¯å¤åˆ¶ä¸‹æ¥ï¼Œæ”¾åˆ°headersä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',
    'Cookie': 'anonymid=jacdwz2x-8bjldx; depovince=GW; _r01_=1; _ga=GA1.2.1455063316.1511436360; _gid=GA1.2.862627163.1511436360; wp=1; JSESSIONID=abczwY8ecd4xz8RJcyP-v; jebecookies=d4497791-9d41-4269-9e2b-3858d4989785|||||; ick_login=884e75d4-f361-4cff-94bb-81fe6c42b220; _de=EA5778F44555C091303554EBBEB4676C696BF75400CE19CC; p=61a3c7d0d4b2d1e991095353f83fa2141; first_login_flag=1; ln_uact=970138074@qq.com; ln_hurl=http://hdn.xnimg.cn/photos/hdn121/20170428/1700/main_nhiB_aebd0000854a1986.jpg; t=3dd84a3117737e819dd2c32f1cdb91d01; societyguester=3dd84a3117737e819dd2c32f1cdb91d01; id=443362311; xnsid=169efdc0; loginfrom=syshome; ch_id=10016; jebe_key=9c062f5a-4335-4a91-bf7a-970f8b86a64e%7Ca022c303305d1b2ab6b5089643e4b5de%7C1511449232839%7C1; wp_fold=0'
}

url = 'http://www.renren.com/880151247/profile'

req = request.Request(url,headers=headers)
resp = request.urlopen(req)
with open('renren.html','w') as fp:
    fp.write(resp.read().decode('utf-8'))
</code></pre>
<p>ä½†æ˜¯æ¯æ¬¡åœ¨è®¿é—®éœ€è¦cookieçš„é¡µé¢éƒ½è¦ä»æµè§ˆå™¨ä¸­å¤åˆ¶cookieæ¯”è¾ƒéº»çƒ¦ã€‚åœ¨Pythonå¤„ç†Cookieï¼Œä¸€èˆ¬æ˜¯é€šè¿‡<code>http.cookiejar</code>æ¨¡å—å’Œ<code>urllibæ¨¡å—çš„HTTPCookieProcessor</code>å¤„ç†å™¨ç±»ä¸€èµ·ä½¿ç”¨ã€‚<code>http.cookiejar</code>æ¨¡å—ä¸»è¦ä½œç”¨æ˜¯æä¾›ç”¨äºå­˜å‚¨cookieçš„å¯¹è±¡ã€‚è€Œ<code>HTTPCookieProcessor</code>å¤„ç†å™¨ä¸»è¦ä½œç”¨æ˜¯å¤„ç†è¿™äº›cookieå¯¹è±¡ï¼Œå¹¶æ„å»ºhandlerå¯¹è±¡ã€‚</p>
<h4 id="httpcookiejaræ¨¡å—">http.cookiejaræ¨¡å—ï¼š</h4>
<p>è¯¥æ¨¡å—ä¸»è¦çš„ç±»æœ‰CookieJarã€FileCookieJarã€MozillaCookieJarã€LWPCookieJarã€‚è¿™å››ä¸ªç±»çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ol>
<li>CookieJarï¼šç®¡ç†HTTP cookieå€¼ã€å­˜å‚¨HTTPè¯·æ±‚ç”Ÿæˆçš„cookieã€å‘ä¼ å‡ºçš„HTTPè¯·æ±‚æ·»åŠ cookieçš„å¯¹è±¡ã€‚æ•´ä¸ªcookieéƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯¹CookieJarå®ä¾‹è¿›è¡Œåƒåœ¾å›æ”¶åcookieä¹Ÿå°†ä¸¢å¤±ã€‚</li>
<li>FileCookieJar (filename,delayload=None,policy=None)ï¼šä»CookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œç”¨æ¥åˆ›å»ºFileCookieJarå®ä¾‹ï¼Œæ£€ç´¢cookieä¿¡æ¯å¹¶å°†cookieå­˜å‚¨åˆ°æ–‡ä»¶ä¸­ã€‚filenameæ˜¯å­˜å‚¨cookieçš„æ–‡ä»¶åã€‚delayloadä¸ºTrueæ—¶æ”¯æŒå»¶è¿Ÿè®¿é—®è®¿é—®æ–‡ä»¶ï¼Œå³åªæœ‰åœ¨éœ€è¦æ—¶æ‰è¯»å–æ–‡ä»¶æˆ–åœ¨æ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®ã€‚</li>
<li>MozillaCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸Mozillaæµè§ˆå™¨ cookies.txtå…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
<li>LWPCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸libwww-perlæ ‡å‡†çš„ Set-Cookie3 æ–‡ä»¶æ ¼å¼å…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
</ol>
<h4 id="ç™»å½•äººäººç½‘">ç™»å½•äººäººç½‘ï¼š</h4>
<p>åˆ©ç”¨<code>http.cookiejar</code>å’Œ<code>request.HTTPCookieProcessor</code>ç™»å½•äººäººç½‘ã€‚ç›¸å…³ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse
from http.cookiejar import CookieJar

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}

def get_opener():
    cookiejar = CookieJar()
    handler = request.HTTPCookieProcessor(cookiejar)
    opener = request.build_opener(handler)
    return opener

def login_renren(opener):
    data = {&quot;email&quot;: &quot;970138074@qq.com&quot;, &quot;password&quot;: &quot;pythonspider&quot;}
    data = parse.urlencode(data).encode('utf-8')
    login_url = &quot;http://www.renren.com/PLogin.do&quot;
    req = request.Request(login_url, headers=headers, data=data)
    opener.open(req)

def visit_profile(opener):
    url = 'http://www.renren.com/880151247/profile'
    req = request.Request(url,headers=headers)
    resp = opener.open(req)
    with open('renren.html','w') as fp:
        fp.write(resp.read().decode(&quot;utf-8&quot;))

if __name__ == '__main__':
    opener = get_opener()
    login_renren(opener)
    visit_profile(opener)
</code></pre>
<h4 id="ä¿å­˜cookieåˆ°æœ¬åœ°">ä¿å­˜cookieåˆ°æœ¬åœ°ï¼š</h4>
<p>ä¿å­˜<code>cookie</code>åˆ°æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨<code>cookiejar</code>çš„<code>save</code>æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
cookiejar.save(ignore_discard=True,ignore_expires=True)
</code></pre>
<h4 id="ä»æœ¬åœ°åŠ è½½cookie">ä»æœ¬åœ°åŠ è½½cookieï¼š</h4>
<p>ä»æœ¬åœ°åŠ è½½<code>cookie</code>ï¼Œéœ€è¦ä½¿ç”¨<code>cookiejar</code>çš„<code>load</code>æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿéœ€è¦æŒ‡å®šæ–¹æ³•ï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
cookiejar.load(ignore_expires=True,ignore_discard=True)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
</code></pre>
]]></summary>
        <content type="html"><![CDATA[<h1 id="2-urllibåº“">2-urllibåº“</h1>
<p><code>urllib</code>åº“æ˜¯<code>Python</code>ä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„ç½‘ç»œè¯·æ±‚åº“ã€‚å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºï¼Œå‘æŒ‡å®šçš„æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶å¯ä»¥ä¿å­˜æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚</p>
<h3 id="urlopenå‡½æ•°">urlopenå‡½æ•°ï¼š</h3>
<p>åœ¨<code>Python3</code>çš„<code>urllib</code>åº“ä¸­ï¼Œæ‰€æœ‰å’Œç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ–¹æ³•ï¼Œéƒ½è¢«é›†åˆ°<code>urllib.request</code>æ¨¡å—ä¸‹é¢äº†ï¼Œä»¥å…ˆæ¥çœ‹ä¸‹<code>urlopen</code>å‡½æ•°åŸºæœ¬çš„ä½¿ç”¨ï¼š</p>
<pre><code class="language-python">from urllib import request
resp = request.urlopen('http://www.baidu.com')
print(resp.read())
</code></pre>
<p>å®é™…ä¸Šï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®ç™¾åº¦ï¼Œå³é”®æŸ¥çœ‹æºä»£ç ã€‚ä½ ä¼šå‘ç°ï¼Œè·Ÿæˆ‘ä»¬åˆšæ‰æ‰“å°å‡ºæ¥çš„æ•°æ®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä¸‰è¡Œä»£ç å°±å·²ç»å¸®æˆ‘ä»¬æŠŠç™¾åº¦çš„é¦–é¡µçš„å…¨éƒ¨ä»£ç çˆ¬ä¸‹æ¥äº†ã€‚ä¸€ä¸ªåŸºæœ¬çš„urlè¯·æ±‚å¯¹åº”çš„pythonä»£ç çœŸçš„éå¸¸ç®€å•ã€‚<br>
ä»¥ä¸‹å¯¹<code>urlopen</code>å‡½æ•°çš„è¿›è¡Œè¯¦ç»†è®²è§£ï¼š</p>
<ol>
<li><code>url</code>ï¼šè¯·æ±‚çš„urlã€‚</li>
<li><code>data</code>ï¼šè¯·æ±‚çš„<code>data</code>ï¼Œå¦‚æœè®¾ç½®äº†è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆå°†å˜æˆ<code>post</code>è¯·æ±‚ã€‚</li>
<li>è¿”å›å€¼ï¼šè¿”å›å€¼æ˜¯ä¸€ä¸ª<code>http.client.HTTPResponse</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªç±»æ–‡ä»¶å¥æŸ„å¯¹è±¡ã€‚æœ‰<code>read(size)</code>ã€<code>readline</code>ã€<code>readlines</code>ä»¥åŠ<code>getcode</code>ç­‰æ–¹æ³•ã€‚</li>
</ol>
<h3 id="urlretrieveå‡½æ•°">urlretrieveå‡½æ•°ï¼š</h3>
<p>è¿™ä¸ªå‡½æ•°å¯ä»¥æ–¹ä¾¿çš„å°†ç½‘é¡µä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ã€‚ä»¥ä¸‹ä»£ç å¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†ç™¾åº¦çš„é¦–é¡µä¸‹è½½åˆ°æœ¬åœ°ï¼š</p>
<pre><code class="language-python">from urllib import request
request.urlretrieve('http://www.baidu.com/','baidu.html')
</code></pre>
<h3 id="urlencodeå‡½æ•°">urlencodeå‡½æ•°ï¼š</h3>
<p>ç”¨æµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœurlä¸­åŒ…å«äº†ä¸­æ–‡æˆ–è€…å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬è¿›è¡Œç¼–ç ã€‚è€Œå¦‚æœä½¿ç”¨ä»£ç å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨çš„è¿›è¡Œç¼–ç ï¼Œè¿™æ—¶å€™å°±åº”è¯¥ä½¿ç”¨<code>urlencode</code>å‡½æ•°æ¥å®ç°ã€‚<code>urlencode</code>å¯ä»¥æŠŠå­—å…¸æ•°æ®è½¬æ¢ä¸º<code>URL</code>ç¼–ç çš„æ•°æ®ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
data = {'name':'çˆ¬è™«åŸºç¡€','greet':'hello world','age':100}
qs = parse.urlencode(data)
print(qs)
</code></pre>
<h3 id="parse_qså‡½æ•°">parse_qså‡½æ•°ï¼š</h3>
<p>å¯ä»¥å°†ç»è¿‡ç¼–ç åçš„urlå‚æ•°è¿›è¡Œè§£ç ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
qs = &quot;name=%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80&amp;greet=hello+world&amp;age=100&quot;
print(parse.parse_qs(qs))
</code></pre>
<h3 id="urlparseå’Œurlsplit">urlparseå’Œurlsplitï¼š</h3>
<p>æœ‰æ—¶å€™æ‹¿åˆ°ä¸€ä¸ªurlï¼Œæƒ³è¦å¯¹è¿™ä¸ªurlä¸­çš„å„ä¸ªç»„æˆéƒ¨åˆ†è¿›è¡Œåˆ†å‰²ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<code>urlparse</code>æˆ–è€…æ˜¯<code>urlsplit</code>æ¥è¿›è¡Œåˆ†å‰²ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse

url = 'http://www.baidu.com/s?username=python'

result = parse.urlsplit(url)
# result = parse.urlparse(url)

print('scheme:',result.scheme)
print('netloc:',result.netloc)
print('path:',result.path)
print('query:',result.query)
</code></pre>
<p><code>urlparse</code>å’Œ<code>urlsplit</code>åŸºæœ¬ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å”¯ä¸€ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œ<code>urlparse</code>é‡Œé¢å¤šäº†ä¸€ä¸ª<code>params</code>å±æ€§ï¼Œè€Œ<code>urlsplit</code>æ²¡æœ‰è¿™ä¸ª<code>params</code>å±æ€§ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª<code>url</code>ä¸ºï¼š<code>url = 'http://www.baidu.com/s;hello?wd=python&amp;username=abc#1'</code>ï¼Œ<br>
é‚£ä¹ˆ<code>urlparse</code>å¯ä»¥è·å–åˆ°<code>hello</code>ï¼Œè€Œ<code>urlsplit</code>ä¸å¯ä»¥è·å–åˆ°ã€‚<code>url</code>ä¸­çš„<code>params</code>ä¹Ÿç”¨å¾—æ¯”è¾ƒå°‘ã€‚</p>
<h3 id="requestrequestç±»">request.Requestç±»ï¼š</h3>
<p>å¦‚æœæƒ³è¦åœ¨è¯·æ±‚çš„æ—¶å€™å¢åŠ ä¸€äº›è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨<code>request.Request</code>ç±»æ¥å®ç°ã€‚æ¯”å¦‚è¦å¢åŠ ä¸€ä¸ª<code>User-Agent</code>ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request(&quot;http://www.baidu.com/&quot;,headers=headers)
resp = request.urlopen(req)
print(resp.read())
</code></pre>
<h3 id="å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸š">å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸šï¼š</h3>
<ol>
<li>urlé“¾æ¥ï¼šhttp://neihanshequ.com/bar/1/</li>
<li>è¦æ±‚ï¼šèƒ½çˆ¬å–ä¸€é¡µçš„æ•°æ®å°±å¯ä»¥äº†ã€‚</li>
</ol>
<h3 id="proxyhandlerå¤„ç†å™¨ä»£ç†è®¾ç½®">ProxyHandlerå¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰</h3>
<p>å¾ˆå¤šç½‘ç«™ä¼šæ£€æµ‹æŸä¸€æ®µæ—¶é—´æŸä¸ªIPçš„è®¿é—®æ¬¡æ•°(é€šè¿‡æµé‡ç»Ÿè®¡ï¼Œç³»ç»Ÿæ—¥å¿—ç­‰)ï¼Œå¦‚æœè®¿é—®æ¬¡æ•°å¤šçš„ä¸åƒæ­£å¸¸äººï¼Œå®ƒä¼šç¦æ­¢è¿™ä¸ªIPçš„è®¿é—®ã€‚<br>
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›ä»£ç†æœåŠ¡å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ¢ä¸€ä¸ªä»£ç†ï¼Œå°±ç®—IPè¢«ç¦æ­¢ï¼Œä¾ç„¶å¯ä»¥æ¢ä¸ªIPç»§ç»­çˆ¬å–ã€‚<br>
urllibä¸­é€šè¿‡ProxyHandleræ¥è®¾ç½®ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸‹é¢ä»£ç è¯´æ˜å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰openeræ¥ä½¿ç”¨ä»£ç†ï¼š</p>
<pre><code class="language-python">from urllib import request

# è¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨ä»£ç†çš„
# resp = request.urlopen('http://httpbin.org/get')
# print(resp.read().decode(&quot;utf-8&quot;))

# è¿™ä¸ªæ˜¯ä½¿ç”¨äº†ä»£ç†çš„
handler = request.ProxyHandler({&quot;http&quot;:&quot;218.66.161.88:31769&quot;})

opener = request.build_opener(handler)
req = request.Request(&quot;http://httpbin.org/ip&quot;)
resp = opener.open(req)
print(resp.read())
</code></pre>
<p>å¸¸ç”¨çš„ä»£ç†æœ‰ï¼š</p>
<ul>
<li>è¥¿åˆºå…è´¹ä»£ç†IPï¼šhttp://www.xicidaili.com/</li>
<li>å¿«ä»£ç†ï¼šhttp://www.kuaidaili.com/</li>
<li>ä»£ç†äº‘ï¼šhttp://www.dailiyun.com/</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯cookie">ä»€ä¹ˆæ˜¯cookieï¼š</h3>
<p>åœ¨ç½‘ç«™ä¸­ï¼Œhttpè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å³ä½¿ç¬¬ä¸€æ¬¡å’ŒæœåŠ¡å™¨è¿æ¥åå¹¶ä¸”ç™»å½•æˆåŠŸåï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶ä¸èƒ½çŸ¥é“å½“å‰è¯·æ±‚æ˜¯å“ªä¸ªç”¨æˆ·ã€‚<code>cookie</code>çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ¬¡ç™»å½•åæœåŠ¡å™¨è¿”å›ä¸€äº›æ•°æ®ï¼ˆcookieï¼‰ç»™æµè§ˆå™¨ï¼Œç„¶åæµè§ˆå™¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œå½“è¯¥ç”¨æˆ·å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨çš„æŠŠä¸Šæ¬¡è¯·æ±‚å­˜å‚¨çš„<code>cookie</code>æ•°æ®è‡ªåŠ¨çš„æºå¸¦ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡æµè§ˆå™¨æºå¸¦çš„æ•°æ®å°±èƒ½åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å“ªä¸ªäº†ã€‚<code>cookie</code>å­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å­˜å‚¨å¤§å°ï¼Œä½†ä¸€èˆ¬ä¸è¶…è¿‡4KBã€‚å› æ­¤ä½¿ç”¨<code>cookie</code>åªèƒ½å­˜å‚¨ä¸€äº›å°é‡çš„æ•°æ®ã€‚</p>
<h4 id="cookieçš„æ ¼å¼">cookieçš„æ ¼å¼ï¼š</h4>
<pre><code>Set-Cookie: NAME=VALUEï¼›Expires/Max-age=DATEï¼›Path=PATHï¼›Domain=DOMAIN_NAMEï¼›SECURE
</code></pre>
<p>å‚æ•°æ„ä¹‰ï¼š</p>
<ul>
<li>NAMEï¼šcookieçš„åå­—ã€‚</li>
<li>VALUEï¼šcookieçš„å€¼ã€‚</li>
<li>Expiresï¼šcookieçš„è¿‡æœŸæ—¶é—´ã€‚</li>
<li>Pathï¼šcookieä½œç”¨çš„è·¯å¾„ã€‚</li>
<li>Domainï¼šcookieä½œç”¨çš„åŸŸåã€‚</li>
<li>SECUREï¼šæ˜¯å¦åªåœ¨httpsåè®®ä¸‹èµ·ä½œç”¨ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨cookielibåº“å’Œhttpcookieprocessoræ¨¡æ‹Ÿç™»å½•">ä½¿ç”¨cookielibåº“å’ŒHTTPCookieProcessoræ¨¡æ‹Ÿç™»å½•ï¼š</h3>
<p>Cookie æ˜¯æŒ‡ç½‘ç«™æœåŠ¡å™¨ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½å’Œè¿›è¡ŒSessionè·Ÿè¸ªï¼Œè€Œå‚¨å­˜åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„æ–‡æœ¬æ–‡ä»¶ï¼ŒCookieå¯ä»¥ä¿æŒç™»å½•ä¿¡æ¯åˆ°ç”¨æˆ·ä¸‹æ¬¡ä¸æœåŠ¡å™¨çš„ä¼šè¯ã€‚<br>
è¿™é‡Œä»¥äººäººç½‘ä¸ºä¾‹ã€‚äººäººç½‘ä¸­ï¼Œè¦è®¿é—®æŸä¸ªäººçš„ä¸»é¡µï¼Œå¿…é¡»å…ˆç™»å½•æ‰èƒ½è®¿é—®ï¼Œç™»å½•è¯´ç™½äº†å°±æ˜¯è¦æœ‰cookieä¿¡æ¯ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦ç”¨ä»£ç çš„æ–¹å¼è®¿é—®ï¼Œå°±å¿…é¡»è¦æœ‰æ­£ç¡®çš„cookieä¿¡æ¯æ‰èƒ½è®¿é—®ã€‚è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œç„¶åå°†cookieä¿¡æ¯å¤åˆ¶ä¸‹æ¥ï¼Œæ”¾åˆ°headersä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',
    'Cookie': 'anonymid=jacdwz2x-8bjldx; depovince=GW; _r01_=1; _ga=GA1.2.1455063316.1511436360; _gid=GA1.2.862627163.1511436360; wp=1; JSESSIONID=abczwY8ecd4xz8RJcyP-v; jebecookies=d4497791-9d41-4269-9e2b-3858d4989785|||||; ick_login=884e75d4-f361-4cff-94bb-81fe6c42b220; _de=EA5778F44555C091303554EBBEB4676C696BF75400CE19CC; p=61a3c7d0d4b2d1e991095353f83fa2141; first_login_flag=1; ln_uact=970138074@qq.com; ln_hurl=http://hdn.xnimg.cn/photos/hdn121/20170428/1700/main_nhiB_aebd0000854a1986.jpg; t=3dd84a3117737e819dd2c32f1cdb91d01; societyguester=3dd84a3117737e819dd2c32f1cdb91d01; id=443362311; xnsid=169efdc0; loginfrom=syshome; ch_id=10016; jebe_key=9c062f5a-4335-4a91-bf7a-970f8b86a64e%7Ca022c303305d1b2ab6b5089643e4b5de%7C1511449232839%7C1; wp_fold=0'
}

url = 'http://www.renren.com/880151247/profile'

req = request.Request(url,headers=headers)
resp = request.urlopen(req)
with open('renren.html','w') as fp:
    fp.write(resp.read().decode('utf-8'))
</code></pre>
<p>ä½†æ˜¯æ¯æ¬¡åœ¨è®¿é—®éœ€è¦cookieçš„é¡µé¢éƒ½è¦ä»æµè§ˆå™¨ä¸­å¤åˆ¶cookieæ¯”è¾ƒéº»çƒ¦ã€‚åœ¨Pythonå¤„ç†Cookieï¼Œä¸€èˆ¬æ˜¯é€šè¿‡<code>http.cookiejar</code>æ¨¡å—å’Œ<code>urllibæ¨¡å—çš„HTTPCookieProcessor</code>å¤„ç†å™¨ç±»ä¸€èµ·ä½¿ç”¨ã€‚<code>http.cookiejar</code>æ¨¡å—ä¸»è¦ä½œç”¨æ˜¯æä¾›ç”¨äºå­˜å‚¨cookieçš„å¯¹è±¡ã€‚è€Œ<code>HTTPCookieProcessor</code>å¤„ç†å™¨ä¸»è¦ä½œç”¨æ˜¯å¤„ç†è¿™äº›cookieå¯¹è±¡ï¼Œå¹¶æ„å»ºhandlerå¯¹è±¡ã€‚</p>
<h4 id="httpcookiejaræ¨¡å—">http.cookiejaræ¨¡å—ï¼š</h4>
<p>è¯¥æ¨¡å—ä¸»è¦çš„ç±»æœ‰CookieJarã€FileCookieJarã€MozillaCookieJarã€LWPCookieJarã€‚è¿™å››ä¸ªç±»çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ol>
<li>CookieJarï¼šç®¡ç†HTTP cookieå€¼ã€å­˜å‚¨HTTPè¯·æ±‚ç”Ÿæˆçš„cookieã€å‘ä¼ å‡ºçš„HTTPè¯·æ±‚æ·»åŠ cookieçš„å¯¹è±¡ã€‚æ•´ä¸ªcookieéƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯¹CookieJarå®ä¾‹è¿›è¡Œåƒåœ¾å›æ”¶åcookieä¹Ÿå°†ä¸¢å¤±ã€‚</li>
<li>FileCookieJar (filename,delayload=None,policy=None)ï¼šä»CookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œç”¨æ¥åˆ›å»ºFileCookieJarå®ä¾‹ï¼Œæ£€ç´¢cookieä¿¡æ¯å¹¶å°†cookieå­˜å‚¨åˆ°æ–‡ä»¶ä¸­ã€‚filenameæ˜¯å­˜å‚¨cookieçš„æ–‡ä»¶åã€‚delayloadä¸ºTrueæ—¶æ”¯æŒå»¶è¿Ÿè®¿é—®è®¿é—®æ–‡ä»¶ï¼Œå³åªæœ‰åœ¨éœ€è¦æ—¶æ‰è¯»å–æ–‡ä»¶æˆ–åœ¨æ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®ã€‚</li>
<li>MozillaCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸Mozillaæµè§ˆå™¨ cookies.txtå…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
<li>LWPCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸libwww-perlæ ‡å‡†çš„ Set-Cookie3 æ–‡ä»¶æ ¼å¼å…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
</ol>
<h4 id="ç™»å½•äººäººç½‘">ç™»å½•äººäººç½‘ï¼š</h4>
<p>åˆ©ç”¨<code>http.cookiejar</code>å’Œ<code>request.HTTPCookieProcessor</code>ç™»å½•äººäººç½‘ã€‚ç›¸å…³ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse
from http.cookiejar import CookieJar

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}

def get_opener():
    cookiejar = CookieJar()
    handler = request.HTTPCookieProcessor(cookiejar)
    opener = request.build_opener(handler)
    return opener

def login_renren(opener):
    data = {&quot;email&quot;: &quot;970138074@qq.com&quot;, &quot;password&quot;: &quot;pythonspider&quot;}
    data = parse.urlencode(data).encode('utf-8')
    login_url = &quot;http://www.renren.com/PLogin.do&quot;
    req = request.Request(login_url, headers=headers, data=data)
    opener.open(req)

def visit_profile(opener):
    url = 'http://www.renren.com/880151247/profile'
    req = request.Request(url,headers=headers)
    resp = opener.open(req)
    with open('renren.html','w') as fp:
        fp.write(resp.read().decode(&quot;utf-8&quot;))

if __name__ == '__main__':
    opener = get_opener()
    login_renren(opener)
    visit_profile(opener)
</code></pre>
<h4 id="ä¿å­˜cookieåˆ°æœ¬åœ°">ä¿å­˜cookieåˆ°æœ¬åœ°ï¼š</h4>
<p>ä¿å­˜<code>cookie</code>åˆ°æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨<code>cookiejar</code>çš„<code>save</code>æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
cookiejar.save(ignore_discard=True,ignore_expires=True)
</code></pre>
<h4 id="ä»æœ¬åœ°åŠ è½½cookie">ä»æœ¬åœ°åŠ è½½cookieï¼š</h4>
<p>ä»æœ¬åœ°åŠ è½½<code>cookie</code>ï¼Œéœ€è¦ä½¿ç”¨<code>cookiejar</code>çš„<code>load</code>æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿéœ€è¦æŒ‡å®šæ–¹æ³•ï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
cookiejar.load(ignore_expires=True,ignore_discard=True)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
</code></pre>
<!-- more -->
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[1-httpåè®®ä¸chromeæŠ“åŒ…å·¥å…·]]></title>
        <id>https://hehelv.github.io//post/1-http-xie-yi-yu-chrome-zhua-bao-gong-ju</id>
        <link href="https://hehelv.github.io//post/1-http-xie-yi-yu-chrome-zhua-bao-gong-ju">
        </link>
        <updated>2020-02-28T06:20:21.000Z</updated>
        <content type="html"><![CDATA[<h1 id="1-httpåè®®å’ŒchromeæŠ“åŒ…å·¥å…·">1-httpåè®®å’ŒChromeæŠ“åŒ…å·¥å…·</h1>
<h2 id="ä»€ä¹ˆæ˜¯httpå’Œhttpsåè®®">ä»€ä¹ˆæ˜¯httpå’Œhttpsåè®®ï¼š</h2>
<p>HTTPåè®®ï¼šå…¨ç§°æ˜¯<code>HyperText Transfer Protocol</code>ï¼Œä¸­æ–‡æ„æ€æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ˜¯ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶HTMLé¡µé¢çš„æ–¹æ³•ã€‚æœåŠ¡å™¨ç«¯å£å·æ˜¯<code>80</code>ç«¯å£ã€‚ HTTPSåè®®ï¼šæ˜¯HTTPåè®®çš„åŠ å¯†ç‰ˆæœ¬ï¼Œåœ¨HTTPä¸‹åŠ å…¥äº†SSLå±‚ã€‚æœåŠ¡å™¨ç«¯å£å·æ˜¯<code>443</code>ç«¯å£ã€‚</p>
<h2 id="åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ªhttpè¯·æ±‚çš„è¿‡ç¨‹">åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ªhttpè¯·æ±‚çš„è¿‡ç¨‹ï¼š</h2>
<ol>
<li>å½“ç”¨æˆ·åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥ä¸€ä¸ªURLå¹¶æŒ‰å›è½¦é”®ä¹‹åï¼Œæµè§ˆå™¨ä¼šå‘HTTPæœåŠ¡å™¨å‘é€HTTPè¯·æ±‚ã€‚HTTPè¯·æ±‚ä¸»è¦åˆ†ä¸ºâ€œGetâ€å’Œâ€œPostâ€ä¸¤ç§æ–¹æ³•ã€‚</li>
<li>å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è¾“å…¥URL http://www.baidu.com çš„æ—¶å€™ï¼Œæµè§ˆå™¨å‘é€ä¸€ä¸ªRequestè¯·æ±‚å»è·å– http://www.baidu.com çš„htmlæ–‡ä»¶ï¼ŒæœåŠ¡å™¨æŠŠResponseæ–‡ä»¶å¯¹è±¡å‘é€å›ç»™æµè§ˆå™¨ã€‚</li>
<li>æµè§ˆå™¨åˆ†æResponseä¸­çš„ HTMLï¼Œå‘ç°å…¶ä¸­å¼•ç”¨äº†å¾ˆå¤šå…¶ä»–æ–‡ä»¶ï¼Œæ¯”å¦‚Imagesæ–‡ä»¶ï¼ŒCSSæ–‡ä»¶ï¼ŒJSæ–‡ä»¶ã€‚ æµè§ˆå™¨ä¼šè‡ªåŠ¨å†æ¬¡å‘é€Requestå»è·å–å›¾ç‰‡ï¼ŒCSSæ–‡ä»¶ï¼Œæˆ–è€…JSæ–‡ä»¶ã€‚</li>
<li>å½“æ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¸‹è½½æˆåŠŸåï¼Œç½‘é¡µä¼šæ ¹æ®HTMLè¯­æ³•ç»“æ„ï¼Œå®Œæ•´çš„æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</li>
</ol>
<h2 id="urlè¯¦è§£">urlè¯¦è§£ï¼š</h2>
<p><code>URL</code>æ˜¯<code>Uniform Resource Locator</code>çš„ç®€å†™ï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚ ä¸€ä¸ª<code>URL</code>ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p>
<pre><code>    scheme://host:port/path/?query-string=xxx#anchor
</code></pre>
<ul>
<li><strong>scheme</strong>ï¼šä»£è¡¨çš„æ˜¯è®¿é—®çš„åè®®ï¼Œä¸€èˆ¬ä¸º<code>http</code>æˆ–è€…<code>https</code>ä»¥åŠ<code>ftp</code>ç­‰ã€‚</li>
<li><strong>host</strong>ï¼šä¸»æœºåï¼ŒåŸŸåï¼Œæ¯”å¦‚<code>www.baidu.com</code>ã€‚</li>
<li><strong>port</strong>ï¼šç«¯å£å·ã€‚å½“ä½ è®¿é—®ä¸€ä¸ªç½‘ç«™çš„æ—¶å€™ï¼Œæµè§ˆå™¨é»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚</li>
<li><strong>path</strong>ï¼šæŸ¥æ‰¾è·¯å¾„ã€‚æ¯”å¦‚ï¼š<code>www.jianshu.com/trending/now</code>ï¼Œåé¢çš„<code>trending/now</code>å°±æ˜¯<code>path</code>ã€‚</li>
<li><strong>query-string</strong>ï¼šæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š<code>www.baidu.com/s?wd=python</code>ï¼Œåé¢çš„<code>wd=python</code>å°±æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</li>
<li><strong>anchor</strong>ï¼šé”šç‚¹ï¼Œåå°ä¸€èˆ¬ä¸ç”¨ç®¡ï¼Œå‰ç«¯ç”¨æ¥åšé¡µé¢å®šä½çš„ã€‚</li>
</ul>
<p>åœ¨æµè§ˆå™¨ä¸­è¯·æ±‚ä¸€ä¸ª<code>url</code>ï¼Œæµè§ˆå™¨ä¼šå¯¹è¿™ä¸ªurlè¿›è¡Œä¸€ä¸ªç¼–ç ã€‚é™¤è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œéƒ¨åˆ†ç¬¦å·å¤–ï¼Œå…¶ä»–çš„å…¨éƒ¨ä½¿ç”¨ç™¾åˆ†å·+åå…­è¿›åˆ¶ç å€¼è¿›è¡Œç¼–ç ã€‚</p>
<h2 id="å¸¸ç”¨çš„è¯·æ±‚æ–¹æ³•">å¸¸ç”¨çš„è¯·æ±‚æ–¹æ³•ï¼š</h2>
<p>åœ¨<code>Http</code>åè®®ä¸­ï¼Œå®šä¹‰äº†å…«ç§è¯·æ±‚æ–¹æ³•ã€‚è¿™é‡Œä»‹ç»ä¸¤ç§å¸¸ç”¨çš„è¯·æ±‚æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯<code>get</code>è¯·æ±‚å’Œ<code>post</code>è¯·æ±‚ã€‚</p>
<ol>
<li><code>get</code>è¯·æ±‚ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªä»æœåŠ¡å™¨è·å–æ•°æ®ä¸‹æ¥ï¼Œå¹¶ä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿä»»ä½•å½±å“çš„æ—¶å€™ä¼šä½¿ç”¨<code>get</code>è¯·æ±‚ã€‚</li>
<li><code>post</code>è¯·æ±‚ï¼šå‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼ˆç™»å½•ï¼‰ã€ä¸Šä¼ æ–‡ä»¶ç­‰ï¼Œä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„æ—¶å€™ä¼šä½¿ç”¨<code>post</code>è¯·æ±‚ã€‚ ä»¥ä¸Šæ˜¯åœ¨ç½‘ç«™å¼€å‘ä¸­å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•ã€‚å¹¶ä¸”ä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¼šéµå¾ªä½¿ç”¨çš„åŸåˆ™ã€‚ä½†æ˜¯æœ‰çš„ç½‘ç«™å’ŒæœåŠ¡å™¨ä¸ºäº†åšåçˆ¬è™«æœºåˆ¶ï¼Œä¹Ÿç»å¸¸ä¼šä¸æŒ‰å¸¸ç†å‡ºç‰Œï¼Œæœ‰å¯èƒ½ä¸€ä¸ªåº”è¯¥ä½¿ç”¨<code>get</code>æ–¹æ³•çš„è¯·æ±‚å°±ä¸€å®šè¦æ”¹æˆ<code>post</code>è¯·æ±‚ï¼Œè¿™ä¸ªè¦è§†æƒ…å†µè€Œå®šã€‚</li>
</ol>
<h2 id="è¯·æ±‚å¤´å¸¸è§å‚æ•°">è¯·æ±‚å¤´å¸¸è§å‚æ•°ï¼š</h2>
<p>åœ¨<code>http</code>åè®®ä¸­ï¼Œå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ•°æ®åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŠŠæ•°æ®æ”¾åœ¨urlä¸­ï¼Œç¬¬äºŒä¸ªæ˜¯æŠŠæ•°æ®æ”¾åœ¨<code>body</code>ä¸­ï¼ˆåœ¨<code>post</code>è¯·æ±‚ä¸­ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå°±æ˜¯æŠŠæ•°æ®æ”¾åœ¨<code>head</code>ä¸­ã€‚è¿™é‡Œä»‹ç»åœ¨ç½‘ç»œçˆ¬è™«ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€äº›è¯·æ±‚å¤´å‚æ•°ï¼š</p>
<ol>
<li><code>User-Agent</code>ï¼šæµè§ˆå™¨åç§°ã€‚è¿™ä¸ªåœ¨ç½‘ç»œçˆ¬è™«ä¸­ç»å¸¸ä¼šè¢«ä½¿ç”¨åˆ°ã€‚è¯·æ±‚ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿™ä¸ªå‚æ•°å°±å¯ä»¥çŸ¥é“è¿™ä¸ªè¯·æ±‚æ˜¯ç”±å“ªç§æµè§ˆå™¨å‘é€çš„ã€‚å¦‚æœæˆ‘ä»¬æ˜¯é€šè¿‡çˆ¬è™«å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„<code>User-Agent</code>å°±æ˜¯<code>Python</code>ï¼Œè¿™å¯¹äºé‚£äº›æœ‰åçˆ¬è™«æœºåˆ¶çš„ç½‘ç«™æ¥è¯´ï¼Œå¯ä»¥è½»æ˜“çš„åˆ¤æ–­ä½ è¿™ä¸ªè¯·æ±‚æ˜¯çˆ¬è™«ã€‚å› æ­¤æˆ‘ä»¬è¦ç»å¸¸è®¾ç½®è¿™ä¸ªå€¼ä¸ºä¸€äº›æµè§ˆå™¨çš„å€¼ï¼Œæ¥ä¼ªè£…æˆ‘ä»¬çš„çˆ¬è™«ã€‚</li>
<li><code>Referer</code>ï¼šè¡¨æ˜å½“å‰è¿™ä¸ªè¯·æ±‚æ˜¯ä»å“ªä¸ª<code>url</code>è¿‡æ¥çš„ã€‚è¿™ä¸ªä¸€èˆ¬ä¹Ÿå¯ä»¥ç”¨æ¥åšåçˆ¬è™«æŠ€æœ¯ã€‚å¦‚æœä¸æ˜¯ä»æŒ‡å®šé¡µé¢è¿‡æ¥çš„ï¼Œé‚£ä¹ˆå°±ä¸åšç›¸å…³çš„å“åº”ã€‚</li>
<li><code>Cookie</code>ï¼š<code>http</code>åè®®æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯åŒä¸€ä¸ªäººå‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ²¡æœ‰èƒ½åŠ›çŸ¥é“è¿™ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€ä¸ªäººã€‚å› æ­¤è¿™æ—¶å€™å°±ç”¨<code>cookie</code>æ¥åšæ ‡è¯†ã€‚ä¸€èˆ¬å¦‚æœæƒ³è¦åšç™»å½•åæ‰èƒ½è®¿é—®çš„ç½‘ç«™ï¼Œé‚£ä¹ˆå°±éœ€è¦å‘é€<code>cookie</code>ä¿¡æ¯äº†ã€‚</li>
</ol>
<h2 id="å¸¸è§å“åº”çŠ¶æ€ç ">å¸¸è§å“åº”çŠ¶æ€ç ï¼š</h2>
<ol>
<li><code>200</code>ï¼šè¯·æ±‚æ­£å¸¸ï¼ŒæœåŠ¡å™¨æ­£å¸¸çš„è¿”å›æ•°æ®ã€‚</li>
<li><code>301</code>ï¼šæ°¸ä¹…é‡å®šå‘ã€‚æ¯”å¦‚åœ¨è®¿é—®<code>www.jingdong.com</code>çš„æ—¶å€™ä¼šé‡å®šå‘åˆ°<code>www.jd.com</code>ã€‚</li>
<li><code>302</code>ï¼šä¸´æ—¶é‡å®šå‘ã€‚æ¯”å¦‚åœ¨è®¿é—®ä¸€ä¸ªéœ€è¦ç™»å½•çš„é¡µé¢çš„æ—¶å€™ï¼Œè€Œæ­¤æ—¶æ²¡æœ‰ç™»å½•ï¼Œé‚£ä¹ˆå°±ä¼šé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚</li>
<li><code>400</code>ï¼šè¯·æ±‚çš„<code>url</code>åœ¨æœåŠ¡å™¨ä¸Šæ‰¾ä¸åˆ°ã€‚æ¢å¥è¯è¯´å°±æ˜¯è¯·æ±‚<code>url</code>é”™è¯¯ã€‚</li>
<li><code>403</code>ï¼šæœåŠ¡å™¨æ‹’ç»è®¿é—®ï¼Œæƒé™ä¸å¤Ÿã€‚</li>
<li><code>500</code>ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚å¯èƒ½æ˜¯æœåŠ¡å™¨å‡ºç°<code>bug</code>äº†ã€‚</li>
</ol>
<h2 id="chromeæŠ“åŒ…å·¥å…·">ChromeæŠ“åŒ…å·¥å…·ï¼š</h2>
<p><code>Chrome</code>æµè§ˆå™¨æ˜¯ä¸€ä¸ªéå¸¸äº²è¿‘å¼€å‘è€…çš„æµè§ˆå™¨ã€‚å¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ä»¥åŠå‘é€çš„å‚æ•°ã€‚å¯¹ç€ç½‘é¡µ<code>å³é”®-&gt;æ£€æŸ¥</code>ã€‚ç„¶åå°±å¯ä»¥æ‰“å¼€å¼€å‘è€…é€‰é¡¹ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[TCPIPè¯¦è§£]]></title>
        <id>https://hehelv.github.io//post/tcpip-xiang-jie</id>
        <link href="https://hehelv.github.io//post/tcpip-xiang-jie">
        </link>
        <updated>2020-02-20T06:49:46.000Z</updated>
        <content type="html"><![CDATA[<h1 id="2-beautifulsoup4åº“">2-BeautifulSoup4åº“</h1>
<p>å’Œ lxml ä¸€æ ·ï¼ŒBeautiful Soup ä¹Ÿæ˜¯ä¸€ä¸ªHTML/XMLçš„è§£æå™¨ï¼Œä¸»è¦çš„åŠŸèƒ½ä¹Ÿæ˜¯å¦‚ä½•è§£æå’Œæå– HTML/XML æ•°æ®ã€‚<br>
lxml åªä¼šå±€éƒ¨éå†ï¼Œè€ŒBeautiful Soup æ˜¯åŸºäºHTML DOMï¼ˆDocument Object Modelï¼‰çš„ï¼Œä¼šè½½å…¥æ•´ä¸ªæ–‡æ¡£ï¼Œè§£ææ•´ä¸ªDOMæ ‘ï¼Œå› æ­¤æ—¶é—´å’Œå†…å­˜å¼€é”€éƒ½ä¼šå¤§å¾ˆå¤šï¼Œæ‰€ä»¥æ€§èƒ½è¦ä½äºlxmlã€‚<br>
BeautifulSoup ç”¨æ¥è§£æ HTML æ¯”è¾ƒç®€å•ï¼ŒAPIéå¸¸äººæ€§åŒ–ï¼Œæ”¯æŒCSSé€‰æ‹©å™¨ã€Pythonæ ‡å‡†åº“ä¸­çš„HTMLè§£æå™¨ï¼Œä¹Ÿæ”¯æŒ lxml çš„ XMLè§£æå™¨ã€‚<br>
Beautiful Soup 3 ç›®å‰å·²ç»åœæ­¢å¼€å‘ï¼Œæ¨èç°åœ¨çš„é¡¹ç›®ä½¿ç”¨Beautiful Soup 4ã€‚</p>
<h2 id="å®‰è£…å’Œæ–‡æ¡£">å®‰è£…å’Œæ–‡æ¡£ï¼š</h2>
<ol>
<li>å®‰è£…ï¼š<code>pip install bs4</code>ã€‚</li>
<li>ä¸­æ–‡æ–‡æ¡£ï¼šhttps://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</li>
</ol>
<h2 id="å‡ å¤§è§£æå·¥å…·å¯¹æ¯”">å‡ å¤§è§£æå·¥å…·å¯¹æ¯”ï¼š</h2>
<table>
<thead>
<tr>
<th>è§£æå·¥å…·</th>
<th>è§£æé€Ÿåº¦</th>
<th>ä½¿ç”¨éš¾åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>BeautifulSoup</td>
<td>æœ€æ…¢</td>
<td>æœ€ç®€å•</td>
</tr>
<tr>
<td>lxml</td>
<td>å¿«</td>
<td>ç®€å•</td>
</tr>
<tr>
<td>æ­£åˆ™</td>
<td>æœ€å¿«</td>
<td>æœ€éš¾</td>
</tr>
</tbody>
</table>
<h2 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨ï¼š</h2>
<pre><code class="language-python">from bs4 import BeautifulSoup

html = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

#åˆ›å»º Beautiful Soup å¯¹è±¡
# ä½¿ç”¨lxmlæ¥è¿›è¡Œè§£æ
soup = BeautifulSoup(html,&quot;lxml&quot;)

print(soup.prettify())
</code></pre>
<h2 id="å››ä¸ªå¸¸ç”¨çš„å¯¹è±¡">å››ä¸ªå¸¸ç”¨çš„å¯¹è±¡ï¼š</h2>
<p>Beautiful Soupå°†å¤æ‚HTMLæ–‡æ¡£è½¬æ¢æˆä¸€ä¸ªå¤æ‚çš„æ ‘å½¢ç»“æ„,æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯Pythonå¯¹è±¡,æ‰€æœ‰å¯¹è±¡å¯ä»¥å½’çº³ä¸º4ç§:</p>
<ol>
<li>Tag</li>
<li>NavigatableString</li>
<li>BeautifulSoup</li>
<li>Comment</li>
</ol>
<h3 id="1-tag">1. Tagï¼š</h3>
<p>Tag é€šä¿—ç‚¹è®²å°±æ˜¯ HTML ä¸­çš„ä¸€ä¸ªä¸ªæ ‡ç­¾ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">(from bs4 import BeautifulSoup)

html = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;
&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

#åˆ›å»º Beautiful Soup å¯¹è±¡
soup = BeautifulSoup(html,'lxml')


print (soup.title)
# &lt;title&gt;The Dormouse's story&lt;/title&gt;

print (soup.head)
# &lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;

print (soup.a)
# &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;

print( soup.p)
# &lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;

print (type(soup.p))
# &lt;class 'bs4.element.Tag'&gt;
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ soup åŠ æ ‡ç­¾åè½»æ¾åœ°è·å–è¿™äº›æ ‡ç­¾çš„å†…å®¹ï¼Œè¿™äº›å¯¹è±¡çš„ç±»å‹æ˜¯bs4.element.Tagã€‚ä½†æ˜¯æ³¨æ„ï¼Œå®ƒæŸ¥æ‰¾çš„æ˜¯åœ¨æ‰€æœ‰å†…å®¹ä¸­çš„ç¬¬ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„æ ‡ç­¾ã€‚å¦‚æœè¦æŸ¥è¯¢æ‰€æœ‰çš„æ ‡ç­¾ï¼Œåé¢ä¼šè¿›è¡Œä»‹ç»ã€‚<br>
å¯¹äºTagï¼Œå®ƒæœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼Œåˆ†åˆ«æ˜¯nameå’Œattrsã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print soup.name
# [document] #soup å¯¹è±¡æœ¬èº«æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„ name å³ä¸º [document]

print soup.head.name
# head #å¯¹äºå…¶ä»–å†…éƒ¨æ ‡ç­¾ï¼Œè¾“å‡ºçš„å€¼ä¾¿ä¸ºæ ‡ç­¾æœ¬èº«çš„åç§°

print soup.p.attrs
# {'class': ['title'], 'name': 'dromouse'}
# åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ p æ ‡ç­¾çš„æ‰€æœ‰å±æ€§æ‰“å°è¾“å‡ºäº†å‡ºæ¥ï¼Œå¾—åˆ°çš„ç±»å‹æ˜¯ä¸€ä¸ªå­—å…¸ã€‚

print soup.p['class'] # soup.p.get('class')
# ['title'] #è¿˜å¯ä»¥åˆ©ç”¨getæ–¹æ³•ï¼Œä¼ å…¥å±æ€§çš„åç§°ï¼ŒäºŒè€…æ˜¯ç­‰ä»·çš„

soup.p['class'] = &quot;newClass&quot;
print soup.p # å¯ä»¥å¯¹è¿™äº›å±æ€§å’Œå†…å®¹ç­‰ç­‰è¿›è¡Œä¿®æ”¹
# &lt;p class=&quot;newClass&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
</code></pre>
<h3 id="2-navigablestring">2. NavigableStringï¼š</h3>
<p>å¦‚æœæ‹¿åˆ°æ ‡ç­¾åï¼Œè¿˜æƒ³è·å–æ ‡ç­¾ä¸­çš„å†…å®¹ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡<code>tag.string</code>è·å–æ ‡ç­¾ä¸­çš„æ–‡å­—ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print (soup.p.string)
# The Dormouse's story

print (type(soup.p.string))
# &lt;class 'bs4.element.NavigableString'&gt;thon
</code></pre>
<h3 id="3-beautifulsoup">3. BeautifulSoupï¼š</h3>
<p>BeautifulSoup å¯¹è±¡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ–‡æ¡£çš„å…¨éƒ¨å†…å®¹.å¤§éƒ¨åˆ†æ—¶å€™,å¯ä»¥æŠŠå®ƒå½“ä½œ Tag å¯¹è±¡,å®ƒæ”¯æŒ éå†æ–‡æ¡£æ ‘ å’Œ æœç´¢æ–‡æ¡£æ ‘ ä¸­æè¿°çš„å¤§éƒ¨åˆ†çš„æ–¹æ³•.<br>
å› ä¸º BeautifulSoup å¯¹è±¡å¹¶ä¸æ˜¯çœŸæ­£çš„HTMLæˆ–XMLçš„tag,æ‰€ä»¥å®ƒæ²¡æœ‰nameå’Œattributeå±æ€§.ä½†æœ‰æ—¶æŸ¥çœ‹å®ƒçš„ .name å±æ€§æ˜¯å¾ˆæ–¹ä¾¿çš„,æ‰€ä»¥ BeautifulSoup å¯¹è±¡åŒ…å«äº†ä¸€ä¸ªå€¼ä¸º â€œ[document]â€ çš„ç‰¹æ®Šå±æ€§ .name</p>
<pre><code class="language-python">soup.name
# '[document]'
</code></pre>
<h3 id="4-comment">4. Commentï¼š</h3>
<p>Tag , NavigableString , BeautifulSoup å‡ ä¹è¦†ç›–äº†htmlå’Œxmlä¸­çš„æ‰€æœ‰å†…å®¹,ä½†æ˜¯è¿˜æœ‰ä¸€äº›ç‰¹æ®Šå¯¹è±¡.å®¹æ˜“è®©äººæ‹…å¿ƒçš„å†…å®¹æ˜¯æ–‡æ¡£çš„æ³¨é‡Šéƒ¨åˆ†:</p>
<pre><code class="language-python">markup = &quot;&lt;b&gt;&lt;!--Hey, buddy. Want to buy a used parser?--&gt;&lt;/b&gt;&quot;
soup = BeautifulSoup(markup)
comment = soup.b.string
type(comment)
# &lt;class 'bs4.element.Comment'&gt;
</code></pre>
<p>Comment å¯¹è±¡æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„ NavigableString å¯¹è±¡:</p>
<pre><code class="language-python">comment
# 'Hey, buddy. Want to buy a used parser'
</code></pre>
<h2 id="éå†æ–‡æ¡£æ ‘">éå†æ–‡æ¡£æ ‘ï¼š</h2>
<h3 id="1-contentså’Œchildren">1. contentså’Œchildrenï¼š</h3>
<pre><code class="language-python">html_doc = &quot;&quot;&quot;
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;

&lt;p class=&quot;title&quot;&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;

&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were
&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,
&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and
&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;

&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;
&quot;&quot;&quot;

from bs4 import BeautifulSoup
soup = BeautifulSoup(html_doc,'lxml')

head_tag = soup.head
# è¿”å›æ‰€æœ‰å­èŠ‚ç‚¹çš„åˆ—è¡¨
print(head_tag.contents)

# è¿”å›æ‰€æœ‰å­èŠ‚ç‚¹çš„è¿­ä»£å™¨
for child in head_tag.children:
    print(child)
</code></pre>
<h3 id="2-strings-å’Œ-stripped_strings">2. strings å’Œ stripped_strings</h3>
<p>å¦‚æœtagä¸­åŒ…å«å¤šä¸ªå­—ç¬¦ä¸² [2] ,å¯ä»¥ä½¿ç”¨ .strings æ¥å¾ªç¯è·å–ï¼š</p>
<pre><code class="language-python">for string in soup.strings:
    print(repr(string))
    # u&quot;The Dormouse's story&quot;
    # u'\n\n'
    # u&quot;The Dormouse's story&quot;
    # u'\n\n'
    # u'Once upon a time there were three little sisters; and their names were\n'
    # u'Elsie'
    # u',\n'
    # u'Lacie'
    # u' and\n'
    # u'Tillie'
    # u';\nand they lived at the bottom of a well.'
    # u'\n\n'
    # u'...'
    # u'\n'
</code></pre>
<p>è¾“å‡ºçš„å­—ç¬¦ä¸²ä¸­å¯èƒ½åŒ…å«äº†å¾ˆå¤šç©ºæ ¼æˆ–ç©ºè¡Œ,ä½¿ç”¨ .stripped_strings å¯ä»¥å»é™¤å¤šä½™ç©ºç™½å†…å®¹ï¼š</p>
<pre><code class="language-python">for string in soup.stripped_strings:
    print(repr(string))
    # u&quot;The Dormouse's story&quot;
    # u&quot;The Dormouse's story&quot;
    # u'Once upon a time there were three little sisters; and their names were'
    # u'Elsie'
    # u','
    # u'Lacie'
    # u'and'
    # u'Tillie'
    # u';\nand they lived at the bottom of a well.'
    # u'...'
</code></pre>
<h3 id="è·å–æ ‡ç­¾å±æ€§">è·å–æ ‡ç­¾å±æ€§</h3>
<p>1.é€šè¿‡ä¸‹æ ‡è·å–</p>
<pre><code class="language-python">href = a['href']
</code></pre>
<p>2.é€šè¿‡attrså±æ€§è·å–</p>
<pre><code class="language-python">href=a.attrs['href']
</code></pre>
<h3 id="å°ç»“">å°ç»“</h3>
<ol>
<li>string: è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚è¿”å›æ¥çš„æ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>strings: è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚è¿”å›æ¥çš„æ˜¯ä¸ªç”Ÿæˆå™¨ã€‚</li>
<li>stripped_strings:è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ï¼Œä¼šå»æ‰ç©ºç™½å­—ç¬¦ã€‚è¿”å›æ¥çš„<br>
æ˜¯ä¸ªç”Ÿæˆå™¨ã€‚</li>
<li>get_ _text:è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„å­å­™éæ ‡ç­¾å­—ç¬¦ä¸²ã€‚ä¸æ˜¯ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›ï¼Œæ˜¯ä»¥æ™®é€šå­—<br>
ç¬¦ä¸²è¿”å›ã€‚</li>
</ol>
<h2 id="æœç´¢æ–‡æ¡£æ ‘">æœç´¢æ–‡æ¡£æ ‘ï¼š</h2>
<h3 id="1-findå’Œfind_allæ–¹æ³•">1. findå’Œfind_allæ–¹æ³•ï¼š</h3>
<p>æœç´¢æ–‡æ¡£æ ‘ï¼Œä¸€èˆ¬ç”¨å¾—æ¯”è¾ƒå¤šçš„å°±æ˜¯ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯<code>find</code>ï¼Œä¸€ä¸ªæ˜¯<code>find_all</code>ã€‚<code>find</code>æ–¹æ³•æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ ‡ç­¾åå°±ç«‹å³è¿”å›ï¼Œåªè¿”å›ä¸€ä¸ªå…ƒç´ ã€‚<code>find_all</code>æ–¹æ³•æ˜¯æŠŠæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ ‡ç­¾éƒ½é€‰åˆ°ï¼Œç„¶åè¿”å›å›å»ã€‚ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯å‡ºå…¥<code>name</code>ä»¥åŠ<code>attr</code>å‚æ•°æ‰¾å‡ºç¬¦åˆè¦æ±‚çš„æ ‡ç­¾ã€‚</p>
<pre><code class="language-python">soup.find_all(&quot;a&quot;,attrs={&quot;id&quot;:&quot;link2&quot;})
</code></pre>
<p>æˆ–è€…æ˜¯ç›´æ¥ä¼ å…¥å±æ€§çš„çš„åå­—ä½œä¸ºå…³é”®å­—å‚æ•°ï¼š</p>
<pre><code class="language-python">soup.find_all(&quot;a&quot;,id='link2')
</code></pre>
<h3 id="2-selectæ–¹æ³•">2. selectæ–¹æ³•ï¼š</h3>
<p>ä½¿ç”¨ä»¥ä¸Šæ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æ‰¾å‡ºå…ƒç´ ã€‚ä½†æœ‰æ—¶å€™ä½¿ç”¨<code>css</code>é€‰æ‹©å™¨çš„æ–¹å¼å¯ä»¥æ›´åŠ çš„æ–¹ä¾¿ã€‚ä½¿ç”¨<code>css</code>é€‰æ‹©å™¨çš„è¯­æ³•ï¼Œåº”è¯¥ä½¿ç”¨<code>select</code>æ–¹æ³•ã€‚ä»¥ä¸‹åˆ—å‡ºå‡ ç§å¸¸ç”¨çš„<code>css</code>é€‰æ‹©å™¨æ–¹æ³•ï¼š</p>
<h4 id="1é€šè¿‡æ ‡ç­¾åæŸ¥æ‰¾">ï¼ˆ1ï¼‰é€šè¿‡æ ‡ç­¾åæŸ¥æ‰¾ï¼š</h4>
<pre><code class="language-python">print(soup.select('a'))
</code></pre>
<h4 id="2é€šè¿‡ç±»åæŸ¥æ‰¾">ï¼ˆ2ï¼‰é€šè¿‡ç±»åæŸ¥æ‰¾ï¼š</h4>
<p>é€šè¿‡ç±»åï¼Œåˆ™åº”è¯¥åœ¨ç±»çš„å‰é¢åŠ ä¸€ä¸ª<code>.</code>ã€‚æ¯”å¦‚è¦æŸ¥æ‰¾<code>class=sister</code>çš„æ ‡ç­¾ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select('.sister'))
</code></pre>
<h4 id="3é€šè¿‡idæŸ¥æ‰¾">ï¼ˆ3ï¼‰é€šè¿‡idæŸ¥æ‰¾ï¼š</h4>
<p>é€šè¿‡idæŸ¥æ‰¾ï¼Œåº”è¯¥åœ¨idçš„åå­—å‰é¢åŠ ä¸€ä¸ªï¼ƒå·ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;#link1&quot;))
</code></pre>
<h4 id="4ç»„åˆæŸ¥æ‰¾">ï¼ˆ4ï¼‰ç»„åˆæŸ¥æ‰¾ï¼š</h4>
<p>ç»„åˆæŸ¥æ‰¾å³å’Œå†™ class æ–‡ä»¶æ—¶ï¼Œæ ‡ç­¾åä¸ç±»åã€idåè¿›è¡Œçš„ç»„åˆåŸç†æ˜¯ä¸€æ ·çš„ï¼Œä¾‹å¦‚æŸ¥æ‰¾ p æ ‡ç­¾ä¸­ï¼Œid ç­‰äº link1çš„å†…å®¹ï¼ŒäºŒè€…éœ€è¦ç”¨ç©ºæ ¼åˆ†å¼€ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;p #link1&quot;))
</code></pre>
<p>ç›´æ¥å­æ ‡ç­¾æŸ¥æ‰¾ï¼Œåˆ™ä½¿ç”¨ &gt; åˆ†éš”ï¼š</p>
<pre><code class="language-python">print(soup.select(&quot;head &gt; title&quot;))
</code></pre>
<h4 id="5é€šè¿‡å±æ€§æŸ¥æ‰¾">ï¼ˆ5ï¼‰é€šè¿‡å±æ€§æŸ¥æ‰¾ï¼š</h4>
<p>æŸ¥æ‰¾æ—¶è¿˜å¯ä»¥åŠ å…¥å±æ€§å…ƒç´ ï¼Œå±æ€§éœ€è¦ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ï¼Œæ³¨æ„å±æ€§å’Œæ ‡ç­¾å±äºåŒä¸€èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸­é—´ä¸èƒ½åŠ ç©ºæ ¼ï¼Œå¦åˆ™ä¼šæ— æ³•åŒ¹é…åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">print(soup.select('a[href=&quot;http://example.com/elsie&quot;]'))
</code></pre>
<h4 id="6è·å–å†…å®¹">ï¼ˆ6ï¼‰è·å–å†…å®¹</h4>
<p>ä»¥ä¸Šçš„ select æ–¹æ³•è¿”å›çš„ç»“æœéƒ½æ˜¯åˆ—è¡¨å½¢å¼ï¼Œå¯ä»¥éå†å½¢å¼è¾“å‡ºï¼Œç„¶åç”¨ get_text() æ–¹æ³•æ¥è·å–å®ƒçš„å†…å®¹ã€‚</p>
<pre><code class="language-python">soup = BeautifulSoup(html, 'lxml')
print type(soup.select('title'))
print soup.select('title')[0].get_text()

for title in soup.select('title'):
    print title.get_text()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…«çš‡å]]></title>
        <id>https://hehelv.github.io//post/ba-huang-hou</id>
        <link href="https://hehelv.github.io//post/ba-huang-hou">
        </link>
        <updated>2020-01-18T13:47:19.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ä»£ç ">ä»£ç ï¼š</h1>
<pre><code class="language-c++">#include&lt;bits/stdc++.h&gt;
using namespace std;

int n,a[50],total;
int b[100],c[100],d[100];//b,c,dåˆ†åˆ«ä»£è¡¨åˆ—ï¼Œä¸»å¯¹è§’çº¿ï¼Œå‰¯å¯¹è§’çº¿ï¼Œåˆå§‹å€¼ä¸º0ï¼Œå½“æœ‰ä¸€ä¸ªçš‡åå‡ºç°æ—¶ï¼Œéœ€è¦å°†å…¶æ‰€å çš„åˆ—ï¼Œä¸»ï¼Œå‰¯å¯¹è§’çº¿æ ‡è®°ä¸º1

void dfs(int i)//è¿™é‡Œiä»£è¡¨çš„æ˜¯ç¬¬iä¸ªçš‡å
{
    if(i&gt;n)//i&gt;næ—¶è¯´æ˜å·²ç»æœ‰äº†ä¸€ç§è§£æ³•
    {
        total++;
        if(total&lt;=3)
        {
            for(int j=1;j&lt;=n;j++)
            {
                printf(&quot;%d &quot;,a[j]);
            }
            printf(&quot;\n&quot;);
        }
        return;
    }
    for(int j=1;j&lt;=n;j++)
    {
        if(!b[j]&amp;&amp;!c[i+j]&amp;&amp;!d[i-j+n])//ï¼ˆiï¼Œjï¼‰æ‰€å åˆ—ï¼Œä¸»ï¼Œå‰¯å¯¹è§’çº¿éƒ½æœªè¢«æ ‡è®°çš„æƒ…å†µä¸‹
        {
            a[i] = j;
            b[j] = 1;
            c[i+j] = 1;
            d[i-j+n] = 1;//æ‰“æ ‡è®°
            dfs(i+1);
            b[j] = 0;
            c[i+j] = 0;
            d[i-j+n] = 0;//å›æº¯çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ ‡è®°å»æ‰
        }
    }
}
int main()
{
    scanf(&quot;%d&quot;,&amp;n);
    dfs(1);
    printf(&quot;%d&quot;,total);
    return 0;
}
</code></pre>
<ul>
<li>éœ€è¦æ³¨æ„çš„å‡ ç‚¹æ€§è´¨ï¼ˆå…³äºè¿™ä¸ªæ€§è´¨å¯ä»¥å¾ˆå®¹æ˜“ç”»å›¾å¾—åˆ°ï¼‰ï¼š<br>
1.ä¸»å¯¹è§’çº¿ä¸Šæ‰€æœ‰ç‚¹çš„åæ ‡x+yç›¸ç­‰ï¼ˆè¿™é‡Œçš„ä¸»å¯¹è§’çº¿è¡¨ç¤ºçš„æ˜¯å·¦ä¸‹åˆ°å³ä¸Šï¼‰<br>
2.å‰¯å¯¹è§’çº¿ä¸Šæ‰€æœ‰ç‚¹çš„åæ ‡x-yç›¸ç­‰ï¼ˆå‰¯å¯¹è§’çº¿è¡¨ç¤ºå·¦ä¸Šåˆ°å³ä¸‹ï¼‰<br>
3.ä»£ç ä¸­d[i-j+n]ï¼ŒåŠ nçš„åŸå› æ˜¯i-jä¼šå‡ºç°è´Ÿæ•°ï¼Œè€Œæˆ‘ä»¬å¯¹å…¶åŠ ä»»æ„å¤§å°çš„æ•°ä¸ä¼šæ”¹å˜å¥¹è¡¨ç¤ºå‰¯å¯¹è§’çº¿çš„å”¯ä¸€æ€§ï¼Œè‡³äºåŠ nçš„åŸå› æ˜¯i-jæœ€å¤§çš„è´Ÿæ•°æ˜¯1-nï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åŠ nå³å¯ã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[äºŒåˆ†æŸ¥æ‰¾ï¼ˆbinary_searchï¼‰]]></title>
        <id>https://hehelv.github.io//post/er-fen-cha-zhao-binary_search</id>
        <link href="https://hehelv.github.io//post/er-fen-cha-zhao-binary_search">
        </link>
        <updated>2020-01-14T03:50:01.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ä¸€ä¸ªä¾‹å­">ä¸€ä¸ªä¾‹å­ï¼š</h1>
<p><img src="https://hehelv.github.io//post-images/1578974006618.png" alt=""><br>
æ ¹æ®è¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨ä¸€ä¸ªå››é‡å¾ªç¯æ¥å†™ï¼Œé€šè¿‡æš´åŠ›æ±‚è§£å¾—æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-c++">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int MAX_N = 50;

int main()
{
    int n,m,k[MAX_N];

    bool f = false;//åˆ¤æ–­æ˜¯å¦èƒ½æ‰¾åˆ°å’Œä¸ºmå¾—å››ä¸ªæ•°å­—
    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
    for(int i=0;i&lt;n;i++)
    {
        scanf(&quot;%d&quot;,k[i]);
    }

    for(int a=0;a&lt;n;a++)
    {
        for(int b=0;b&lt;n;b++)
        {
            for(int c=0;c&lt;n;c++)
            {
                for(int d=0;d&lt;n;d++)
                {
                    if(k[a]+k[b]+k[c]+k[d] == m)
                    {
                        f = true;
                    }
                }
            }
        }
    }
    if(f)
        puts(&quot;yes&quot;);
    else 
        puts(&quot;no&quot;);
    return 0;
}

/*
n=3
m=9
k={1,3,5}

no
*/

</code></pre>
<h1 id="æ›´å¿«çš„æ–¹æ³•äºŒåˆ†æŸ¥æ‰¾">æ›´å¿«çš„æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾</h1>
<p>æˆ‘ä»¬å‘ç°ç”¨å››é‡å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n<sup>4)ï¼Œæˆ‘ä»¬åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥ä»£æ›¿æœ€é‡Œé¢é‚£ä¸€å±‚çš„å¾ªç¯ï¼Œåœ¨ç”¨äºŒåˆ†æŸ¥æ‰¾ä¹‹å‰éœ€è¦æˆ‘ä»¬æ’åºï¼Œè€Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn),äºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logn),ä»£æ›¿æœ€é‡Œå±‚çš„å¾ªç¯åï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(n</sup>3logn),æ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºO(n^3logn)ã€‚</p>
<ul>
<li>ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="language-c++">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int MAX_N = 50;
int n,m,k[MAX_N];

bool Binary_Search(int x)
{
    int l=0,r=n;//è¿™é‡Œè¦æ±‚rå¿…é¡»ç­‰äºnï¼Œä¹Ÿå°±æ˜¯è¯´è¦å¤šå‡ºä¸€ä¸ªæ— ç”¨çš„æ•°ç»„ä½ï¼Œå› ä¸ºå½“x=k[n-1]æ—¶ï¼Œlæœ€ç»ˆä¼šç­‰äºn-1ï¼Œå¦‚æœr=n-1åˆ™ä¼šæå‰é€€å‡ºå¾ªç¯
    while(r-l &gt;= 1)
    {
        int i = (r+l)/2;
        if(k[i] == x) return true;
        else if(k[i] &lt; x) l = i+1;
        else r = i;
    }
    return false;
}

int main()
{
    bool f = false;//åˆ¤æ–­æ˜¯å¦èƒ½æ‰¾åˆ°å’Œä¸ºmå¾—å››ä¸ªæ•°å­—

    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);

    for(int i=0;i&lt;n;i++)
    {
        scanf(&quot;%d&quot;,&amp;k[i]);
    }
    sort(k,k+n);//å°†æ•°ç»„æ’åº

    for(int a=0;a&lt;n;a++)
    {
        for(int b=0;b&lt;n;b++)
        {
            for(int c=0;c&lt;n;c++)
            {
                if(Binary_Search(m-k[a]-k[b]-k[c]))
                    f = true;
            }
        }
    }
    if(f)
        puts(&quot;yes&quot;);
    else 
        puts(&quot;no&quot;);
    return 0;
}

/*
n=3
m=9
k={1,3,5}

no
*/

</code></pre>
<h1 id="å†ä¼˜åŒ–">å†ä¼˜åŒ–ï¼š</h1>
<ul>
<li>å†ä½¿ç”¨äº†äºŒåˆ†æŸ¥æ‰¾ä¹‹åæ—¶é—´å¤æ‚åº¦ä¸ºO(n^3logn),å¯ä»¥åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†å››é‡å¾ªç¯çš„å†…ä¸¤å±‚å¾ªç¯æ¢æˆäºŒåˆ†æŸ¥æ‰¾ï¼Œè¿™æ—¶å€™çš„å¼å­ä¸ºk[c]+k[d] = m-k[a]-k[b],æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°ç»„æ¥ä¿å­˜k[c]+k[d]çš„æ‰€æœ‰æƒ…å†µã€‚</li>
<li>è¿™æ—¶å€™çš„æ—¶é—´å¤æ‚åº¦ï¼š</li>
<li>1.æ’åºæ—¶é—´å¤æ‚åº¦ï¼šO(n^2logn)</li>
<li>2.å¾ªç¯åŠ äºŒåˆ†æŸ¥æ‰¾å¤æ‚åº¦ï¼šO(n^2logn)</li>
<li>åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå†å»ä¸€å±‚å¾ªç¯å·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œå› ä¸ºæ­¤æ—¶çš„æ•°ç»„æ’åºæ—¶é—´å¤æ‚åº¦ä¸ºO(n^3logn).</li>
<li>ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="language-c++">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int MAX_N = 50;
int n,m,k[MAX_N];
int kk[MAX_N*MAX_N];

bool Binary_Search(int x)
{
    int l=0,r=n;//è¿™é‡Œè¦æ±‚rå¿…é¡»ç­‰äºnï¼Œä¹Ÿå°±æ˜¯è¯´è¦å¤šå‡ºä¸€ä¸ªæ— ç”¨çš„æ•°ç»„ä½ï¼Œå› ä¸ºä½†x=k[n-1]æ—¶ï¼Œlæœ€ç»ˆä¼šç­‰äºn-1ï¼Œå¦‚æœr=n-1åˆ™ä¼šæå‰é€€å‡ºå¾ªç¯
    while(r-l &gt;= 1)
    {
        int i = (r+l)/2;
        if(kk[i] == x) return true;
        else if(kk[i] &lt; x) l = i+1;
        else r = i;
    }
    return false;
}

int main()
{
    bool f = false;//åˆ¤æ–­æ˜¯å¦èƒ½æ‰¾åˆ°å’Œä¸ºmå¾—å››ä¸ªæ•°å­—

    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);

    for(int i=0;i&lt;n;i++)
    {
        scanf(&quot;%d&quot;,&amp;k[i]);
    }
    for(int c=0;c&lt;n;c++)
    {
        for(int d=0;d&lt;n;d++)
        {
            kk[c*n+d] = k[c] + k[d];
        }
    }

    sort(kk,kk+n*n);//å°†æ•°ç»„æ’åº

    for(int a=0;a&lt;n;a++)
    {
        for(int b=0;b&lt;n;b++)
        {
            if(Binary_Search(m-k[a]-k[b]))
                    f = true;
        }
    }
    if(f)
        puts(&quot;yes&quot;);
    else 
        puts(&quot;no&quot;);
    return 0;
}
/*
n=3
m=9
k={1,3,5}

no
*/
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Antsé—®é¢˜]]></title>
        <id>https://hehelv.github.io//post/ants-wen-ti</id>
        <link href="https://hehelv.github.io//post/ants-wen-ti">
        </link>
        <updated>2020-01-10T12:56:46.000Z</updated>
        <content type="html"><![CDATA[<h1 id="é—®é¢˜">é—®é¢˜ï¼š</h1>
<figure data-type="image" tabindex="1"><img src="https://hehelv.github.io//post-images/1578666147784.png" alt=""></figure>
<ul>
<li>è§£å†³æ€è·¯ï¼š</li>
<li>æˆ‘ä»¬æƒ³è€ƒè™‘ä¸€ä¸‹å¦‚æœä¸¤åªèš‚èšç›¸é‡äº†çš„æƒ…å½¢ï¼š</li>
<li><img src="https://hehelv.github.io//post-images/1578666310683.png" alt=""></li>
<li>å‘ç°æ¯åªèš‚èšéƒ½å¯ä»¥çœ‹æˆç›¸é‡åä»ç„¶ä¸è°ƒè½¬æ–¹å‘ï¼Œå› ä¸ºé—®é¢˜æœ¬èº«ä¸å…³æ³¨ä¸ªä½“çš„èš‚èšï¼Œåœ¨æˆ‘ä»¬çœ‹æ¥æ‰€æœ‰çš„èš‚èšéƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>
</ul>
<h1 id="ä»£ç å¦‚ä¸‹">ä»£ç å¦‚ä¸‹ï¼š</h1>
<pre><code class="language-c">#include&lt;bits/stdc++.h&gt;
#define MAX_N 100

int max(int x,int y)
{
    if(x-y&gt;0)
        return x;
    else return y;
}

int min(int x,int y)
{
    if(x-y&gt;0)
        return y;
    else return x;
}

int main()
{
    int L,n;
    int minT,maxT;
    int a[MAX_N];  //ç”¨æ¥æ”¶é›†æ¯åªèš‚èšçš„ä¿¡æ¯
    scanf(&quot;%d%d&quot;,&amp;L,&amp;n);
    for(int i=1;i&lt;=n;i++)
    {
        scanf(&quot;%d&quot;,&amp;a[i]);
    }
    for(int i=1;i&lt;=n;i++)
    {
        minT = max(minT,min(a[i],L-a[i]));
        maxT = max(maxT,max(a[i],L-a[i]));
    }
    printf(&quot;min:%d max:%d&quot;,minT,maxT);
    return 0;
}
/*
10 3
2
6
7
min:4 max:8
*/
</code></pre>
]]></content>
    </entry>
</feed>