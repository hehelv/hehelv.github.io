<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://hehelv.github.io/</id>
    <title>ğŸ’¤ISpiker</title>
    <updated>2020-03-08T01:42:44.641Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://hehelv.github.io/"/>
    <link rel="self" href="https://hehelv.github.io//atom.xml"/>
    <subtitle>The proof is in the pudding.</subtitle>
    <logo>https://hehelv.github.io//images/avatar.png</logo>
    <icon>https://hehelv.github.io//favicon.ico</icon>
    <rights>All rights reserved 2020, ğŸ’¤ISpiker</rights>
    <entry>
        <title type="html"><![CDATA[15-æ¡†æ¶æ¶æ„]]></title>
        <id>https://hehelv.github.io//post/15-kuang-jia-jia-gou</id>
        <link href="https://hehelv.github.io//post/15-kuang-jia-jia-gou">
        </link>
        <updated>2020-03-03T03:21:34.000Z</updated>
        <content type="html"><![CDATA[<h1 id="15-æ¡†æ¶æ¶æ„">15-æ¡†æ¶æ¶æ„</h1>
<h2 id="scrapyæ¡†æ¶ä»‹ç»">Scrapyæ¡†æ¶ä»‹ç»ï¼š</h2>
<p>å†™ä¸€ä¸ªçˆ¬è™«ï¼Œéœ€è¦åšå¾ˆå¤šçš„äº‹æƒ…ã€‚æ¯”å¦‚ï¼šå‘é€ç½‘ç»œè¯·æ±‚ã€æ•°æ®è§£æã€æ•°æ®å­˜å‚¨ã€ååçˆ¬è™«æœºåˆ¶ï¼ˆæ›´æ¢ipä»£ç†ã€è®¾ç½®è¯·æ±‚å¤´ç­‰ï¼‰ã€å¼‚æ­¥è¯·æ±‚ç­‰ã€‚è¿™äº›å·¥ä½œå¦‚æœæ¯æ¬¡éƒ½è¦è‡ªå·±ä»é›¶å¼€å§‹å†™çš„è¯ï¼Œæ¯”è¾ƒæµªè´¹æ—¶é—´ã€‚å› æ­¤<code>Scrapy</code>æŠŠä¸€äº›åŸºç¡€çš„ä¸œè¥¿å°è£…å¥½äº†ï¼Œåœ¨ä»–ä¸Šé¢å†™çˆ¬è™«å¯ä»¥å˜çš„æ›´åŠ çš„é«˜æ•ˆï¼ˆçˆ¬å–æ•ˆç‡å’Œå¼€å‘æ•ˆç‡ï¼‰ã€‚å› æ­¤çœŸæ­£åœ¨å…¬å¸é‡Œï¼Œä¸€äº›ä¸Šäº†é‡çš„çˆ¬è™«ï¼Œéƒ½æ˜¯ä½¿ç”¨<code>Scrapy</code>æ¡†æ¶æ¥è§£å†³ã€‚</p>
<h2 id="scrapyæ¶æ„å›¾">Scrapyæ¶æ„å›¾ï¼š</h2>
<ol>
<li>æµç¨‹å›¾ï¼ˆ1ï¼‰ï¼š<br>
<img src="../assets/scrapy_all.png" alt="img"></li>
<li>æµç¨‹å›¾ï¼ˆ2ï¼‰ï¼š<br>
<img src="../assets/884863172-5985e0b48edf9.png" alt="img"></li>
</ol>
<h2 id="scrapyæ¡†æ¶æ¨¡å—åŠŸèƒ½">Scrapyæ¡†æ¶æ¨¡å—åŠŸèƒ½ï¼š</h2>
<ol>
<li><code>Scrapy Engineï¼ˆå¼•æ“ï¼‰</code>ï¼š<code>Scrapy</code>æ¡†æ¶çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚è´Ÿè´£åœ¨<code>Spider</code>å’Œ<code>ItemPipeline</code>ã€<code>Downloader</code>ã€<code>Scheduler</code>ä¸­é—´é€šä¿¡ã€ä¼ é€’æ•°æ®ç­‰ã€‚</li>
<li><code>Spiderï¼ˆçˆ¬è™«ï¼‰</code>ï¼šå‘é€éœ€è¦çˆ¬å–çš„é“¾æ¥ç»™å¼•æ“ï¼Œæœ€åå¼•æ“æŠŠå…¶ä»–æ¨¡å—è¯·æ±‚å›æ¥çš„æ•°æ®å†å‘é€ç»™çˆ¬è™«ï¼Œçˆ¬è™«å°±å»è§£ææƒ³è¦çš„æ•°æ®ã€‚è¿™ä¸ªéƒ¨åˆ†æ˜¯æˆ‘ä»¬å¼€å‘è€…è‡ªå·±å†™çš„ï¼Œå› ä¸ºè¦çˆ¬å–å“ªäº›é“¾æ¥ï¼Œé¡µé¢ä¸­çš„å“ªäº›æ•°æ®æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œéƒ½æ˜¯ç”±ç¨‹åºå‘˜è‡ªå·±å†³å®šã€‚</li>
<li><code>Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰</code>ï¼šè´Ÿè´£æ¥æ”¶å¼•æ“å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¹¶æŒ‰ç…§ä¸€å®šçš„æ–¹å¼è¿›è¡Œæ’åˆ—å’Œæ•´ç†ï¼Œè´Ÿè´£è°ƒåº¦è¯·æ±‚çš„é¡ºåºç­‰ã€‚</li>
<li><code>Downloaderï¼ˆä¸‹è½½å™¨ï¼‰</code>ï¼šè´Ÿè´£æ¥æ”¶å¼•æ“ä¼ è¿‡æ¥çš„ä¸‹è½½è¯·æ±‚ï¼Œç„¶åå»ç½‘ç»œä¸Šä¸‹è½½å¯¹åº”çš„æ•°æ®å†äº¤è¿˜ç»™å¼•æ“ã€‚</li>
<li><code>Item Pipelineï¼ˆç®¡é“ï¼‰</code>ï¼šè´Ÿè´£å°†<code>Spiderï¼ˆçˆ¬è™«ï¼‰</code>ä¼ é€’è¿‡æ¥çš„æ•°æ®è¿›è¡Œä¿å­˜ã€‚å…·ä½“ä¿å­˜åœ¨å“ªé‡Œï¼Œåº”è¯¥çœ‹å¼€å‘è€…è‡ªå·±çš„éœ€æ±‚ã€‚</li>
<li><code>Downloader Middlewaresï¼ˆä¸‹è½½ä¸­é—´ä»¶ï¼‰</code>ï¼šå¯ä»¥æ‰©å±•ä¸‹è½½å™¨å’Œå¼•æ“ä¹‹é—´é€šä¿¡åŠŸèƒ½çš„ä¸­é—´ä»¶ã€‚</li>
<li><code>Spider Middlewaresï¼ˆSpiderä¸­é—´ä»¶ï¼‰</code>ï¼šå¯ä»¥æ‰©å±•å¼•æ“å’Œçˆ¬è™«ä¹‹é—´é€šä¿¡åŠŸèƒ½çš„ä¸­é—´ä»¶ã€‚</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[14-å›¾å½¢éªŒè¯ç è¯†åˆ«]]></title>
        <id>https://hehelv.github.io//post/13-tu-xing-yan-zheng-ma-shi-bie</id>
        <link href="https://hehelv.github.io//post/13-tu-xing-yan-zheng-ma-shi-bie">
        </link>
        <updated>2020-03-03T03:14:34.000Z</updated>
        <content type="html"><![CDATA[<h1 id="14-å›¾å½¢éªŒè¯ç è¯†åˆ«">14-å›¾å½¢éªŒè¯ç è¯†åˆ«</h1>
<p>é˜»ç¢æˆ‘ä»¬çˆ¬è™«çš„ã€‚æœ‰æ—¶å€™æ­£æ˜¯åœ¨ç™»å½•æˆ–è€…è¯·æ±‚ä¸€äº›æ•°æ®æ—¶å€™çš„å›¾å½¢éªŒè¯ç ã€‚å› æ­¤è¿™é‡Œæˆ‘ä»¬è®²è§£ä¸€ç§èƒ½å°†å›¾ç‰‡ç¿»è¯‘æˆæ–‡å­—çš„æŠ€æœ¯ã€‚å°†å›¾ç‰‡ç¿»è¯‘æˆæ–‡å­—ä¸€èˆ¬è¢«æˆä¸ºå…‰å­¦æ–‡å­—è¯†åˆ«ï¼ˆOptical Character Recognitionï¼‰ï¼Œç®€å†™ä¸º<code>OCR</code>ã€‚å®ç°<code>OCR</code>çš„åº“ä¸æ˜¯å¾ˆå¤šï¼Œç‰¹åˆ«æ˜¯å¼€æºçš„ã€‚å› ä¸ºè¿™å—å­˜åœ¨ä¸€å®šçš„æŠ€æœ¯å£å’ï¼ˆéœ€è¦å¤§é‡çš„æ•°æ®ã€ç®—æ³•ã€æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ çŸ¥è¯†ç­‰ï¼‰ï¼Œå¹¶ä¸”å¦‚æœåšå¥½äº†å…·æœ‰å¾ˆé«˜çš„å•†ä¸šä»·å€¼ã€‚å› æ­¤å¼€æºçš„æ¯”è¾ƒå°‘ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸ªæ¯”è¾ƒä¼˜ç§€çš„å›¾åƒè¯†åˆ«å¼€æºåº“ï¼šTesseractã€‚</p>
<h2 id="tesseract">Tesseractï¼š</h2>
<p>Tesseractæ˜¯ä¸€ä¸ªOCRåº“ï¼Œç›®å‰ç”±è°·æ­ŒèµåŠ©ã€‚Tesseractæ˜¯ç›®å‰å…¬è®¤æœ€ä¼˜ç§€ã€æœ€å‡†ç¡®çš„å¼€æºOCRåº“ã€‚Tesseractå…·æœ‰å¾ˆé«˜çš„è¯†åˆ«åº¦ï¼Œä¹Ÿå…·æœ‰å¾ˆé«˜çš„çµæ´»æ€§ï¼Œä»–å¯ä»¥é€šè¿‡è®­ç»ƒè¯†åˆ«ä»»ä½•å­—ä½“ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…ï¼š</h3>
<h4 id="windowsç³»ç»Ÿ">Windowsç³»ç»Ÿï¼š</h4>
<p>åœ¨ä»¥ä¸‹é“¾æ¥ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åä¸€é¡¿ç‚¹å‡»ä¸‹ä¸€æ­¥å®‰è£…å³å¯ï¼ˆæ”¾åœ¨ä¸éœ€è¦æƒé™çš„çº¯è‹±æ–‡è·¯å¾„ä¸‹ï¼‰ï¼š<br>
https://github.com/tesseract-ocr/</p>
<h4 id="linuxç³»ç»Ÿ">Linuxç³»ç»Ÿï¼š</h4>
<p>å¯ä»¥åœ¨ä»¥ä¸‹é“¾æ¥ä¸‹è½½æºç è‡ªè¡Œç¼–è¯‘ã€‚<br>
https://github.com/tesseract-ocr/tesseract/wiki/Compiling<br>
æˆ–è€…åœ¨<code>ubuntu</code>ä¸‹é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p>
<pre><code class="language-shell">sudo apt install tesseract-ocr
</code></pre>
<h4 id="macç³»ç»Ÿ">Macç³»ç»Ÿï¼š</h4>
<p>ç”¨<code>Homebrew</code>å³å¯æ–¹ä¾¿å®‰è£…ï¼š</p>
<pre><code class="language-shell">brew install tesseract
</code></pre>
<h4 id="è®¾ç½®ç¯å¢ƒå˜é‡">è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</h4>
<p>å®‰è£…å®Œæˆåï¼Œå¦‚æœæƒ³è¦åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨<code>Tesseract</code>ï¼Œé‚£ä¹ˆåº”è¯¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚<code>Mac</code>å’Œ<code>Linux</code>åœ¨å®‰è£…çš„æ—¶å€™å°±é»˜è®¤å·²ç»è®¾ç½®å¥½äº†ã€‚åœ¨<code>Windows</code>ä¸‹æŠŠ<code>tesseract.exe</code>æ‰€åœ¨çš„è·¯å¾„æ·»åŠ åˆ°<code>PATH</code>ç¯å¢ƒå˜é‡ä¸­ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªç¯å¢ƒå˜é‡éœ€è¦è®¾ç½®çš„æ˜¯ï¼Œè¦æŠŠè®­ç»ƒçš„æ•°æ®æ–‡ä»¶è·¯å¾„ä¹Ÿæ”¾åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚<br>
åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª<code>TESSDATA_PREFIX=C:\path_to_tesseractdata\teseractdata</code>ã€‚</p>
<h3 id="åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨tesseractè¯†åˆ«å›¾åƒ">åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨tesseractè¯†åˆ«å›¾åƒï¼š</h3>
<p>å¦‚æœæƒ³è¦åœ¨<code>cmd</code>ä¸‹èƒ½å¤Ÿä½¿ç”¨<code>tesseract</code>å‘½ä»¤ï¼Œé‚£ä¹ˆéœ€è¦æŠŠ<code>tesseract.exe</code>æ‰€åœ¨çš„ç›®å½•æ”¾åˆ°<code>PATH</code>ç¯å¢ƒå˜é‡ä¸­ã€‚ç„¶åä½¿ç”¨å‘½ä»¤ï¼š<code>tesseract å›¾ç‰‡è·¯å¾„ æ–‡ä»¶è·¯å¾„</code>ã€‚<br>
ç¤ºä¾‹ï¼š</p>
<pre><code class="language-shell">tesseract a.png a
</code></pre>
<p>é‚£ä¹ˆå°±ä¼šè¯†åˆ«å‡º<code>a.png</code>ä¸­çš„å›¾ç‰‡ï¼Œå¹¶ä¸”æŠŠæ–‡å­—å†™å…¥åˆ°<code>a.txt</code>ä¸­ã€‚å¦‚æœä¸æƒ³å†™å…¥æ–‡ä»¶ç›´æ¥æƒ³æ˜¾ç¤ºåœ¨ç»ˆç«¯ï¼Œé‚£ä¹ˆä¸è¦åŠ æ–‡ä»¶åå°±å¯ä»¥äº†ã€‚</p>
<h3 id="åœ¨ä»£ç ä¸­ä½¿ç”¨tesseractè¯†åˆ«å›¾åƒ">åœ¨ä»£ç ä¸­ä½¿ç”¨tesseractè¯†åˆ«å›¾åƒï¼š</h3>
<p>åœ¨<code>Python</code>ä»£ç ä¸­æ“ä½œ<code>tesseract</code>ã€‚éœ€è¦å®‰è£…ä¸€ä¸ªåº“ï¼Œå«åš<code>pytesseract</code>ã€‚é€šè¿‡<code>pip</code>çš„æ–¹å¼å³å¯å®‰è£…ï¼š</p>
<pre><code>pip install pytesseract
</code></pre>
<p>å¹¶ä¸”ï¼Œéœ€è¦è¯»å–å›¾ç‰‡ï¼Œéœ€è¦å€ŸåŠ©ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“å«åš<code>PIL</code>ã€‚é€šè¿‡<code>pip list</code>çœ‹ä¸‹æ˜¯å¦å®‰è£…ã€‚å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œé€šè¿‡<code>pip</code>çš„æ–¹å¼å®‰è£…ï¼š</p>
<pre><code>pip install PIL
</code></pre>
<p>ä½¿ç”¨<code>pytesseract</code>å°†å›¾ç‰‡ä¸Šçš„æ–‡å­—è½¬æ¢ä¸ºæ–‡æœ¬æ–‡å­—çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"># å¯¼å…¥pytesseractåº“
import pytesseract
# å¯¼å…¥Imageåº“
from PIL import Image

# æŒ‡å®štesseract.exeæ‰€åœ¨çš„è·¯å¾„
pytesseract.pytesseract.tesseract_cmd = r'D:\ProgramApp\TesseractOCR\tesseract.exe'

# æ‰“å¼€å›¾ç‰‡
image = Image.open(&quot;a.png&quot;)
# è°ƒç”¨image_to_stringå°†å›¾ç‰‡è½¬æ¢ä¸ºæ–‡å­—
text = pytesseract.image_to_string(image)
print(text)
</code></pre>
<h2 id="ç”¨pytesseractå¤„ç†æ‹‰å‹¾ç½‘å›¾å½¢éªŒè¯ç ">ç”¨<code>pytesseract</code>å¤„ç†æ‹‰å‹¾ç½‘å›¾å½¢éªŒè¯ç ï¼š</h2>
<pre><code class="language-python">import pytesseract
from urllib import request
from PIL import Image
import time


pytesseract.pytesseract.tesseract_cmd = r&quot;D:\ProgramApp\TesseractOCR\tesseract.exe&quot;


while True:
    captchaUrl = &quot;https://passport.lagou.com/vcode/create?from=register&amp;refresh=1513081451891&quot;
    request.urlretrieve(captchaUrl,'captcha.png')
    image = Image.open('captcha.png')
    text = pytesseract.image_to_string(image,lang='eng')
    print(text)
    time.sleep(2)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[13-åŠ¨æ€ç½‘é¡µçˆ¬è™«]]></title>
        <id>https://hehelv.github.io//post/13-dong-tai-wang-ye-pa-chong</id>
        <link href="https://hehelv.github.io//post/13-dong-tai-wang-ye-pa-chong">
        </link>
        <updated>2020-03-03T03:14:06.000Z</updated>
        <content type="html"><![CDATA[<h1 id="13-åŠ¨æ€ç½‘é¡µçˆ¬è™«">13-åŠ¨æ€ç½‘é¡µçˆ¬è™«</h1>
<h2 id="ä»€ä¹ˆæ˜¯ajax">ä»€ä¹ˆæ˜¯AJAXï¼š</h2>
<p>AJAXï¼ˆAsynchronouse JavaScript And XMLï¼‰å¼‚æ­¥JavaScriptå’ŒXMLã€‚è¿‡åœ¨åå°ä¸æœåŠ¡å™¨è¿›è¡Œå°‘é‡æ•°æ®äº¤æ¢ï¼ŒAjax å¯ä»¥ä½¿ç½‘é¡µå®ç°å¼‚æ­¥æ›´æ–°ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚ä¼ ç»Ÿçš„ç½‘é¡µï¼ˆä¸ä½¿ç”¨Ajaxï¼‰å¦‚æœéœ€è¦æ›´æ–°å†…å®¹ï¼Œå¿…é¡»é‡è½½æ•´ä¸ªç½‘é¡µé¡µé¢ã€‚å› ä¸ºä¼ ç»Ÿçš„åœ¨ä¼ è¾“æ•°æ®æ ¼å¼æ–¹é¢ï¼Œä½¿ç”¨çš„æ˜¯<code>XML</code>è¯­æ³•ã€‚å› æ­¤å«åš<code>AJAX</code>ï¼Œå…¶å®ç°åœ¨æ•°æ®äº¤äº’åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨<code>JSON</code>ã€‚ä½¿ç”¨AJAXåŠ è½½çš„æ•°æ®ï¼Œå³ä½¿ä½¿ç”¨äº†JSï¼Œå°†æ•°æ®æ¸²æŸ“åˆ°äº†æµè§ˆå™¨ä¸­ï¼Œåœ¨<code>å³é”®-&gt;æŸ¥çœ‹ç½‘é¡µæºä»£ç </code>è¿˜æ˜¯ä¸èƒ½çœ‹åˆ°é€šè¿‡ajaxåŠ è½½çš„æ•°æ®ï¼Œåªèƒ½çœ‹åˆ°ä½¿ç”¨è¿™ä¸ªurlåŠ è½½çš„htmlä»£ç ã€‚</p>
<h2 id="è·å–ajaxæ•°æ®çš„æ–¹å¼">è·å–ajaxæ•°æ®çš„æ–¹å¼ï¼š</h2>
<ol>
<li>ç›´æ¥åˆ†æajaxè°ƒç”¨çš„æ¥å£ã€‚ç„¶åé€šè¿‡ä»£ç è¯·æ±‚è¿™ä¸ªæ¥å£ã€‚</li>
<li>ä½¿ç”¨Selenium+chromedriveræ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºè·å–æ•°æ®ã€‚</li>
</ol>
<table>
<thead>
<tr>
<th>æ–¹å¼</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆ†ææ¥å£</td>
<td>ç›´æ¥å¯ä»¥è¯·æ±‚åˆ°æ•°æ®ã€‚ä¸éœ€è¦åšä¸€äº›è§£æå·¥ä½œã€‚ä»£ç é‡å°‘ï¼Œæ€§èƒ½é«˜ã€‚</td>
<td>åˆ†ææ¥å£æ¯”è¾ƒå¤æ‚ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›é€šè¿‡jsæ··æ·†çš„æ¥å£ï¼Œè¦æœ‰ä¸€å®šçš„jsåŠŸåº•ã€‚å®¹æ˜“è¢«å‘ç°æ˜¯çˆ¬è™«ã€‚</td>
</tr>
<tr>
<td>selenium</td>
<td>ç›´æ¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºã€‚æµè§ˆå™¨èƒ½è¯·æ±‚åˆ°çš„ï¼Œä½¿ç”¨seleniumä¹Ÿèƒ½è¯·æ±‚åˆ°ã€‚çˆ¬è™«æ›´ç¨³å®šã€‚</td>
<td>ä»£ç é‡å¤šã€‚æ€§èƒ½ä½ã€‚</td>
</tr>
</tbody>
</table>
<h2 id="seleniumchromedriverè·å–åŠ¨æ€æ•°æ®">Selenium+chromedriverè·å–åŠ¨æ€æ•°æ®ï¼š</h2>
<p><code>Selenium</code>ç›¸å½“äºæ˜¯ä¸€ä¸ªæœºå™¨äººã€‚å¯ä»¥æ¨¡æ‹Ÿäººç±»åœ¨æµè§ˆå™¨ä¸Šçš„ä¸€äº›è¡Œä¸ºï¼Œè‡ªåŠ¨å¤„ç†æµè§ˆå™¨ä¸Šçš„ä¸€äº›è¡Œä¸ºï¼Œæ¯”å¦‚ç‚¹å‡»ï¼Œå¡«å……æ•°æ®ï¼Œåˆ é™¤cookieç­‰ã€‚<code>chromedriver</code>æ˜¯ä¸€ä¸ªé©±åŠ¨<code>Chrome</code>æµè§ˆå™¨çš„é©±åŠ¨ç¨‹åºï¼Œä½¿ç”¨ä»–æ‰å¯ä»¥é©±åŠ¨æµè§ˆå™¨ã€‚å½“ç„¶é’ˆå¯¹ä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„driverã€‚ä»¥ä¸‹åˆ—å‡ºäº†ä¸åŒæµè§ˆå™¨åŠå…¶å¯¹åº”çš„driverï¼š</p>
<ol>
<li>Chromeï¼šhttps://sites.google.com/a/chromium.org/chromedriver/downloads</li>
<li>Firefoxï¼šhttps://github.com/mozilla/geckodriver/releases</li>
<li>Edgeï¼šhttps://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/</li>
<li>Safariï¼šhttps://webkit.org/blog/6900/webdriver-support-in-safari-10/</li>
</ol>
<h2 id="å®‰è£…seleniumå’Œchromedriver">å®‰è£…Seleniumå’Œchromedriverï¼š</h2>
<ol>
<li>
<p>å®‰è£…</p>
<pre><code>Selenium
</code></pre>
<p>ï¼š</p>
<pre><code>Selenium
</code></pre>
<p>æœ‰å¾ˆå¤šè¯­è¨€çš„ç‰ˆæœ¬ï¼Œæœ‰javaã€rubyã€pythonç­‰ã€‚æˆ‘ä»¬ä¸‹è½½pythonç‰ˆæœ¬çš„å°±å¯ä»¥äº†ã€‚</p>
<pre><code class="language-shell"> pip install selenium
</code></pre>
</li>
<li>
<p>å®‰è£…<code>chromedriver</code>ï¼šä¸‹è½½å®Œæˆåï¼Œæ”¾åˆ°ä¸éœ€è¦æƒé™çš„çº¯è‹±æ–‡ç›®å½•ä¸‹å°±å¯ä»¥äº†ã€‚</p>
</li>
</ol>
<h3 id="å¿«é€Ÿå…¥é—¨">å¿«é€Ÿå…¥é—¨ï¼š</h3>
<p>ç°åœ¨ä»¥ä¸€ä¸ªç®€å•çš„è·å–ç™¾åº¦é¦–é¡µçš„ä¾‹å­æ¥è®²ä¸‹<code>Selenium</code>å’Œ<code>chromedriver</code>å¦‚ä½•å¿«é€Ÿå…¥é—¨ï¼š</p>
<pre><code class="language-python">from selenium import webdriver

# chromedriverçš„ç»å¯¹è·¯å¾„
driver_path = r'D:\ProgramApp\chromedriver\chromedriver.exe'

# åˆå§‹åŒ–ä¸€ä¸ªdriverï¼Œå¹¶ä¸”æŒ‡å®šchromedriverçš„è·¯å¾„
driver = webdriver.Chrome(executable_path=driver_path)
# è¯·æ±‚ç½‘é¡µ
driver.get(&quot;https://www.baidu.com/&quot;)
# é€šè¿‡page_sourceè·å–ç½‘é¡µæºä»£ç 
print(driver.page_source)
</code></pre>
<h3 id="seleniumå¸¸ç”¨æ“ä½œ">seleniumå¸¸ç”¨æ“ä½œï¼š</h3>
<p>æ›´å¤šæ•™ç¨‹è¯·å‚è€ƒï¼šhttp://selenium-python.readthedocs.io/installation.html#introduction</p>
<h4 id="å…³é—­é¡µé¢">å…³é—­é¡µé¢ï¼š</h4>
<ol>
<li><code>driver.close()</code>ï¼šå…³é—­å½“å‰é¡µé¢ã€‚</li>
<li><code>driver.quit()</code>ï¼šé€€å‡ºæ•´ä¸ªæµè§ˆå™¨ã€‚</li>
</ol>
<h4 id="å®šä½å…ƒç´ ">å®šä½å…ƒç´ ï¼š</h4>
<ol>
<li>
<pre><code>find_element_by_id
</code></pre>
<p>ï¼šæ ¹æ®idæ¥æŸ¥æ‰¾æŸä¸ªå…ƒç´ ã€‚ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_id('su')
 submitTag1 = driver.find_element(By.ID,'su')
</code></pre>
</li>
<li>
<pre><code>find_element_by_class_name
</code></pre>
<p>ï¼šæ ¹æ®ç±»åæŸ¥æ‰¾å…ƒç´ ã€‚ ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_class_name('su')
 submitTag1 = driver.find_element(By.CLASS_NAME,'su')
</code></pre>
</li>
<li>
<pre><code>find_element_by_name
</code></pre>
<p>ï¼šæ ¹æ®nameå±æ€§çš„å€¼æ¥æŸ¥æ‰¾å…ƒç´ ã€‚ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_name('email')
 submitTag1 = driver.find_element(By.NAME,'email')
</code></pre>
</li>
<li>
<pre><code>find_element_by_tag_name
</code></pre>
<p>ï¼šæ ¹æ®æ ‡ç­¾åæ¥æŸ¥æ‰¾å…ƒç´ ã€‚ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_tag_name('div')
 submitTag1 = driver.find_element(By.TAG_NAME,'div')
</code></pre>
</li>
<li>
<pre><code>find_element_by_xpath
</code></pre>
<p>ï¼šæ ¹æ®xpathè¯­æ³•æ¥è·å–å…ƒç´ ã€‚ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_xpath('//div')
 submitTag1 = driver.find_element(By.XPATH,'//div')
</code></pre>
</li>
<li>
<p><code>find_element_by_css_selector</code>ï¼šæ ¹æ®cssé€‰æ‹©å™¨é€‰æ‹©å…ƒç´ ã€‚ç­‰ä»·äºï¼š</p>
<pre><code class="language-python"> submitTag = driver.find_element_by_css_selector('//div')
 submitTag1 = driver.find_element(By.CSS_SELECTOR,'//div')
</code></pre>
<p>è¦æ³¨æ„ï¼Œ<code>find_element</code>æ˜¯è·å–ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚<code>find_elements</code>æ˜¯è·å–æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚</p>
</li>
</ol>
<h4 id="æ“ä½œè¡¨å•å…ƒç´ ">æ“ä½œè¡¨å•å…ƒç´ ï¼š</h4>
<ol>
<li>
<p>æ“ä½œè¾“å…¥æ¡†ï¼šåˆ†ä¸ºä¸¤æ­¥ã€‚ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°è¿™ä¸ªå…ƒç´ ã€‚ç¬¬äºŒæ­¥ï¼šä½¿ç”¨<code>send_keys(value)</code>ï¼Œå°†æ•°æ®å¡«å……è¿›å»ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> inputTag = driver.find_element_by_id('kw')
 inputTag.send_keys('python')
</code></pre>
<p>ä½¿ç”¨<code>clear</code>æ–¹æ³•å¯ä»¥æ¸…é™¤è¾“å…¥æ¡†ä¸­çš„å†…å®¹ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> inputTag.clear()
</code></pre>
</li>
<li>
<p>æ“ä½œcheckboxï¼šå› ä¸ºè¦é€‰ä¸­<code>checkbox</code>æ ‡ç­¾ï¼Œåœ¨ç½‘é¡µä¸­æ˜¯é€šè¿‡é¼ æ ‡ç‚¹å‡»çš„ã€‚å› æ­¤æƒ³è¦é€‰ä¸­<code>checkbox</code>æ ‡ç­¾ï¼Œé‚£ä¹ˆå…ˆé€‰ä¸­è¿™ä¸ªæ ‡ç­¾ï¼Œç„¶åæ‰§è¡Œ<code>click</code>äº‹ä»¶ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> rememberTag = driver.find_element_by_name(&quot;rememberMe&quot;)
 rememberTag.click()
</code></pre>
</li>
<li>
<p>é€‰æ‹©selectï¼šselectå…ƒç´ ä¸èƒ½ç›´æ¥ç‚¹å‡»ã€‚å› ä¸ºç‚¹å‡»åè¿˜éœ€è¦é€‰ä¸­å…ƒç´ ã€‚è¿™æ—¶å€™seleniumå°±ä¸“é—¨ä¸ºselectæ ‡ç­¾æä¾›äº†ä¸€ä¸ªç±»<code>selenium.webdriver.support.ui.Select</code>ã€‚å°†è·å–åˆ°çš„å…ƒç´ å½“æˆå‚æ•°ä¼ åˆ°è¿™ä¸ªç±»ä¸­ï¼Œåˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚ä»¥åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡è¿›è¡Œé€‰æ‹©äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> from selenium.webdriver.support.ui import Select
 # é€‰ä¸­è¿™ä¸ªæ ‡ç­¾ï¼Œç„¶åä½¿ç”¨Selectåˆ›å»ºå¯¹è±¡
 selectTag = Select(driver.find_element_by_name(&quot;jumpMenu&quot;))
 # æ ¹æ®ç´¢å¼•é€‰æ‹©
 selectTag.select_by_index(1)
 # æ ¹æ®å€¼é€‰æ‹©
 selectTag.select_by_value(&quot;http://www.95yueba.com&quot;)
 # æ ¹æ®å¯è§†çš„æ–‡æœ¬é€‰æ‹©
 selectTag.select_by_visible_text(&quot;95ç§€å®¢æˆ·ç«¯&quot;)
 # å–æ¶ˆé€‰ä¸­æ‰€æœ‰é€‰é¡¹
 selectTag.deselect_all()
</code></pre>
</li>
<li>
<p>æ“ä½œæŒ‰é’®ï¼šæ“ä½œæŒ‰é’®æœ‰å¾ˆå¤šç§æ–¹å¼ã€‚æ¯”å¦‚å•å‡»ã€å³å‡»ã€åŒå‡»ç­‰ã€‚è¿™é‡Œè®²ä¸€ä¸ªæœ€å¸¸ç”¨çš„ã€‚å°±æ˜¯ç‚¹å‡»ã€‚ç›´æ¥è°ƒç”¨<code>click</code>å‡½æ•°å°±å¯ä»¥äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> inputTag = driver.find_element_by_id('su')
 inputTag.click()
</code></pre>
</li>
</ol>
<h4 id="è¡Œä¸ºé“¾">è¡Œä¸ºé“¾ï¼š</h4>
<p>æœ‰æ—¶å€™åœ¨é¡µé¢ä¸­çš„æ“ä½œå¯èƒ½è¦æœ‰å¾ˆå¤šæ­¥ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨é¼ æ ‡è¡Œä¸ºé“¾ç±»<code>ActionChains</code>æ¥å®Œæˆã€‚æ¯”å¦‚ç°åœ¨è¦å°†é¼ æ ‡ç§»åŠ¨åˆ°æŸä¸ªå…ƒç´ ä¸Šå¹¶æ‰§è¡Œç‚¹å‡»äº‹ä»¶ã€‚é‚£ä¹ˆç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">inputTag = driver.find_element_by_id('kw')
submitTag = driver.find_element_by_id('su')

actions = ActionChains(driver)
actions.move_to_element(inputTag)
actions.send_keys_to_element(inputTag,'python')
actions.move_to_element(submitTag)
actions.click(submitTag)
actions.perform()
</code></pre>
<p>è¿˜æœ‰æ›´å¤šçš„é¼ æ ‡ç›¸å…³çš„æ“ä½œã€‚</p>
<ul>
<li>click_and_hold(element)ï¼šç‚¹å‡»ä½†ä¸æ¾å¼€é¼ æ ‡ã€‚</li>
<li>context_click(element)ï¼šå³é”®ç‚¹å‡»ã€‚</li>
<li>double_click(element)ï¼šåŒå‡»ã€‚ æ›´å¤šæ–¹æ³•è¯·å‚è€ƒï¼šhttp://selenium-python.readthedocs.io/api.html</li>
</ul>
<h4 id="cookieæ“ä½œ">Cookieæ“ä½œï¼š</h4>
<ol>
<li>
<p>è·å–æ‰€æœ‰çš„</p>
<pre><code>cookie
</code></pre>
<p>ï¼š</p>
<pre><code class="language-python"> for cookie in driver.get_cookies():
     print(cookie)
</code></pre>
</li>
<li>
<p>æ ¹æ®cookieçš„keyè·å–valueï¼š</p>
<pre><code class="language-python"> value = driver.get_cookie(key)
</code></pre>
</li>
<li>
<p>åˆ é™¤æ‰€æœ‰çš„cookieï¼š</p>
<pre><code class="language-python"> driver.delete_all_cookies()
</code></pre>
</li>
<li>
<p>åˆ é™¤æŸä¸ª</p>
<pre><code>cookie
</code></pre>
<p>ï¼š</p>
<pre><code class="language-python"> driver.delete_cookie(key)
</code></pre>
</li>
</ol>
<h4 id="é¡µé¢ç­‰å¾…">é¡µé¢ç­‰å¾…ï¼š</h4>
<p>ç°åœ¨çš„ç½‘é¡µè¶Šæ¥è¶Šå¤šé‡‡ç”¨äº† Ajax æŠ€æœ¯ï¼Œè¿™æ ·ç¨‹åºä¾¿ä¸èƒ½ç¡®å®šä½•æ—¶æŸä¸ªå…ƒç´ å®Œå…¨åŠ è½½å‡ºæ¥äº†ã€‚å¦‚æœå®é™…é¡µé¢ç­‰å¾…æ—¶é—´è¿‡é•¿å¯¼è‡´æŸä¸ªdomå…ƒç´ è¿˜æ²¡å‡ºæ¥ï¼Œä½†æ˜¯ä½ çš„ä»£ç ç›´æ¥ä½¿ç”¨äº†è¿™ä¸ªWebElementï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºNullPointerçš„å¼‚å¸¸ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥ Selenium æä¾›äº†ä¸¤ç§ç­‰å¾…æ–¹å¼ï¼šä¸€ç§æ˜¯éšå¼ç­‰å¾…ã€ä¸€ç§æ˜¯æ˜¾å¼ç­‰å¾…ã€‚</p>
<ol>
<li>
<p>éšå¼ç­‰å¾…ï¼šè°ƒç”¨<code>driver.implicitly_wait</code>ã€‚é‚£ä¹ˆåœ¨è·å–ä¸å¯ç”¨çš„å…ƒç´ ä¹‹å‰ï¼Œä¼šå…ˆç­‰å¾…10ç§’ä¸­çš„æ—¶é—´ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">driver = webdriver.Chrome(executable_path=driver_path)
driver.implicitly_wait(10)
# è¯·æ±‚ç½‘é¡µ
driver.get(&quot;https://www.douban.com/&quot;)
</code></pre>
</li>
<li>
<p>æ˜¾ç¤ºç­‰å¾…ï¼šæ˜¾ç¤ºç­‰å¾…æ˜¯è¡¨æ˜æŸä¸ªæ¡ä»¶æˆç«‹åæ‰æ‰§è¡Œè·å–å…ƒç´ çš„æ“ä½œã€‚ä¹Ÿå¯ä»¥åœ¨ç­‰å¾…çš„æ—¶å€™æŒ‡å®šä¸€ä¸ªæœ€å¤§çš„æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´é‚£ä¹ˆå°±æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚æ˜¾ç¤ºç­‰å¾…åº”è¯¥ä½¿ç”¨<code>selenium.webdriver.support.excepted_conditions</code>æœŸæœ›çš„æ¡ä»¶å’Œ<code>selenium.webdriver.support.ui.WebDriverWait</code>æ¥é…åˆå®Œæˆã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> from selenium import webdriver
 from selenium.webdriver.common.by import By
 from selenium.webdriver.support.ui import WebDriverWait
 from selenium.webdriver.support import expected_conditions as EC

 driver = webdriver.Firefox()
 driver.get(&quot;http://somedomain/url_that_delays_loading&quot;)
 try:
     element = WebDriverWait(driver, 10).until(
         EC.presence_of_element_located((By.ID, &quot;myDynamicElement&quot;))
     )
 finally:
     driver.quit()
</code></pre>
</li>
<li>
<p>ä¸€äº›å…¶ä»–çš„ç­‰å¾…æ¡ä»¶ï¼š</p>
<ul>
<li>
<p>presence_of_element_locatedï¼šæŸä¸ªå…ƒç´ å·²ç»åŠ è½½å®Œæ¯•äº†ã€‚</p>
</li>
<li>
<p>presence_of_all_emement_locatedï¼šç½‘é¡µä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ éƒ½åŠ è½½å®Œæ¯•äº†ã€‚</p>
</li>
<li>
<p>element_to_be_cliableï¼šæŸä¸ªå…ƒç´ æ˜¯å¯ä»¥ç‚¹å‡»äº†ã€‚</p>
<p>æ›´å¤šæ¡ä»¶è¯·å‚è€ƒï¼šhttp://selenium-python.readthedocs.io/waits.html</p>
</li>
</ul>
</li>
</ol>
<h4 id="åˆ‡æ¢é¡µé¢">åˆ‡æ¢é¡µé¢ï¼š</h4>
<p>æœ‰æ—¶å€™çª—å£ä¸­æœ‰å¾ˆå¤šå­tabé¡µé¢ã€‚è¿™æ—¶å€™è‚¯å®šæ˜¯éœ€è¦è¿›è¡Œåˆ‡æ¢çš„ã€‚<code>selenium</code>æä¾›äº†ä¸€ä¸ªå«åš<code>switch_to_window</code>æ¥è¿›è¡Œåˆ‡æ¢ï¼Œå…·ä½“åˆ‡æ¢åˆ°å“ªä¸ªé¡µé¢ï¼Œå¯ä»¥ä»<code>driver.window_handles</code>ä¸­æ‰¾åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"># æ‰“å¼€ä¸€ä¸ªæ–°çš„é¡µé¢
self.driver.execute_script(&quot;window.open('&quot;+url+&quot;')&quot;)
# åˆ‡æ¢åˆ°è¿™ä¸ªæ–°çš„é¡µé¢ä¸­
self.driver.switch_to_window(self.driver.window_handles[1])
</code></pre>
<h4 id="è®¾ç½®ä»£ç†ip">è®¾ç½®ä»£ç†ipï¼š</h4>
<p>æœ‰æ—¶å€™é¢‘ç¹çˆ¬å–ä¸€äº›ç½‘é¡µã€‚æœåŠ¡å™¨å‘ç°ä½ æ˜¯çˆ¬è™«åä¼šå°æ‰ä½ çš„ipåœ°å€ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æ›´æ”¹ä»£ç†ipã€‚æ›´æ”¹ä»£ç†ipï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚è¿™é‡Œä»¥<code>Chrome</code>æµè§ˆå™¨ä¸ºä¾‹æ¥è®²è§£ï¼š</p>
<pre><code class="language-python">from selenium import webdriver

options = webdriver.ChromeOptions()
options.add_argument(&quot;--proxy-server=http://110.73.2.248:8123&quot;)
driver_path = r&quot;D:\ProgramApp\chromedriver\chromedriver.exe&quot;
driver = webdriver.Chrome(executable_path=driver_path,chrome_options=options)

driver.get('http://httpbin.org/ip')
</code></pre>
<h4 id="webelementå…ƒç´ "><code>WebElement</code>å…ƒç´ ï¼š</h4>
<p><code>from selenium.webdriver.remote.webelement import WebElement</code>ç±»æ˜¯æ¯ä¸ªè·å–å‡ºæ¥çš„å…ƒç´ çš„æ‰€å±ç±»ã€‚<br>
æœ‰ä¸€äº›å¸¸ç”¨çš„å±æ€§ï¼š</p>
<ol>
<li>get_attributeï¼šè¿™ä¸ªæ ‡ç­¾çš„æŸä¸ªå±æ€§çš„å€¼ã€‚</li>
<li>screentshotï¼šè·å–å½“å‰é¡µé¢çš„æˆªå›¾ã€‚è¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨<code>driver</code>ä¸Šä½¿ç”¨ã€‚<br>
<code>driver</code>çš„å¯¹è±¡ç±»ï¼Œä¹Ÿæ˜¯ç»§æ‰¿è‡ª<code>WebElement</code>ã€‚<br>
æ›´å¤šè¯·é˜…è¯»ç›¸å…³æºä»£ç ã€‚</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[12-å¤šçº¿ç¨‹çˆ¬è™«]]></title>
        <id>https://hehelv.github.io//post/1-duo-xian-cheng-pa-chong</id>
        <link href="https://hehelv.github.io//post/1-duo-xian-cheng-pa-chong">
        </link>
        <updated>2020-03-03T03:13:26.000Z</updated>
        <content type="html"><![CDATA[<h1 id="12-å¤šçº¿ç¨‹çˆ¬è™«">12-å¤šçº¿ç¨‹çˆ¬è™«</h1>
<p>æœ‰äº›æ—¶å€™ï¼Œæ¯”å¦‚ä¸‹è½½å›¾ç‰‡ï¼Œå› ä¸ºä¸‹è½½å›¾ç‰‡æ˜¯ä¸€ä¸ªè€—æ—¶çš„æ“ä½œã€‚å¦‚æœé‡‡ç”¨ä¹‹å‰é‚£ç§åŒæ­¥çš„æ–¹å¼ä¸‹è½½ã€‚é‚£æ•ˆç‡è‚¯ä¼šç‰¹åˆ«æ…¢ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼æ¥ä¸‹è½½å›¾ç‰‡ã€‚</p>
<h2 id="å¤šçº¿ç¨‹ä»‹ç»">å¤šçº¿ç¨‹ä»‹ç»ï¼š</h2>
<p>å¤šçº¿ç¨‹æ˜¯ä¸ºäº†åŒæ­¥å®Œæˆå¤šé¡¹ä»»åŠ¡ï¼Œé€šè¿‡æé«˜èµ„æºä½¿ç”¨æ•ˆç‡æ¥æé«˜ç³»ç»Ÿçš„æ•ˆç‡ã€‚çº¿ç¨‹æ˜¯åœ¨åŒä¸€æ—¶é—´éœ€è¦å®Œæˆå¤šé¡¹ä»»åŠ¡çš„æ—¶å€™å®ç°çš„ã€‚<br>
æœ€ç®€å•çš„æ¯”å–»å¤šçº¿ç¨‹å°±åƒç«è½¦çš„æ¯ä¸€èŠ‚è½¦å¢ï¼Œè€Œè¿›ç¨‹åˆ™æ˜¯ç«è½¦ã€‚è½¦å¢ç¦»å¼€ç«è½¦æ˜¯æ— æ³•è·‘åŠ¨çš„ï¼ŒåŒç†ç«è½¦ä¹Ÿå¯ä»¥æœ‰å¤šèŠ‚è½¦å¢ã€‚å¤šçº¿ç¨‹çš„å‡ºç°å°±æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ã€‚åŒæ—¶å®ƒçš„å‡ºç°ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ã€‚æ›´å¤šä»‹ç»è¯·å‚è€ƒï¼šhttps://baike.baidu.com/item/å¤šçº¿ç¨‹/1190404?fr=aladdin</p>
<h2 id="threadingæ¨¡å—ä»‹ç»">threadingæ¨¡å—ä»‹ç»ï¼š</h2>
<p><code>threading</code>æ¨¡å—æ˜¯<code>python</code>ä¸­ä¸“é—¨æä¾›ç”¨æ¥åšå¤šçº¿ç¨‹ç¼–ç¨‹çš„æ¨¡å—ã€‚<code>threading</code>æ¨¡å—ä¸­æœ€å¸¸ç”¨çš„ç±»æ˜¯<code>Thread</code>ã€‚ä»¥ä¸‹çœ‹ä¸€ä¸ªç®€å•çš„å¤šçº¿ç¨‹ç¨‹åºï¼š</p>
<pre><code class="language-python">import threading
import time

def coding():
    for x in range(3):
        print('%sæ­£åœ¨å†™ä»£ç ' % x)
        time.sleep(1)

def drawing():
    for x in range(3):
        print('%sæ­£åœ¨ç”»å›¾' % x)
        time.sleep(1)


def single_thread():
    coding()
    drawing()

def multi_thread():
    t1 = threading.Thread(target=coding)
    t2 = threading.Thread(target=drawing)

    t1.start()
    t2.start()

if __name__ == '__main__':
    multi_thread()
</code></pre>
<h3 id="æŸ¥çœ‹çº¿ç¨‹æ•°">æŸ¥çœ‹çº¿ç¨‹æ•°ï¼š</h3>
<p>ä½¿ç”¨<code>threading.enumerate()</code>å‡½æ•°ä¾¿å¯ä»¥çœ‹åˆ°å½“å‰çº¿ç¨‹çš„æ•°é‡ã€‚</p>
<h3 id="æŸ¥çœ‹å½“å‰çº¿ç¨‹çš„åå­—">æŸ¥çœ‹å½“å‰çº¿ç¨‹çš„åå­—ï¼š</h3>
<p>ä½¿ç”¨<code>threading.current_thread()</code>å¯ä»¥çœ‹åˆ°å½“å‰çº¿ç¨‹çš„ä¿¡æ¯ã€‚</p>
<h3 id="ç»§æ‰¿è‡ªthreadingthreadç±»">ç»§æ‰¿è‡ª<code>threading.Thread</code>ç±»ï¼š</h3>
<p>ä¸ºäº†è®©çº¿ç¨‹ä»£ç æ›´å¥½çš„å°è£…ã€‚å¯ä»¥ä½¿ç”¨<code>threading</code>æ¨¡å—ä¸‹çš„<code>Thread</code>ç±»ï¼Œç»§æ‰¿è‡ªè¿™ä¸ªç±»ï¼Œç„¶åå®ç°<code>run</code>æ–¹æ³•ï¼Œçº¿ç¨‹å°±ä¼šè‡ªåŠ¨è¿è¡Œ<code>run</code>æ–¹æ³•ä¸­çš„ä»£ç ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import threading
import time

class CodingThread(threading.Thread):
    def run(self):
        for x in range(3):
            print('%sæ­£åœ¨å†™ä»£ç ' % threading.current_thread())
            time.sleep(1)

class DrawingThread(threading.Thread):
    def run(self):
        for x in range(3):
            print('%sæ­£åœ¨ç”»å›¾' % threading.current_thread())
            time.sleep(1)

def multi_thread():
    t1 = CodingThread()
    t2 = DrawingThread()

    t1.start()
    t2.start()

if __name__ == '__main__':
    multi_thread()
</code></pre>
<h3 id="å¤šçº¿ç¨‹å…±äº«å…¨å±€å˜é‡çš„é—®é¢˜">å¤šçº¿ç¨‹å…±äº«å…¨å±€å˜é‡çš„é—®é¢˜ï¼š</h3>
<p>å¤šçº¿ç¨‹éƒ½æ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œçš„ã€‚å› æ­¤åœ¨è¿›ç¨‹ä¸­çš„å…¨å±€å˜é‡æ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯å¯å…±äº«çš„ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºçº¿ç¨‹æ‰§è¡Œçš„é¡ºåºæ˜¯æ— åºçš„ã€‚æœ‰å¯èƒ½ä¼šé€ æˆæ•°æ®é”™è¯¯ã€‚æ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-python">import threading

tickets = 0

def get_ticket():
    global tickets
    for x in range(1000000):
        tickets += 1
    print('tickets:%d'%tickets)

def main():
    for x in range(2):
        t = threading.Thread(target=get_ticket)
        t.start()

if __name__ == '__main__':
    main()
</code></pre>
<p>ä»¥ä¸Šç»“æœæ­£å¸¸æ¥è®²åº”è¯¥æ˜¯6ï¼Œä½†æ˜¯å› ä¸ºå¤šçº¿ç¨‹è¿è¡Œçš„ä¸ç¡®å®šæ€§ã€‚å› æ­¤æœ€åçš„ç»“æœå¯èƒ½æ˜¯éšæœºçš„ã€‚</p>
<h3 id="é”æœºåˆ¶">é”æœºåˆ¶ï¼š</h3>
<p>ä¸ºäº†è§£å†³ä»¥ä¸Šä½¿ç”¨å…±äº«å…¨å±€å˜é‡çš„é—®é¢˜ã€‚<code>threading</code>æä¾›äº†ä¸€ä¸ª<code>Lock</code>ç±»ï¼Œè¿™ä¸ªç±»å¯ä»¥åœ¨æŸä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªå˜é‡çš„æ—¶å€™åŠ é”ï¼Œå…¶ä»–çº¿ç¨‹æ­¤æ—¶å°±ä¸èƒ½è¿›æ¥ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹å¤„ç†å®Œåï¼ŒæŠŠé”é‡Šæ”¾äº†ï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½è¿›æ¥å¤„ç†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import threading

VALUE = 0

gLock = threading.Lock()

def add_value():
    global VALUE
    gLock.acquire()
    for x in range(1000000):
        VALUE += 1
    gLock.release()
    print('valueï¼š%d'%VALUE)

def main():
    for x in range(2):
        t = threading.Thread(target=add_value)
        t.start()

if __name__ == '__main__':
    main()
</code></pre>
<h2 id="lockç‰ˆæœ¬ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼">Lockç‰ˆæœ¬ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼ï¼š</h2>
<p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼æ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­ç»å¸¸è§åˆ°çš„ä¸€ç§æ¨¡å¼ã€‚ç”Ÿäº§è€…çš„çº¿ç¨‹ä¸“é—¨ç”¨æ¥ç”Ÿäº§ä¸€äº›æ•°æ®ï¼Œç„¶åå­˜æ”¾åˆ°ä¸€ä¸ªä¸­é—´çš„å˜é‡ä¸­ã€‚æ¶ˆè´¹è€…å†ä»è¿™ä¸ªä¸­é—´çš„å˜é‡ä¸­å–å‡ºæ•°æ®è¿›è¡Œæ¶ˆè´¹ã€‚ä½†æ˜¯å› ä¸ºè¦ä½¿ç”¨ä¸­é—´å˜é‡ï¼Œä¸­é—´å˜é‡ç»å¸¸æ˜¯ä¸€äº›å…¨å±€å˜é‡ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨é”æ¥ä¿è¯æ•°æ®å®Œæ•´æ€§ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨<code>threading.Lock</code>é”å®ç°çš„â€œç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼â€çš„ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-python">import threading
import random
import time

gMoney = 1000
gLock = threading.Lock()
# è®°å½•ç”Ÿäº§è€…ç”Ÿäº§çš„æ¬¡æ•°ï¼Œè¾¾åˆ°10æ¬¡å°±ä¸å†ç”Ÿäº§
gTimes = 0

class Producer(threading.Thread):
    def run(self):
        global gMoney
        global gLock
        global gTimes
        while True:
            money = random.randint(100, 1000)
            gLock.acquire()
            # å¦‚æœå·²ç»è¾¾åˆ°10æ¬¡äº†ï¼Œå°±ä¸å†ç”Ÿäº§äº†
            if gTimes &gt;= 10:
                gLock.release()
                break
            gMoney += money
            print('%så½“å‰å­˜å…¥%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±' % (threading.current_thread(), money, gMoney))
            gTimes += 1
            time.sleep(0.5)
            gLock.release()

class Consumer(threading.Thread):
    def run(self):
        global gMoney
        global gLock
        global gTimes
        while True:
            money = random.randint(100, 500)
            gLock.acquire()
            if gMoney &gt; money:
                gMoney -= money
                print('%så½“å‰å–å‡º%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±' % (threading.current_thread(), money, gMoney))
                time.sleep(0.5)
            else:
                # å¦‚æœé’±ä¸å¤Ÿäº†ï¼Œæœ‰å¯èƒ½æ˜¯å·²ç»è¶…è¿‡äº†æ¬¡æ•°ï¼Œè¿™æ—¶å€™å°±åˆ¤æ–­ä¸€ä¸‹
                if gTimes &gt;= 10:
                    gLock.release()
                    break
                print(&quot;%så½“å‰æƒ³å–%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±ï¼Œä¸è¶³ï¼&quot; % (threading.current_thread(),money,gMoney))
            gLock.release()

def main():
    for x in range(5):
        Consumer(name='æ¶ˆè´¹è€…çº¿ç¨‹%d'%x).start()

    for x in range(5):
        Producer(name='ç”Ÿäº§è€…çº¿ç¨‹%d'%x).start()

if __name__ == '__main__':
    main()
</code></pre>
<h2 id="conditionç‰ˆçš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼">Conditionç‰ˆçš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼ï¼š</h2>
<p><code>Lock</code>ç‰ˆæœ¬çš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼å¯ä»¥æ­£å¸¸çš„è¿è¡Œã€‚ä½†æ˜¯å­˜åœ¨ä¸€ä¸ªä¸è¶³ï¼Œåœ¨æ¶ˆè´¹è€…ä¸­ï¼Œæ€»æ˜¯é€šè¿‡<code>while True</code>æ­»å¾ªç¯å¹¶ä¸”ä¸Šé”çš„æ–¹å¼å»åˆ¤æ–­é’±å¤Ÿä¸å¤Ÿã€‚ä¸Šé”æ˜¯ä¸€ä¸ªå¾ˆè€—è´¹CPUèµ„æºçš„è¡Œä¸ºã€‚å› æ­¤è¿™ç§æ–¹å¼ä¸æ˜¯æœ€å¥½çš„ã€‚è¿˜æœ‰ä¸€ç§æ›´å¥½çš„æ–¹å¼ä¾¿æ˜¯ä½¿ç”¨<code>threading.Condition</code>æ¥å®ç°ã€‚<code>threading.Condition</code>å¯ä»¥åœ¨æ²¡æœ‰æ•°æ®çš„æ—¶å€™å¤„äºé˜»å¡ç­‰å¾…çŠ¶æ€ã€‚ä¸€æ—¦æœ‰åˆé€‚çš„æ•°æ®äº†ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>notify</code>ç›¸å…³çš„å‡½æ•°æ¥é€šçŸ¥å…¶ä»–å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ã€‚è¿™æ ·å°±å¯ä»¥ä¸ç”¨åšä¸€äº›æ— ç”¨çš„ä¸Šé”å’Œè§£é”çš„æ“ä½œã€‚å¯ä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚é¦–å…ˆå¯¹<code>threading.Condition</code>ç›¸å…³çš„å‡½æ•°åšä¸ªä»‹ç»ï¼Œ<code>threading.Condition</code>ç±»ä¼¼<code>threading.Lock</code>ï¼Œå¯ä»¥åœ¨ä¿®æ”¹å…¨å±€æ•°æ®çš„æ—¶å€™è¿›è¡Œä¸Šé”ï¼Œä¹Ÿå¯ä»¥åœ¨ä¿®æ”¹å®Œæ¯•åè¿›è¡Œè§£é”ã€‚ä»¥ä¸‹å°†ä¸€äº›å¸¸ç”¨çš„å‡½æ•°åšä¸ªç®€å•çš„ä»‹ç»ï¼š</p>
<ol>
<li><code>acquire</code>ï¼šä¸Šé”ã€‚</li>
<li><code>release</code>ï¼šè§£é”ã€‚</li>
<li><code>wait</code>ï¼šå°†å½“å‰çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”ä¼šé‡Šæ”¾é”ã€‚å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨<code>notify</code>å’Œ<code>notify_all</code>å‡½æ•°å”¤é†’ã€‚è¢«å”¤é†’åä¼šç»§ç»­ç­‰å¾…ä¸Šé”ï¼Œä¸Šé”åç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</li>
<li><code>notify</code>ï¼šé€šçŸ¥æŸä¸ªæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯ç¬¬1ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</li>
<li><code>notify_all</code>ï¼šé€šçŸ¥æ‰€æœ‰æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ã€‚<code>notify</code>å’Œ<code>notify_all</code>ä¸ä¼šé‡Šæ”¾é”ã€‚å¹¶ä¸”éœ€è¦åœ¨<code>release</code>ä¹‹å‰è°ƒç”¨ã€‚</li>
</ol>
<p><code>Condition</code>ç‰ˆçš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import threading
import random
import time

gMoney = 1000
gCondition = threading.Condition()
gTimes = 0
gTotalTimes = 5

class Producer(threading.Thread):
    def run(self):
        global gMoney
        global gCondition
        global gTimes
        while True:
            money = random.randint(100, 1000)
            gCondition.acquire()
            if gTimes &gt;= gTotalTimes:
                gCondition.release()
                print('å½“å‰ç”Ÿäº§è€…æ€»å…±ç”Ÿäº§äº†%sæ¬¡'%gTimes)
                break
            gMoney += money
            print('%så½“å‰å­˜å…¥%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±' % (threading.current_thread(), money, gMoney))
            gTimes += 1
            time.sleep(0.5)
            gCondition.notify_all()
            gCondition.release()

class Consumer(threading.Thread):
    def run(self):
        global gMoney
        global gCondition
        while True:
            money = random.randint(100, 500)
            gCondition.acquire()
            # è¿™é‡Œè¦ç»™ä¸ªwhileå¾ªç¯åˆ¤æ–­ï¼Œå› ä¸ºç­‰è½®åˆ°è¿™ä¸ªçº¿ç¨‹çš„æ—¶å€™
            # æ¡ä»¶æœ‰å¯èƒ½åˆä¸æ»¡è¶³äº†
            while gMoney &lt; money:
                if gTimes &gt;= gTotalTimes:
                    gCondition.release()
                    return
                print('%så‡†å¤‡å–%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±ï¼Œä¸è¶³ï¼'%(threading.current_thread(),money,gMoney))
                gCondition.wait()
            gMoney -= money
            print('%så½“å‰å–å‡º%så…ƒé’±ï¼Œå‰©ä½™%så…ƒé’±' % (threading.current_thread(), money, gMoney))
            time.sleep(0.5)
            gCondition.release()

def main():
    for x in range(5):
        Consumer(name='æ¶ˆè´¹è€…çº¿ç¨‹%d'%x).start()

    for x in range(2):
        Producer(name='ç”Ÿäº§è€…çº¿ç¨‹%d'%x).start()

if __name__ == '__main__':
    main()
</code></pre>
<h2 id="queueçº¿ç¨‹å®‰å…¨é˜Ÿåˆ—">Queueçº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼š</h2>
<p>åœ¨çº¿ç¨‹ä¸­ï¼Œè®¿é—®ä¸€äº›å…¨å±€å˜é‡ï¼ŒåŠ é”æ˜¯ä¸€ä¸ªç»å¸¸çš„è¿‡ç¨‹ã€‚å¦‚æœä½ æ˜¯æƒ³æŠŠä¸€äº›æ•°æ®å­˜å‚¨åˆ°æŸä¸ªé˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆPythonå†…ç½®äº†ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ¨¡å—å«åš<code>queue</code>æ¨¡å—ã€‚Pythonä¸­çš„queueæ¨¡å—ä¸­æä¾›äº†åŒæ­¥çš„ã€çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—ç±»ï¼ŒåŒ…æ‹¬FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é˜Ÿåˆ—Queueï¼ŒLIFOï¼ˆåå…¥å…ˆå‡ºï¼‰é˜Ÿåˆ—LifoQueueã€‚è¿™äº›é˜Ÿåˆ—éƒ½å®ç°äº†é”åŸè¯­ï¼ˆå¯ä»¥ç†è§£ä¸ºåŸå­æ“ä½œï¼Œå³è¦ä¹ˆä¸åšï¼Œè¦ä¹ˆéƒ½åšå®Œï¼‰ï¼Œèƒ½å¤Ÿåœ¨å¤šçº¿ç¨‹ä¸­ç›´æ¥ä½¿ç”¨ã€‚å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—æ¥å®ç°çº¿ç¨‹é—´çš„åŒæ­¥ã€‚ç›¸å…³çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆå§‹åŒ–Queue(maxsize)ï¼šåˆ›å»ºä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ã€‚</li>
<li>qsize()ï¼šè¿”å›é˜Ÿåˆ—çš„å¤§å°ã€‚</li>
<li>empty()ï¼šåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚</li>
<li>full()ï¼šåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡äº†ã€‚</li>
<li>get()ï¼šä»é˜Ÿåˆ—ä¸­å–æœ€åä¸€ä¸ªæ•°æ®ã€‚</li>
<li>put()ï¼šå°†ä¸€ä¸ªæ•°æ®æ”¾åˆ°é˜Ÿåˆ—ä¸­ã€‚</li>
</ol>
<h2 id="ä½¿ç”¨ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼å¤šçº¿ç¨‹ä¸‹è½½è¡¨æƒ…åŒ…">ä½¿ç”¨ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å¼å¤šçº¿ç¨‹ä¸‹è½½è¡¨æƒ…åŒ…ï¼š</h2>
<pre><code class="language-python">import threading
import requests
from lxml import etree
from urllib import request
import os
import re
from queue import Queue

class Producer(threading.Thread):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
    }
    def __init__(self,page_queue,img_queue,*args,**kwargs):
        super(Producer, self).__init__(*args,**kwargs)
        self.page_queue = page_queue
        self.img_queue = img_queue


    def run(self):
        while True:
            if self.page_queue.empty():
                break
            url = self.page_queue.get()
            self.parse_page(url)

    def parse_page(self,url):
        response = requests.get(url,headers=self.headers)
        text = response.text
        html = etree.HTML(text)
        imgs = html.xpath(&quot;//div[@class='page-content text-center']//a//img&quot;)
        for img in imgs:
            if img.get('class') == 'gif':
                continue
            img_url = img.xpath(&quot;.//@data-original&quot;)[0]
            suffix = os.path.splitext(img_url)[1]
            alt = img.xpath(&quot;.//@alt&quot;)[0]
            alt = re.sub(r'[ï¼Œã€‚ï¼Ÿ?,/\\Â·]','',alt)
            img_name = alt + suffix
            self.img_queue.put((img_url,img_name))

class Consumer(threading.Thread):
    def __init__(self,page_queue,img_queue,*args,**kwargs):
        super(Consumer, self).__init__(*args,**kwargs)
        self.page_queue = page_queue
        self.img_queue = img_queue

    def run(self):
        while True:
            if self.img_queue.empty():
                if self.page_queue.empty():
                    return
            img = self.img_queue.get(block=True)
            url,filename = img
            request.urlretrieve(url,'images/'+filename)
            print(filename+'  ä¸‹è½½å®Œæˆï¼')

def main():
    page_queue = Queue(100)
    img_queue = Queue(500)
    for x in range(1,101):
        url = &quot;http://www.doutula.com/photo/list/?page=%d&quot; % x
        page_queue.put(url)

    for x in range(5):
        t = Producer(page_queue,img_queue)
        t.start()

    for x in range(5):
        t = Consumer(page_queue,img_queue)
        t.start()

if __name__ == '__main__':
    main()
</code></pre>
<h2 id="gilå…¨å±€è§£é‡Šå™¨é”">GILå…¨å±€è§£é‡Šå™¨é”ï¼š</h2>
<p>Pythonè‡ªå¸¦çš„è§£é‡Šå™¨æ˜¯<code>CPython</code>ã€‚<code>CPython</code>è§£é‡Šå™¨çš„å¤šçº¿ç¨‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡çš„å¤šçº¿ç¨‹ï¼ˆåœ¨å¤šæ ¸CPUä¸­ï¼Œåªèƒ½åˆ©ç”¨ä¸€æ ¸ï¼Œä¸èƒ½åˆ©ç”¨å¤šæ ¸ï¼‰ã€‚åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œï¼Œä¸ºäº†ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œï¼Œåœ¨<code>CPython</code>è§£é‡Šå™¨ä¸­æœ‰ä¸€ä¸ªä¸œè¥¿å«åš<code>GILï¼ˆGlobal Intepreter Lockï¼‰</code>ï¼Œå«åšå…¨å±€è§£é‡Šå™¨é”ã€‚è¿™ä¸ªè§£é‡Šå™¨é”æ˜¯æœ‰å¿…è¦çš„ã€‚å› ä¸º<code>CPython</code>è§£é‡Šå™¨çš„å†…å­˜ç®¡ç†ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å½“ç„¶é™¤äº†<code>CPython</code>è§£é‡Šå™¨ï¼Œè¿˜æœ‰å…¶ä»–çš„è§£é‡Šå™¨ï¼Œæœ‰äº›è§£é‡Šå™¨æ˜¯æ²¡æœ‰<code>GIL</code>é”çš„ï¼Œè§ä¸‹é¢ï¼š</p>
<ol>
<li><code>Jython</code>ï¼šç”¨Javaå®ç°çš„Pythonè§£é‡Šå™¨ã€‚ä¸å­˜åœ¨GILé”ã€‚æ›´å¤šè¯¦æƒ…è¯·è§ï¼šhttps://zh.wikipedia.org/wiki/Jython</li>
<li><code>IronPython</code>ï¼šç”¨<code>.net</code>å®ç°çš„Pythonè§£é‡Šå™¨ã€‚ä¸å­˜åœ¨GILé”ã€‚æ›´å¤šè¯¦æƒ…è¯·è§ï¼šhttps://zh.wikipedia.org/wiki/IronPython</li>
<li><code>PyPy</code>ï¼šç”¨<code>Python</code>å®ç°çš„Pythonè§£é‡Šå™¨ã€‚å­˜åœ¨GILé”ã€‚æ›´å¤šè¯¦æƒ…è¯·è§ï¼šhttps://zh.wikipedia.org/wiki/PyPy<br>
GILè™½ç„¶æ˜¯ä¸€ä¸ªå‡çš„å¤šçº¿ç¨‹ã€‚ä½†æ˜¯åœ¨å¤„ç†ä¸€äº›IOæ“ä½œï¼ˆæ¯”å¦‚æ–‡ä»¶è¯»å†™å’Œç½‘ç»œè¯·æ±‚ï¼‰è¿˜æ˜¯å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æ•ˆç‡çš„ã€‚åœ¨IOæ“ä½œä¸Šå»ºè®®ä½¿ç”¨å¤šçº¿ç¨‹æé«˜æ•ˆç‡ã€‚åœ¨ä¸€äº›CPUè®¡ç®—æ“ä½œä¸Šä¸å»ºè®®ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œè€Œå»ºè®®ä½¿ç”¨å¤šè¿›ç¨‹ã€‚</li>
</ol>
<h2 id="å¤šçº¿ç¨‹ä¸‹è½½ç™¾æ€ä¸å¾—å§æ®µå­ä½œä¸š">å¤šçº¿ç¨‹ä¸‹è½½ç™¾æ€ä¸å¾—å§æ®µå­ä½œä¸šï¼š</h2>
<pre><code class="language-python">import requests
from lxml import etree
import threading
from queue import Queue
import csv


class BSSpider(threading.Thread):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
    }
    def __init__(self,page_queue,joke_queue,*args,**kwargs):
        super(BSSpider, self).__init__(*args,**kwargs)
        self.base_domain = 'http://www.budejie.com'
        self.page_queue = page_queue
        self.joke_queue = joke_queue

    def run(self):
        while True:
            if self.page_queue.empty():
                break
            url = self.page_queue.get()
            response = requests.get(url, headers=self.headers)
            text = response.text
            html = etree.HTML(text)
            descs = html.xpath(&quot;//div[@class='j-r-list-c-desc']&quot;)
            for desc in descs:
                jokes = desc.xpath(&quot;.//text()&quot;)
                joke = &quot;\n&quot;.join(jokes).strip()
                link = self.base_domain+desc.xpath(&quot;.//a/@href&quot;)[0]
                self.joke_queue.put((joke,link))
            print('='*30+&quot;ç¬¬%sé¡µä¸‹è½½å®Œæˆï¼&quot;%url.split('/')[-1]+&quot;=&quot;*30)

class BSWriter(threading.Thread):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
    }

    def __init__(self, joke_queue, writer,gLock, *args, **kwargs):
        super(BSWriter, self).__init__(*args, **kwargs)
        self.joke_queue = joke_queue
        self.writer = writer
        self.lock = gLock

    def run(self):
        while True:
            try:
                joke_info = self.joke_queue.get(timeout=40)
                joke,link = joke_info
                self.lock.acquire()
                self.writer.writerow((joke,link))
                self.lock.release()
                print('ä¿å­˜ä¸€æ¡')
            except:
                break

def main():
    page_queue = Queue(10)
    joke_queue = Queue(500)
    gLock = threading.Lock()
    fp = open('bsbdj.csv', 'a',newline='', encoding='utf-8')
    writer = csv.writer(fp)
    writer.writerow(('content', 'link'))

    for x in range(1,11):
        url = 'http://www.budejie.com/text/%d' % x
        page_queue.put(url)

    for x in range(5):
        t = BSSpider(page_queue,joke_queue)
        t.start()

    for x in range(5):
        t = BSWriter(joke_queue,writer,gLock)
        t.start()

if __name__ == '__main__':
    main()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[11-MongoDBæ•°æ®åº“]]></title>
        <id>https://hehelv.github.io//post/11-mongodb-shu-ju-ku</id>
        <link href="https://hehelv.github.io//post/11-mongodb-shu-ju-ku">
        </link>
        <updated>2020-03-02T05:29:06.000Z</updated>
        <content type="html"><![CDATA[<h1 id="11-mongodbæ•°æ®åº“">11-MongoDBæ•°æ®åº“</h1>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>å®˜æ–¹æ–‡æ¡£ï¼šhttp://www.mongoing.com/docs/</p>
<h3 id="æ–‡æ¡£">æ–‡æ¡£</h3>
<p>MongoDBæ˜¯ä¸€ä¸ªé¢å‘æ–‡æ¡£çš„æ•°æ®åº“<br>
ä¸¾ä¾‹ï¼š{â€œfooâ€:3, â€œgreetingâ€:â€œHello,world!â€}<br>
åŒºåˆ†å¤§å°å†™ï¼Œä¸”keyå”¯ä¸€ï¼Œä¸å¯é‡å¤ï¼Œæ–‡æ¡£å¯åµŒå¥—</p>
<h3 id="é›†åˆ">é›†åˆ</h3>
<p>é›†åˆå°±æ˜¯ä¸€ç»„æ–‡æ¡£<br>
æ–‡æ¡£ç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“é‡Œçš„è¡Œ<br>
é›†åˆç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“é‡Œçš„è¡¨<br>
é›†åˆä¸­çš„æ–‡æ¡£æ— éœ€å›ºå®šé¢ç»“æ„ï¼ˆä¸å…³ç³»å‹æ•°æ®åº“çš„åŒºåˆ«ï¼‰</p>
<h3 id="é›†åˆçš„å‘½å">é›†åˆçš„å‘½å</h3>
<ol>
<li>ä¸èƒ½æœ‰ç©ºå­—ç¬¦ä¸²ï¼ˆ&quot; &quot;ï¼‰</li>
<li>ä¸èƒ½åŒ…å«\0å­—ç¬¦ï¼ˆç©ºå­—ç¬¦ï¼‰</li>
<li>ä¸èƒ½ä½¿ç”¨system.çš„å‰ç¼€ï¼ˆç³»ç»Ÿä¿ç•™ï¼‰</li>
<li>å»ºè®®ä¸åŒ…å«ä¿ç•™å­— &quot;$&quot;</li>
<li>ç”¨ .  åˆ†å‰²ä¸æ‡‚å‘½åç©ºé—´çš„å­é›†åˆï¼ˆå¦‚ï¼šblog.usersï¼Œ blog.postsï¼‰</li>
</ol>
<h3 id="æ•°æ®åº“">æ•°æ®åº“</h3>
<ol>
<li>å¤šä¸ªæ–‡æ¡£ç»„æˆé›†åˆï¼Œå¤šä¸ªé›†åˆç»„æˆæ•°æ®åº“</li>
<li>ä¸€ä¸ªå®ä¾‹å¯ä»¥æ‰¿è½½å¤šä¸ªæ•°æ®åº“</li>
<li>æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ç‹¬ç«‹çš„æƒé™</li>
<li>ä¿ç•™çš„æ•°æ®åç§°ï¼ˆadmin,local,configï¼‰</li>
</ol>
<h2 id="mongodbå®‰è£…å¯åŠ¨">MongoDBå®‰è£…å¯åŠ¨</h2>
<p>ä¸‹è½½misåŒ…ï¼Œå®‰è£…åœ¨æ ¹ç›®å½•ä¸‹MongoDBæ–‡ä»¶å¤¹é‡Œå°±OKï¼Œä¾‹å¦‚ï¼šDï¼š\MongDB......ã€‚åˆ‡è®°ä¸€å¼€å§‹å®‰è£…ä¸è¦é€‰æ‹©é™„å¸¦å®‰è£…compasså›¾å½¢å·¥å…·ï¼Œè¿™ä¸ªä¸‹è½½å¾ˆæ…¢å¯èƒ½ç›´æ¥å¡æ­»ã€‚</p>
<p>å¯åŠ¨ï¼š<br>
é…ç½®æ•°æ®è·¯å¾„<br>
åœ¨ç›®å½•D:\MongoDB\Server\4.0çš„binæ–‡ä»¶ä½¿ç”¨'Shift'+'å³é”®'é€‰æ‹©åœ¨æ­¤å¤„æ‰“å¼€cmdï¼Œç„¶åå†cmdä¸­è¾“å…¥ï¼šmonogod --dbpath D:\MongoDB\Server\4.0\data<br>
å›è½¦ï¼Œæ¥åˆ°NETWORK  [thread1] waiting for connections on port 27017<br>
æ­¤æ—¶ï¼Œåœ¨biné‡Œæ‰“å¼€å¦ä¸€ä¸ªcmdï¼Œè¾“å…¥mongoï¼Œå›è½¦ï¼Œå°±OKå•¦<br>
å¯ä»¥ä½¿ç”¨ show databases è¯•ä¸€è¯•</p>
<h3 id="ä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œæ•°æ®åº“crud">ä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œæ•°æ®åº“ï¼ˆCRUDï¼‰</h3>
<p>æ–°å¢æ•°æ®ï¼ˆCreateï¼‰</p>
<pre><code class="language-bash"># è¿›å…¥æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰è¯¥æ•°æ®åº“ï¼Œä¼šè‡ªåŠ¨åˆ›å»º
use studentsï¼› 
# æ–°å¢æ•°æ®
stu = {
  name:'Jhon',
  age:21}
# æ’å…¥æ•°æ®åˆ°æ•°æ®åº“
db.students.insert(stu)
</code></pre>
<p>æŸ¥è¯¢æ•°æ®ï¼ˆReadï¼‰</p>
<pre><code class="language-css"># æŸ¥è¯¢studentsä¸­çš„æ‰€æœ‰æ•°æ®
db.students.find()
# æŸ¥è¯¢studentsä¸­çš„ä¸€æ¡æ•°æ®
db.students.findOne()
</code></pre>
<p>ä¿®æ”¹æ•°æ®ï¼ˆUpdateï¼‰</p>
<pre><code class="language-bash"># éœ€è¦å…ˆæŸ¥è¯¢è¿™æ¡æ•°æ®
s = db.students.findOne()
# ä¿®æ”¹æ•°æ®=æ›¿æ¢æ•°æ®ï¼Œæ›¿æ¢åçš„æ•°æ®æ²¡æœ‰å¹´é¾„
db.students.update({name: 'Jhon'}, {name: 'JhonC'})
</code></pre>
<p>åˆ é™¤æ•°æ®ï¼ˆDeleteï¼‰</p>
<pre><code class="language-css"># åˆ é™¤è¯¥å±æ€§çš„æ•°æ®
db.students.remove({name: 'JhonC'})
# åˆ é™¤studentsä¸­çš„æ‰€æœ‰æ•°æ®
db.students.remove(())
</code></pre>
<p>ç»ƒä¹ ï¼š</p>
<pre><code class="language-csharp"># æ–°å»ºå¹¶è¿›å…¥æ•°æ®åº“
use students
# æŸ¥çœ‹å½“å‰æ•°æ®åº“
db.log
#æ’å…¥å¤šæ¡æ•°æ®
db.students.insertMany(
    [
        { name:&quot;bob&quot;, age:16, sex: &quot;male&quot;, grade:95},
        { name:&quot;ahn&quot;, age:18, sex: &quot;female&quot;, grade:45},
        { name:&quot;xi&quot;, age:15, sex: &quot;male&quot;, grade:75},
        { name:&quot;bob1&quot;, age:16, sex: &quot;male&quot;, grade:95},
        { name:&quot;ahn1&quot;, age:18, sex: &quot;male&quot;, grade:45},
        { name:&quot;xi1&quot;, age:15, sex: &quot;female&quot;, grade:55},
        { name:&quot;bob2&quot;, age:16, sex: &quot;female&quot;, grade:95},
        { name:&quot;ahn2&quot;, age:18, sex: &quot;male&quot;, grade:60},
        { name:&quot;xi2&quot;, age:15, sex: &quot;male&quot;, grade:75},
        { name:&quot;bob3&quot;, age:16, sex: &quot;male&quot;, grade:95},
        { name:&quot;ahn3&quot;, age:18, sex: &quot;female&quot;, grade:45},
        { name:&quot;xi3&quot;, age:15, sex: &quot;male&quot;, grade:85},
        { name:&quot;bob4&quot;, age:16, sex: &quot;female&quot;, grade:95},
        { name:&quot;ahn4&quot;, age:18, sex: &quot;male&quot;, grade:45},
        { name:&quot;xi4&quot;, age:15, sex: &quot;male&quot;, grade:75}
    ]
)
# æŸ¥çœ‹æ‰€æœ‰æ•°æ®
db.students.find()
# æŸ¥çœ‹æ•°æ®æ•°é‡
db.students.count()
# cls æ¸…å±
# æŸ¥è¯¢æ‰€æœ‰ç”·ç”Ÿæ•°æ®
db.students.find({sex: 'male'})
# æŸ¥è¯¢æ‰€æœ‰åŠæ ¼å­¦ç”Ÿä¿¡æ¯
db.students.find({grade:{'$gte':60}})
# æŸ¥è¯¢æ‰€æœ‰18å²ç”·ç”Ÿå’Œ16å²å¥³ç”Ÿçš„æ•°æ®
db.students.find({'$or':[{sex:'male', age:18}, {sex: 'female', age:16}]})
# æŒ‰ç…§å­¦ç”Ÿçš„å¹´é¾„è¿›è¡Œæ’åºï¼ˆ1ä»£è¡¨å‡åºï¼Œ-1ä»£è¡¨é™åºï¼‰
db.students.find().sort({age: 1})
# ç»™æ‰€æœ‰å­¦ç”Ÿéƒ½åŠ ä¸€ä¸ªåœ°å€=chinaçš„å­—æ®µå±æ€§ï¼ˆä¿®æ”¹å™¨æ“ä½œï¼‰
db.students.update({}, {'$set':{adress:'china'}}, {multi:true})
# ç»™æ‰€æœ‰å¥³å­¦ç”Ÿéƒ½åŠ ä¸€å²ï¼ˆä¿®æ”¹å™¨æ“ä½œï¼‰
db.students.update({sex:'female'}, {'$inc':{age:1}}, {multi: true})
</code></pre>
<h2 id="ä½¿ç”¨pythonè¿æ¥mongodb">ä½¿ç”¨Pythonè¿æ¥MongoDB</h2>
<p>æ‰‹åŠ¨å¯åŠ¨MongoDB<br>
åœ¨MongoDBçš„binç›®å½•æ‰“å¼€cmd è¾“å…¥ monogod --dbpath D:\MongoDB\Server\4.0\data</p>
<pre><code class="language-python"># å»ºç«‹å®¢æˆ·ç«¯è¿æ¥çš„ä¸‰ç§æ–¹æ³•
from pymongo import MongoClient
client = MongoClient()
# client2 = MongoClient('localhost', 27017)
# client3 = MongoClient('mongodb://localhost:27017')
# æ˜¾ç¤ºæ•°æ®åº“
dbs = client.list_database_names()
print(dbs)
# è¿›å…¥æŸä¸ªæ•°æ®åº“
db = client.blog
</code></pre>
<h3 id="curdå®Œæ•´ç¤ºä¾‹ä»£ç ">curdå®Œæ•´ç¤ºä¾‹ä»£ç </h3>
<pre><code class="language-python">from pymongo import MongoClient
from bson.objectid import ObjectId


class TestMongo(object):

    def __init__(self):
        self.client = MongoClient()
        self.db = self.client['students']

    def add_one(self):
        '''æ–°å¢æ•°æ®'''
        post ={
            'name': 'ben',
            'age': 18,
            'sex': &quot;male&quot;,
            'grade': 80,
            'adress': &quot;china&quot;
        }
        return self.db.students.insert_one(post)
    def add_many(self):
        '''æ–°å¢å¤šæ¡æ•°æ®'''
        infos = [
            {'name': 'ben', 'age': 18, 'sex': &quot;male&quot;, 'grade': 80, 'adress': &quot;china&quot;},
            {'name': 'sum', 'age': 19, 'sex': &quot;male&quot;, 'grade': 75, 'adress': &quot;china&quot;},
            {'name': 'lily', 'age': 16, 'sex': &quot;female&quot;, 'grade': 90, 'adress': &quot;china&quot;},
            {'name': 'teddy', 'age': 19, 'sex': &quot;male&quot;, 'grade': 65, 'adress': &quot;china&quot;},
            {'name': 'fluence', 'age': 18, 'sex': &quot;female&quot;, 'grade': 80, 'adress': &quot;china&quot;}
            ]
        return self.db.students.insert_many(infos)

    def get_one(self):
        '''æŸ¥è¯¢ä¸€æ¡æ•°æ®'''
        return self.db.students.find_one()

    def get_more(self):
        '''æŸ¥è¯¢å¤šæ¡æ•°æ®'''
        return self.db.students.find({'age': 18})

    def get_one_from_oid(self, oid):
        '''æŸ¥è¯¢æŒ‡å®šIDçš„æ•°æ®'''
        obj = ObjectId(oid)
        return self.db.students.find_one({'_id': obj})

    def update_one(self):
        '''ä¿®æ”¹ä¸€æ¡æ•°æ®'''
        return self.db.students.update_one({'age': 20}, {'$inc': {'x': 10}})

    def update_many(self):
        '''ä¿®æ”¹å¤šæ¡æ•°æ®'''
        return self.db.students.update_many({}, {'$inc': {'age': 5}})

    def dalete_one(self):
        '''åˆ é™¤ä¸€æ¡æ•°æ®'''
        return self.db.students.delete_one({'name': 'ben'})

    def delete_many(self):
        '''åˆ é™¤å¤šæ¡æ•°æ®'''
        return self.db.students.delete_many({'age': 24})

def main():
    obj = TestMongo()
    # rest = obj.add_one()
    # print(rest)

    # rest = obj.add_many()
    # print(rest)

    # rest = obj.get_one()
    # print(rest)

    # rest = obj.get_more()
    # for i in rest:
    #     print(i['_id'])

    # rest = obj.get_one_from_oid('5c68b5cb5a49891b40b8a18e')
    # print(rest)

    # rest = obj.update_one()
    # print(rest)

    # rest = obj.update_many()
    # print(rest)

    # rest = obj.delete_one()
    # print(rest.delete_count)

    # rest = obj.delete_many()
    # print(rest.delete_count)
if __name__ == '__main__':
    main()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[10-MySQLæ•°æ®åº“]]></title>
        <id>https://hehelv.github.io//post/10-mysql-shu-ju-ku</id>
        <link href="https://hehelv.github.io//post/10-mysql-shu-ju-ku">
        </link>
        <updated>2020-03-02T05:28:05.000Z</updated>
        <content type="html"><![CDATA[<h1 id="10-mysqlæ•°æ®åº“">10-MySQLæ•°æ®åº“</h1>
<h2 id="å®‰è£…mysql">å®‰è£…mysqlï¼š</h2>
<ol>
<li>åœ¨å®˜ç½‘ï¼šhttps://dev.mysql.com/downloads/windows/installer/5.7.html</li>
<li>å¦‚æœæç¤ºæ²¡æœ‰<code>.NET Framework</code>æ¡†æ¶ã€‚é‚£ä¹ˆå°±åœ¨æç¤ºæ¡†ä¸­æ‰¾åˆ°ä¸‹è½½é“¾æ¥ï¼Œä¸‹è½½ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚</li>
<li>å¦‚æœæç¤ºæ²¡æœ‰<code>Microsoft Virtual C++ x64(x86)</code>ï¼Œé‚£ä¹ˆç™¾åº¦æˆ–è€…è°·æ­Œè¿™ä¸ªè½¯ä»¶å®‰è£…å³å¯ã€‚</li>
<li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ã€‚é‚£ä¹ˆç§èŠæˆ‘ã€‚</li>
</ol>
<h2 id="navicat">navicatï¼š</h2>
<p>navicatæ˜¯ä¸€ä¸ªæ“ä½œmysqlæ•°æ®åº“éå¸¸æ–¹ä¾¿çš„è½¯ä»¶ã€‚ä½¿ç”¨ä»–æ“ä½œæ•°æ®åº“ï¼Œå°±è·Ÿä½¿ç”¨excelæ“ä½œæ•°æ®æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="å®‰è£…é©±åŠ¨ç¨‹åº">å®‰è£…é©±åŠ¨ç¨‹åºï¼š</h2>
<p>Pythonè¦æƒ³æ“ä½œMySQLã€‚å¿…é¡»è¦æœ‰ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæˆ–è€…å«åšé©±åŠ¨ç¨‹åºã€‚é©±åŠ¨ç¨‹åºæœ‰å¾ˆå¤šã€‚æ¯”å¦‚æœ‰<code>mysqldb</code>ã€<code>mysqlclient</code>ã€<code>pymysql</code>ç­‰ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©ç”¨<code>pymysql</code>ã€‚å®‰è£…æ–¹å¼ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼Œé€šè¿‡å‘½ä»¤<code>pip install pymysql</code>å³å¯å®‰è£…ã€‚</p>
<h2 id="æ•°æ®åº“è¿æ¥">æ•°æ®åº“è¿æ¥ï¼š</h2>
<p>æ•°æ®åº“è¿æ¥ä¹‹å‰ã€‚é¦–å…ˆå…ˆç¡®è®¤ä»¥ä¸‹å·¥ä½œå®Œæˆï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ä¸€ä¸ª<code>pymysql_test</code>æ•°æ®åº“.ä»¥ä¸‹å°†ä»‹ç»è¿æ¥<code>mysql</code>çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="language-python">    import pymysql

    db = pymysql.connect(
        host=&quot;127.0.0.1&quot;,
        user='root',
        password='root',
        database='pymysql_test',
        port=3306
    )
    cursor = db.cursor()
    cursor.execute(&quot;select 1&quot;)
    data = cursor.fetchone()
    print(data)
    db.close()
</code></pre>
<h2 id="æ’å…¥æ•°æ®">æ’å…¥æ•°æ®ï¼š</h2>
<pre><code class="language-python">import pymysql

db = pymysql.connect(
    host=&quot;127.0.0.1&quot;,
    user='root',
    password='root',
    database='pymysql_test',
    port=3306
)
cursor = db.cursor()
sql = &quot;&quot;&quot;
insert into user(
    id,username,gender,age,password
  ) 
  values(null,'abc',1,18,'111111');
&quot;&quot;&quot;
cursor.execute(sql)
db.commit()
db.close()
</code></pre>
<p>å¦‚æœåœ¨æ•°æ®è¿˜ä¸èƒ½ä¿è¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ¥æ’å…¥æ•°æ®ï¼š</p>
<pre><code class="language-python">sql = &quot;&quot;&quot;
insert into user(
    id,username,gender,age,password
  ) 
  values(null,%s,%s,%s,%s);
&quot;&quot;&quot;

cursor.execute(sql,('spider',1,20,'222222'))
</code></pre>
<h2 id="æŸ¥æ‰¾æ•°æ®">æŸ¥æ‰¾æ•°æ®ï¼š</h2>
<p>ä½¿ç”¨<code>pymysql</code>æŸ¥è¯¢æ•°æ®ã€‚å¯ä»¥ä½¿ç”¨<code>fetch*</code>æ–¹æ³•ã€‚</p>
<ol>
<li><code>fetchone()</code>ï¼šè¿™ä¸ªæ–¹æ³•æ¯æ¬¡ä¹‹è·å–ä¸€æ¡æ•°æ®ã€‚</li>
<li><code>fetchall()</code>ï¼šè¿™ä¸ªæ–¹æ³•æ¥æ”¶å…¨éƒ¨çš„è¿”å›ç»“æœã€‚</li>
<li><code>fetchmany(size)</code>ï¼šå¯ä»¥è·å–æŒ‡å®šæ¡æ•°çš„æ•°æ®ã€‚<br>
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-python">cursor = db.cursor()

sql = &quot;&quot;&quot;
select * from user
&quot;&quot;&quot;

cursor.execute(sql)
while True:
    result = cursor.fetchone()
    if not result:
        break
    print(result)
db.close()
</code></pre>
<p>æˆ–è€…æ˜¯ç›´æ¥ä½¿ç”¨<code>fetchall</code>ï¼Œä¸€æ¬¡æ€§å¯ä»¥æŠŠæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®éƒ½å–å‡ºæ¥ï¼š</p>
<pre><code class="language-python">cursor = db.cursor()

sql = &quot;&quot;&quot;
select * from user
&quot;&quot;&quot;

cursor.execute(sql)
results = cursor.fetchall()
for result in results:
    print(result)
db.close()
</code></pre>
<p>æˆ–è€…æ˜¯ä½¿ç”¨<code>fetchmany</code>ï¼ŒæŒ‡å®šè·å–å¤šå°‘æ¡æ•°æ®ï¼š</p>
<pre><code class="language-python">cursor = db.cursor()

sql = &quot;&quot;&quot;
select * from user
&quot;&quot;&quot;

cursor.execute(sql)
results = cursor.fetchmany(1)
for result in results:
    print(result)
db.close()
</code></pre>
<h2 id="åˆ é™¤æ•°æ®">åˆ é™¤æ•°æ®ï¼š</h2>
<pre><code class="language-python">cursor = db.cursor()

sql = &quot;&quot;&quot;
delete from user where id=1
&quot;&quot;&quot;

cursor.execute(sql)
db.commit()
db.close()
</code></pre>
<h2 id="æ›´æ–°æ•°æ®">æ›´æ–°æ•°æ®ï¼š</h2>
<pre><code class="language-python">conn = pymysql.connect(host='localhost',user='root',password='root',database='pymysql_demo',port=3306)
cursor = conn.cursor()

sql = &quot;&quot;&quot;
update user set username='aaa' where id=1
&quot;&quot;&quot;
cursor.execute(sql)
conn.commit()

conn.close()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[9-excelæ–‡ä»¶å¤„ç†]]></title>
        <id>https://hehelv.github.io//post/9-excel-wen-jian-chu-li</id>
        <link href="https://hehelv.github.io//post/9-excel-wen-jian-chu-li">
        </link>
        <updated>2020-03-02T05:26:36.000Z</updated>
        <content type="html"><![CDATA[<h1 id="9-excelæ–‡ä»¶å¤„ç†">9-excelæ–‡ä»¶å¤„ç†</h1>
<h2 id="å®‰è£…ç¯å¢ƒ">å®‰è£…ç¯å¢ƒ</h2>
<ol>
<li>
<p>pandasä¾èµ–å¤„ç†Excelçš„xlrdæ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰å®‰è£…è¿™ä¸ªï¼Œå®‰è£…å‘½ä»¤æ˜¯ï¼špip install xlrd</p>
</li>
<li>
<p>å®‰è£…pandasæ¨¡å—è¿˜éœ€è¦ä¸€å®šçš„ç¼–ç ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±åœ¨å®‰è£…çš„æ—¶å€™ï¼Œç¡®ä¿ä½ çš„ç”µè„‘æœ‰è¿™äº›ç¯å¢ƒï¼šNet.4 ã€VC-Compilerä»¥åŠwinsdk_webï¼Œå¦‚æœå¤§å®¶æ²¡æœ‰è¿™äº›è½¯ä»¶~å¯ä»¥å’¨è¯¢æˆ‘ä»¬çš„è¾…å¯¼å‘˜ç´¢è¦ç›¸å…³å®‰è£…å·¥å…·ã€‚</p>
</li>
<li>
<p>æ­¥éª¤1å’Œ2 å‡†å¤‡å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®‰è£…pandasäº†ï¼Œå®‰è£…å‘½ä»¤æ˜¯ï¼špip install pandas</p>
</li>
</ol>
<h2 id="pandasæ“ä½œexcelè¡¨å•">pandasæ“ä½œExcelè¡¨å•</h2>
<p>æ•°æ®å‡†å¤‡ï¼Œæœ‰ä¸€ä¸ªExcelæ–‡ä»¶ï¼šlemon.xlsxæœ‰ä¸¤ä¸ªè¡¨å•ï¼Œè¡¨å•ååˆ†åˆ«ä¸ºï¼šPython ä»¥åŠstudentï¼Œ</p>
<p>Pythonçš„è¡¨å•æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="1"><img src="../images/pandas-01.png" alt=""></figure>
<p>studentçš„è¡¨å•æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="2"><img src="../images/pandas-02.png" alt=""></figure>
<p>1ï¼šåœ¨åˆ©ç”¨pandasæ¨¡å—è¿›è¡Œæ“ä½œå‰ï¼Œå¯ä»¥å…ˆå¼•å…¥è¿™ä¸ªæ¨¡å—ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>import  pandas  as pd
</code></pre>
<p>2:è¯»å–Excelæ–‡ä»¶çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<pre><code class="language-sheel">#æ–¹æ³•ä¸€ï¼šé»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªè¡¨å•df=pd.read_excel('lemon.xlsx')#è¿™ä¸ªä¼šç›´æ¥é»˜è®¤è¯»å–åˆ°è¿™ä¸ªExcelçš„ç¬¬ä¸€ä¸ªè¡¨å•
data=df.head()#é»˜è®¤è¯»å–å‰5è¡Œçš„æ•°æ®
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="3"><img src="../images/pandas-03.png" alt=""></figure>
<pre><code class="language-sheel">#æ–¹æ³•äºŒï¼šé€šè¿‡æŒ‡å®šè¡¨å•åçš„æ–¹å¼æ¥è¯»å–
df=pd.read_excel('lemon.xlsx',sheet_name='student')#å¯ä»¥é€šè¿‡sheet_nameæ¥æŒ‡å®šè¯»å–çš„è¡¨å•
data=df.head()#é»˜è®¤è¯»å–å‰5è¡Œçš„æ•°æ®
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼š<br>
<img src="../images/pandas-04.png" alt=""></p>
<pre><code class="language-shell">#æ–¹æ³•ä¸‰ï¼šé€šè¿‡è¡¨å•ç´¢å¼•æ¥æŒ‡å®šè¦è®¿é—®çš„è¡¨å•ï¼Œ0è¡¨ç¤ºç¬¬ä¸€ä¸ªè¡¨å•
#ä¹Ÿå¯ä»¥é‡‡ç”¨è¡¨å•åå’Œç´¢å¼•çš„åŒé‡æ–¹å¼æ¥å®šä½è¡¨å•
#ä¹Ÿå¯ä»¥åŒæ—¶å®šä½å¤šä¸ªè¡¨å•ï¼Œæ–¹å¼éƒ½ç½—åˆ—å¦‚ä¸‹æ‰€ç¤º
df=pd.read_excel('lemon.xlsx',sheet_name=['python','student'])#å¯ä»¥é€šè¿‡è¡¨å•ååŒæ—¶æŒ‡å®šå¤šä¸ª
# df=pd.read_excel('lemon.xlsx',sheet_name=0)#å¯ä»¥é€šè¿‡è¡¨å•ç´¢å¼•æ¥æŒ‡å®šè¯»å–çš„è¡¨å•
# df=pd.read_excel('lemon.xlsx',sheet_name=['python',1])#å¯ä»¥æ··åˆçš„æ–¹å¼æ¥æŒ‡å®š
# df=pd.read_excel('lemon.xlsx',sheet_name=[1,2])#å¯ä»¥é€šè¿‡ç´¢å¼• åŒæ—¶æŒ‡å®šå¤šä¸ª
data=df.values#è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œæ³¨æ„è¿™é‡Œä¸èƒ½ç”¨head()æ–¹æ³•å“¦~
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<h2 id="pandasæ“ä½œexcelçš„è¡Œåˆ—">pandasæ“ä½œExcelçš„è¡Œåˆ—</h2>
<p><strong>1ï¼šè¯»å–æŒ‡å®šçš„å•è¡Œï¼Œæ•°æ®ä¼šå­˜åœ¨åˆ—è¡¨é‡Œé¢</strong></p>
<pre><code>#1ï¼šè¯»å–æŒ‡å®šè¡Œdf=pd.read_excel('lemon.xlsx')#è¿™ä¸ªä¼šç›´æ¥é»˜è®¤è¯»å–åˆ°è¿™ä¸ªExcelçš„ç¬¬ä¸€ä¸ªè¡¨å•
data=df.ix[0].values#0è¡¨ç¤ºç¬¬ä¸€è¡Œ è¿™é‡Œè¯»å–æ•°æ®å¹¶ä¸åŒ…å«è¡¨å¤´ï¼Œè¦æ³¨æ„å“¦ï¼
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤º:</p>
<figure data-type="image" tabindex="4"><img src="../images/pandas-05.png" alt=""></figure>
<p><strong>2ï¼šè¯»å–æŒ‡å®šçš„å¤šè¡Œï¼Œæ•°æ®ä¼šå­˜åœ¨åµŒå¥—çš„åˆ—è¡¨é‡Œé¢ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[[1,2]].values#è¯»å–æŒ‡å®šå¤šè¡Œçš„è¯ï¼Œå°±è¦åœ¨ix[]é‡Œé¢åµŒå¥—åˆ—è¡¨æŒ‡å®šè¡Œæ•°
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>3ï¼šè¯»å–æŒ‡å®šçš„è¡Œåˆ—ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[1,2]#è¯»å–ç¬¬ä¸€è¡Œç¬¬äºŒåˆ—çš„å€¼ï¼Œè¿™é‡Œä¸éœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>4ï¼šè¯»å–æŒ‡å®šçš„å¤šè¡Œå¤šåˆ—å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[[1,2],['title','data']].values#è¯»å–ç¬¬ä¸€è¡Œç¬¬äºŒè¡Œçš„titleä»¥åŠdataåˆ—çš„å€¼ï¼Œè¿™é‡Œéœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>5ï¼šè·å–æ‰€æœ‰è¡Œçš„æŒ‡å®šåˆ—</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[:,['title','data']].values#è¯»æ‰€æœ‰è¡Œçš„titleä»¥åŠdataåˆ—çš„å€¼ï¼Œè¿™é‡Œéœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>6ï¼šè·å–è¡Œå·å¹¶æ‰“å°è¾“å‡º</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºè¡Œå·åˆ—è¡¨&quot;,df.index.values)

è¾“å‡ºç»“æœæ˜¯ï¼š
è¾“å‡ºè¡Œå·åˆ—è¡¨ [0 1 2 3]
</code></pre>
<p><strong>7ï¼šè·å–åˆ—åå¹¶æ‰“å°è¾“å‡º</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºåˆ—æ ‡é¢˜&quot;,df.columns.values)

è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
è¾“å‡ºåˆ—æ ‡é¢˜ ['case_id' 'title' 'data']
</code></pre>
<p><strong>8ï¼šè·å–æŒ‡å®šè¡Œæ•°çš„å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºå€¼&quot;,df.sample(3).values)#è¿™ä¸ªæ–¹æ³•ç±»ä¼¼äºhead()æ–¹æ³•ä»¥åŠdf.valuesæ–¹æ³•

è¾“å‡ºå€¼
 [[2 'è¾“å…¥é”™è¯¯çš„å¯†ç ' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;12345678&quot;}']
 [3 'æ­£å¸¸å……å€¼' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;1000&quot;}']
 [1 'æ­£å¸¸ç™»å½•' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;123456&quot;}']]
</code></pre>
<p><strong>9ï¼šè·å–æŒ‡å®šåˆ—çš„å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºå€¼\n&quot;,df['data'].values)
</code></pre>
<h2 id="pandaså¤„ç†excelæ•°æ®æˆä¸ºå­—å…¸">pandaså¤„ç†Excelæ•°æ®æˆä¸ºå­—å…¸</h2>
<p>æœ‰å¦‚ä¸‹çš„æ•°æ®ï¼Œå¤„ç†æˆåˆ—è¡¨åµŒå¥—å­—å…¸ï¼Œä¸”å­—å…¸çš„keyä¸ºè¡¨å¤´åã€‚</p>
<h2 id=""><img src="../images/pandas-06.png" alt=""></h2>
<p>å®ç°çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>df=pd.read_excel('lemon.xlsx')
test_data=[]
for i in df.index.values:#è·å–è¡Œå·çš„ç´¢å¼•ï¼Œå¹¶å¯¹å…¶è¿›è¡Œéå†ï¼š
    #æ ¹æ®iæ¥è·å–æ¯ä¸€è¡ŒæŒ‡å®šçš„æ•°æ® å¹¶åˆ©ç”¨to_dictè½¬æˆå­—å…¸
    row_data=df.ix[i,['case_id','module','title','http_method','url','data','expected']].to_dict()
    test_data.append(row_data)
print(&quot;æœ€ç»ˆè·å–åˆ°çš„æ•°æ®æ˜¯ï¼š{0}&quot;.format(test_data))
</code></pre>
<p>æœ€åå¾—åˆ°çš„ç»“æœæ˜¯ï¼š</p>
<pre><code>æœ€ç»ˆè·å–åˆ°çš„æ•°æ®æ˜¯ï¼š
[{'title': 'æ­£å¸¸ç™»å½•', 'case_id': 1, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;123456&quot;}'}, 
{'title': 'è¾“å…¥é”™è¯¯çš„å¯†ç ', 'case_id': 2, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;12345678&quot;}'}, 
{'title': 'æ­£å¸¸å……å€¼', 'case_id': 3, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;1000&quot;}'}, 
{'title': 'å……å€¼è¾“å…¥è´Ÿæ•°', 'case_id': 4, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;-100&quot;}'}]
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[8-csvæ–‡ä»¶å¤„ç†]]></title>
        <id>https://hehelv.github.io//post/8-csv-wen-jian-chu-li</id>
        <link href="https://hehelv.github.io//post/8-csv-wen-jian-chu-li">
        </link>
        <updated>2020-03-02T03:07:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="8-csvæ–‡ä»¶å¤„ç†">8-csvæ–‡ä»¶å¤„ç†</h1>
<h2 id="è¯»å–csvæ–‡ä»¶">è¯»å–csvæ–‡ä»¶ï¼š</h2>
<pre><code class="language-python">import csv

with open('stock.csv','r') as fp:
    reader = csv.reader(fp)
    titles = next(reader)
    for x in reader:
        print(x)
</code></pre>
<p>è¿™æ ·æ“ä½œï¼Œä»¥åè·å–æ•°æ®çš„æ—¶å€™ï¼Œå°±è¦é€šè¿‡ä¸‹è¡¨æ¥è·å–æ•°æ®ã€‚å¦‚æœæƒ³è¦åœ¨è·å–æ•°æ®çš„æ—¶å€™é€šè¿‡æ ‡é¢˜æ¥è·å–ã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>DictReader</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import csv

with open('stock.csv','r') as fp:
    reader = csv.DictReader(fp)
    for x in reader:
        print(x['turnoverVol'])
</code></pre>
<h2 id="å†™å…¥æ•°æ®åˆ°csvæ–‡ä»¶">å†™å…¥æ•°æ®åˆ°csvæ–‡ä»¶ï¼š</h2>
<p>å†™å…¥æ•°æ®åˆ°csvæ–‡ä»¶ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª<code>writer</code>å¯¹è±¡ï¼Œä¸»è¦ç”¨åˆ°ä¸¤ä¸ªæ–¹æ³•ã€‚ä¸€ä¸ªæ˜¯<code>writerow</code>ï¼Œè¿™ä¸ªæ˜¯å†™å…¥ä¸€è¡Œã€‚ä¸€ä¸ªæ˜¯<code>writerows</code>ï¼Œè¿™ä¸ªæ˜¯å†™å…¥å¤šè¡Œã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import csv

headers = ['name','age','classroom']
values = [
    ('zhiliao',18,'111'),
    ('wena',20,'222'),
    ('bbc',21,'111')
]
with open('test.csv','w',newline='') as fp:
    writer = csv.writer(fp)
    writer.writerow(headers)
    writer.writerows(values)
</code></pre>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸çš„æ–¹å¼æŠŠæ•°æ®å†™å…¥è¿›å»ã€‚è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨<code>DictWriter</code>äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">import csv

headers = ['name','age','classroom']
values = [
    {&quot;name&quot;:'wenn',&quot;age&quot;:20,&quot;classroom&quot;:'222'},
    {&quot;name&quot;:'abc',&quot;age&quot;:30,&quot;classroom&quot;:'333'}
]
with open('test.csv','w',newline='') as fp:
    writer = csv.DictWriter(fp,headers)
    writer = csv.writeheader()
    writer.writerow({'name':'zhiliao',&quot;age&quot;:18,&quot;classroom&quot;:'111'})
    writer.writerows(values
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[7-jsonæ–‡ä»¶å¤„ç†]]></title>
        <id>https://hehelv.github.io//post/7-json-wen-jian-chu-li</id>
        <link href="https://hehelv.github.io//post/7-json-wen-jian-chu-li">
        </link>
        <updated>2020-02-28T07:24:40.000Z</updated>
        <content type="html"><![CDATA[<h1 id="7-jsonæ–‡ä»¶å¤„ç†">7-jsonæ–‡ä»¶å¤„ç†</h1>
<h2 id="ä»€ä¹ˆæ˜¯json">ä»€ä¹ˆæ˜¯jsonï¼š</h2>
<p>JSON(JavaScript Object Notation, JS å¯¹è±¡æ ‡è®°) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚å®ƒåŸºäº ECMAScript (w3cåˆ¶å®šçš„jsè§„èŒƒ)çš„ä¸€ä¸ªå­é›†ï¼Œé‡‡ç”¨å®Œå…¨ç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€çš„æ–‡æœ¬æ ¼å¼æ¥å­˜å‚¨å’Œè¡¨ç¤ºæ•°æ®ã€‚ç®€æ´å’Œæ¸…æ™°çš„å±‚æ¬¡ç»“æ„ä½¿å¾— JSON æˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚ æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡ã€‚æ›´å¤šè§£é‡Šè¯·è§ï¼šhttps://baike.baidu.com/item/JSON/2462549?fr=aladdin</p>
<h2 id="jsonæ”¯æŒæ•°æ®æ ¼å¼">JSONæ”¯æŒæ•°æ®æ ¼å¼ï¼š</h2>
<ol>
<li>å¯¹è±¡ï¼ˆå­—å…¸ï¼‰ã€‚ä½¿ç”¨èŠ±æ‹¬å·ã€‚</li>
<li>æ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰ã€‚ä½¿ç”¨æ–¹æ‹¬å·ã€‚</li>
<li>æ•´å½¢ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹è¿˜æœ‰nullç±»å‹ã€‚</li>
<li>å­—ç¬¦ä¸²ç±»å‹ï¼ˆå­—ç¬¦ä¸²å¿…é¡»è¦ç”¨åŒå¼•å·ï¼Œä¸èƒ½ç”¨å•å¼•å·ï¼‰ã€‚</li>
</ol>
<p>å¤šä¸ªæ•°æ®ä¹‹é—´ä½¿ç”¨é€—å·åˆ†å¼€ã€‚<br>
<strong>æ³¨æ„ï¼šjsonæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</strong></p>
<h2 id="å­—å…¸å’Œåˆ—è¡¨è½¬json">å­—å…¸å’Œåˆ—è¡¨è½¬JSONï¼š</h2>
<pre><code class="language-python">import json

books = [
    {
        'title': 'é’¢é“æ˜¯æ€æ ·ç»ƒæˆçš„',
        'price': 9.8
    },
    {
        'title': 'çº¢æ¥¼æ¢¦',
        'price': 9.9
    }
]

json_str = json.dumps(books,ensure_ascii=False)
print(json_str)
</code></pre>
<p>å› ä¸º<code>json</code>åœ¨<code>dump</code>çš„æ—¶å€™ï¼Œåªèƒ½å­˜æ”¾<code>ascii</code>çš„å­—ç¬¦ï¼Œå› æ­¤ä¼šå°†ä¸­æ–‡è¿›è¡Œè½¬ä¹‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>ensure_ascii=False</code>å…³é—­è¿™ä¸ªç‰¹æ€§ã€‚<br>
åœ¨<code>Python</code>ä¸­ã€‚åªæœ‰åŸºæœ¬æ•°æ®ç±»å‹æ‰èƒ½è½¬æ¢æˆ<code>JSON</code>æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ä¹Ÿå³ï¼š<code>int</code>ã€<code>float</code>ã€<code>str</code>ã€<code>list</code>ã€<code>dict</code>ã€<code>tuple</code>ã€‚</p>
<h3 id="å°†jsonæ•°æ®ç›´æ¥dumpåˆ°æ–‡ä»¶ä¸­">å°†jsonæ•°æ®ç›´æ¥<code>dump</code>åˆ°æ–‡ä»¶ä¸­ï¼š</h3>
<p><code>json</code>æ¨¡å—ä¸­é™¤äº†<code>dumps</code>å‡½æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>dump</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆï¼Œç›´æ¥å°†å­—ç¬¦ä¸²<code>dump</code>åˆ°æ–‡ä»¶ä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">books = [
    {
        'title': 'é’¢é“æ˜¯æ€æ ·ç»ƒæˆçš„',
        'price': 9.8
    },
    {
        'title': 'çº¢æ¥¼æ¢¦',
        'price': 9.9
    }
]
with open('a.json','w') as fp:
    json.dump(books,fp)
</code></pre>
<h2 id="å°†ä¸€ä¸ªjsonå­—ç¬¦ä¸²loadæˆpythonå¯¹è±¡">å°†ä¸€ä¸ªjsonå­—ç¬¦ä¸²loadæˆPythonå¯¹è±¡ï¼š</h2>
<pre><code class="language-python">json_str = '[{&quot;title&quot;: &quot;é’¢é“æ˜¯æ€æ ·ç»ƒæˆçš„&quot;, &quot;price&quot;: 9.8}, {&quot;title&quot;: &quot;çº¢æ¥¼æ¢¦&quot;, &quot;price&quot;: 9.9}]'
books = json.loads(json_str,encoding='utf-8')
print(type(books))
print(books)
</code></pre>
<h3 id="ç›´æ¥ä»æ–‡ä»¶ä¸­è¯»å–json">ç›´æ¥ä»æ–‡ä»¶ä¸­è¯»å–jsonï¼š</h3>
<pre><code class="language-python">import json
with open('a.json','r',encoding='utf-8') as fp:
    json_str = json.load(fp)
    print(json_str)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—]]></title>
        <id>https://hehelv.github.io//post/6-zheng-ze-biao-da-shi-he-re-mo-kuai</id>
        <link href="https://hehelv.github.io//post/6-zheng-ze-biao-da-shi-he-re-mo-kuai">
        </link>
        <updated>2020-02-28T06:37:22.000Z</updated>
        <content type="html"><![CDATA[<h1 id="6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—">6-æ­£åˆ™è¡¨è¾¾å¼å’Œreæ¨¡å—</h1>
<h2 id="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼">ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼š</h2>
<p>é€šä¿—ç†è§£ï¼šæŒ‰ç…§ä¸€å®šçš„è§„åˆ™ï¼Œä»æŸä¸ªå­—ç¬¦ä¸²ä¸­åŒ¹é…å‡ºæƒ³è¦çš„æ•°æ®ã€‚è¿™ä¸ªè§„åˆ™å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚<br>
æ ‡å‡†ç­”æ¡ˆï¼šhttps://baike.baidu.com/item/æ­£åˆ™è¡¨è¾¾å¼/1700215?fr=aladdin</p>
<h2 id="ä¸€ä¸ªæ®µå­">ä¸€ä¸ªæ®µå­ï¼š</h2>
<p>ä¸–ç•Œæ˜¯åˆ†ä¸ºä¸¤ç§äººï¼Œä¸€ç§æ˜¯æ‡‚æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œä¸€ç§æ˜¯ä¸æ‡‚æ­£åˆ™è¡¨è¾¾å¼çš„ã€‚</p>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨åŒ¹é…è§„åˆ™">æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨åŒ¹é…è§„åˆ™ï¼š</h2>
<h3 id="åŒ¹é…æŸä¸ªå­—ç¬¦ä¸²">åŒ¹é…æŸä¸ªå­—ç¬¦ä¸²ï¼š</h3>
<pre><code class="language-python">text = 'hello'
ret = re.match('he',text)
print(ret.group())
&gt;&gt; he
</code></pre>
<p>ä»¥ä¸Šä¾¿å¯ä»¥åœ¨<code>hello</code>ä¸­ï¼ŒåŒ¹é…å‡º<code>he</code>ã€‚</p>
<h3 id="ç‚¹åŒ¹é…ä»»æ„çš„å­—ç¬¦">ç‚¹ï¼ˆ.ï¼‰åŒ¹é…ä»»æ„çš„å­—ç¬¦ï¼š</h3>
<pre><code class="language-python">text = &quot;ab&quot;
ret = re.match('.',text)
print(ret.group())
&gt;&gt; a
</code></pre>
<p>ä½†æ˜¯ç‚¹ï¼ˆ.ï¼‰ä¸èƒ½åŒ¹é…ä¸åˆ°æ¢è¡Œç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;ab&quot;
ret = re.match('.',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="dåŒ¹é…ä»»æ„çš„æ•°å­—">\dåŒ¹é…ä»»æ„çš„æ•°å­—ï¼š</h3>
<pre><code class="language-python">text = &quot;123&quot;
ret = re.match('\d',text)
print(ret.group())
&gt;&gt; 1
</code></pre>
<h3 id="dåŒ¹é…ä»»æ„çš„éæ•°å­—">\DåŒ¹é…ä»»æ„çš„éæ•°å­—ï¼š</h3>
<pre><code class="language-python">text = &quot;a&quot;
ret = re.match('\D',text)
print(ret.group())
&gt;&gt; a
</code></pre>
<p>è€Œå¦‚æœtextæ˜¯ç­‰äºä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸æˆåŠŸäº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;1&quot;
ret = re.match('\D',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="såŒ¹é…çš„æ˜¯ç©ºç™½å­—ç¬¦åŒ…æ‹¬ntrå’Œç©ºæ ¼">\såŒ¹é…çš„æ˜¯ç©ºç™½å­—ç¬¦ï¼ˆåŒ…æ‹¬ï¼š\nï¼Œ\tï¼Œ\rå’Œç©ºæ ¼ï¼‰ï¼š</h3>
<pre><code class="language-python">text = &quot;\t&quot;
ret = re.match('\s',text)
print(ret.group())
&gt;&gt; ç©ºç™½
</code></pre>
<h3 id="wåŒ¹é…çš„æ˜¯a-zå’Œa-zä»¥åŠæ•°å­—å’Œä¸‹åˆ’çº¿">\wåŒ¹é…çš„æ˜¯<code>a-z</code>å’Œ<code>A-Z</code>ä»¥åŠæ•°å­—å’Œä¸‹åˆ’çº¿ï¼š</h3>
<pre><code class="language-python">text = &quot;_&quot;
ret = re.match('\w',text)
print(ret.group())
&gt;&gt; _
</code></pre>
<p>è€Œå¦‚æœè¦åŒ¹é…ä¸€ä¸ªå…¶ä»–çš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;+&quot;
ret = re.match('\w',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
<h3 id="wåŒ¹é…çš„æ˜¯å’Œwç›¸åçš„">\WåŒ¹é…çš„æ˜¯å’Œ\wç›¸åçš„ï¼š</h3>
<pre><code class="language-python">text = &quot;+&quot;
ret = re.match('\W',text)
print(ret.group())
&gt;&gt; +
</code></pre>
<p>è€Œå¦‚æœä½ çš„textæ˜¯ä¸€ä¸ªä¸‹åˆ’çº¿æˆ–è€…è‹±æ–‡å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;_&quot;
ret = re.match('\W',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
<h3 id="ç»„åˆçš„æ–¹å¼åªè¦æ»¡è¶³ä¸­æ‹¬å·ä¸­çš„æŸä¸€é¡¹éƒ½ç®—åŒ¹é…æˆåŠŸ">[]ç»„åˆçš„æ–¹å¼ï¼Œåªè¦æ»¡è¶³ä¸­æ‹¬å·ä¸­çš„æŸä¸€é¡¹éƒ½ç®—åŒ¹é…æˆåŠŸï¼š</h3>
<pre><code class="language-python">text = &quot;0731-88888888&quot;
ret = re.match('[\d\-]+',text)
print(ret.group())
&gt;&gt; 0731-88888888
</code></pre>
<p>ä¹‹å‰è®²åˆ°çš„å‡ ç§åŒ¹é…è§„åˆ™ï¼Œå…¶å®å¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·çš„å½¢å¼æ¥è¿›è¡Œæ›¿ä»£ï¼š</p>
<ul>
<li>\dï¼š[0-9]</li>
<li>\Dï¼š<a href="#fn_0-9">0-9</a></li>
<li>\wï¼š[0-9a-zA-Z_]</li>
<li>\Wï¼š[^0-9a-zA-Z_]</li>
</ul>
<h3 id="åŒ¹é…å¤šä¸ªå­—ç¬¦">åŒ¹é…å¤šä¸ªå­—ç¬¦ï¼š</h3>
<ol>
<li>
<p><code>*</code>ï¼šå¯ä»¥åŒ¹é…0æˆ–è€…ä»»æ„å¤šä¸ªå­—ç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;0731&quot;
 ret = re.match('\d*',text)
 print(ret.group())
 &gt;&gt; 0731
</code></pre>
<p>ä»¥ä¸Šå› ä¸ºåŒ¹é…çš„è¦æ±‚æ˜¯<code>\d</code>ï¼Œé‚£ä¹ˆå°±è¦æ±‚æ˜¯æ•°å­—ï¼Œåé¢è·Ÿäº†ä¸€ä¸ªæ˜Ÿå·ï¼Œå°±å¯ä»¥åŒ¹é…åˆ°0731è¿™å››ä¸ªå­—ç¬¦ã€‚</p>
</li>
<li>
<p><code>+</code>ï¼šå¯ä»¥åŒ¹é…1ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ã€‚æœ€å°‘ä¸€ä¸ªã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;abc&quot;
 ret = re.match('\w+',text)
 print(ret.group())
 &gt;&gt; abc
</code></pre>
<p>å› ä¸ºåŒ¹é…çš„æ˜¯<code>\w</code>ï¼Œé‚£ä¹ˆå°±è¦æ±‚æ˜¯è‹±æ–‡å­—ç¬¦ï¼Œåé¢è·Ÿäº†ä¸€ä¸ªåŠ å·ï¼Œæ„å‘³ç€æœ€å°‘è¦æœ‰ä¸€ä¸ªæ»¡è¶³<code>\w</code>çš„å­—ç¬¦æ‰èƒ½å¤ŸåŒ¹é…åˆ°ã€‚å¦‚æœtextæ˜¯ä¸€ä¸ªç©ºç™½å­—ç¬¦æˆ–è€…æ˜¯ä¸€ä¸ªä¸æ»¡è¶³\wçš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;&quot;
 ret = re.match('\w+',text)
 print(ret.group())
 &gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
</li>
<li>
<p><code>?</code>ï¼šåŒ¹é…çš„å­—ç¬¦å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…ä¸å‡ºç°ï¼ˆ0æˆ–è€…1ï¼‰ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d?',text)
 print(ret.group())
 &gt;&gt; 1
</code></pre>
</li>
<li>
<p><code>{m}</code>ï¼šåŒ¹é…mä¸ªå­—ç¬¦ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d{2}',text)
 print(ret.group())
 &gt;&gt; 12
</code></pre>
</li>
<li>
<p><code>{m,n}</code>ï¼šåŒ¹é…m-nä¸ªå­—ç¬¦ã€‚åœ¨è¿™ä¸­é—´çš„å­—ç¬¦éƒ½å¯ä»¥åŒ¹é…åˆ°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;123&quot;
 ret = re.match('\d{1,2}',text)
 prit(ret.group())
 &gt;&gt; 12
</code></pre>
<p>å¦‚æœtextåªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥åŒ¹é…å‡ºæ¥ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;1&quot;
 ret = re.match('\d{1,2}',text)
 prit(ret.group())
 &gt;&gt; 1
</code></pre>
</li>
</ol>
<h3 id="å°æ¡ˆä¾‹">å°æ¡ˆä¾‹ï¼š</h3>
<ol>
<li>
<p>éªŒè¯æ‰‹æœºå·ç ï¼šæ‰‹æœºå·ç çš„è§„åˆ™æ˜¯ä»¥<code>1</code>å¼€å¤´ï¼Œç¬¬äºŒä½å¯ä»¥æ˜¯<code>34587</code>ï¼Œåé¢é‚£9ä½å°±å¯ä»¥éšæ„äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;18570631587&quot;
 ret = re.match('1[34587]\d{9}',text)
 print(ret.group())
 &gt;&gt; 18570631587
</code></pre>
<p>è€Œå¦‚æœæ˜¯ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„æ‰‹æœºå·ç ã€‚é‚£ä¹ˆå°±åŒ¹é…ä¸åˆ°äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;1857063158&quot;
 ret = re.match('1[34587]\d{9}',text)
 print(ret.group())
 &gt;&gt; AttributeError: 'NoneType' object has no attribute
</code></pre>
</li>
<li>
<p>éªŒè¯é‚®ç®±ï¼šé‚®ç®±çš„è§„åˆ™æ˜¯é‚®ç®±åç§°æ˜¯ç”¨<code>æ•°å­—ã€æ•°å­—ã€ä¸‹åˆ’çº¿</code>ç»„æˆçš„ï¼Œç„¶åæ˜¯<code>@</code>ç¬¦å·ï¼Œåé¢å°±æ˜¯åŸŸåäº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;hynever@163.com&quot;
 ret = re.match('\w+@\w+\.[a-zA-Z\.]+',text)
 print(ret.group())
</code></pre>
</li>
<li>
<p>éªŒè¯URLï¼šURLçš„è§„åˆ™æ˜¯å‰é¢æ˜¯<code>http</code>æˆ–è€…<code>https</code>æˆ–è€…æ˜¯<code>ftp</code>ç„¶åå†åŠ ä¸Šä¸€ä¸ªå†’å·ï¼Œå†åŠ ä¸Šä¸€ä¸ªæ–œæ ï¼Œå†åé¢å°±æ˜¯å¯ä»¥å‡ºç°ä»»æ„éç©ºç™½å­—ç¬¦äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;http://www.baidu.com/&quot;
 ret = re.match('(http|https|ftp)://[^\s]+',text)
 print(ret.group())
</code></pre>
</li>
<li>
<p>éªŒè¯èº«ä»½è¯ï¼šèº«ä»½è¯çš„è§„åˆ™æ˜¯ï¼Œæ€»å…±æœ‰18ä½ï¼Œå‰é¢17ä½éƒ½æ˜¯æ•°å­—ï¼Œåé¢ä¸€ä½å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯å°å†™çš„xï¼Œä¹Ÿå¯ä»¥æ˜¯å¤§å†™çš„Xã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python"> text = &quot;3113111890812323X&quot;
 ret = re.match('\d{17}[\dxX]',text)
 print(ret.group())
</code></pre>
</li>
</ol>
<h3 id="è„±å­—å·è¡¨ç¤ºä»¥å¼€å§‹">^ï¼ˆè„±å­—å·ï¼‰ï¼šè¡¨ç¤ºä»¥...å¼€å§‹ï¼š</h3>
<pre><code class="language-python">text = &quot;hello&quot;
ret = re.match('^h',text)
print(ret.group())
</code></pre>
<p>å¦‚æœæ˜¯åœ¨ä¸­æ‹¬å·ä¸­ï¼Œé‚£ä¹ˆä»£è¡¨çš„æ˜¯å–åæ“ä½œ.</p>
<h3 id="è¡¨ç¤ºä»¥ç»“æŸ">$ï¼šè¡¨ç¤ºä»¥...ç»“æŸï¼š</h3>
<pre><code class="language-python"># åŒ¹é…163.comçš„é‚®ç®±
text = &quot;xxx@163.com&quot;
ret = re.search('\w+@163\.com$',text)
print(ret.group())
&gt;&gt; xxx@163.com
</code></pre>
<h3 id="åŒ¹é…å¤šä¸ªè¡¨è¾¾å¼æˆ–è€…å­—ç¬¦ä¸²">|ï¼šåŒ¹é…å¤šä¸ªè¡¨è¾¾å¼æˆ–è€…å­—ç¬¦ä¸²ï¼š</h3>
<pre><code class="language-python">text = &quot;hello|world&quot;
ret = re.search('hello',text)
print(ret.group())
&gt;&gt; hello
</code></pre>
<h3 id="è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼">è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼ï¼š</h3>
<p>è´ªå©ªæ¨¡å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…å°½é‡å¤šçš„å­—ç¬¦ã€‚é»˜è®¤æ˜¯è´ªå©ªæ¨¡å¼ã€‚<br>
éè´ªå©ªæ¨¡å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¼šå°½é‡å°‘çš„åŒ¹é…å­—ç¬¦ã€‚<br>
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;0123456&quot;
ret = re.match('\d+',text)
print(ret.group())
# å› ä¸ºé»˜è®¤é‡‡ç”¨è´ªå©ªæ¨¡å¼ï¼Œæ‰€ä»¥ä¼šè¾“å‡º0123456
&gt;&gt; 0123456
</code></pre>
<p>å¯ä»¥æ”¹æˆéè´ªå©ªæ¨¡å¼ï¼Œé‚£ä¹ˆå°±åªä¼šåŒ¹é…åˆ°0ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;0123456&quot;
ret = re.match('\d+?',text)
print(ret.group())
</code></pre>
<h3 id="æ¡ˆä¾‹åŒ¹é…0-100ä¹‹é—´çš„æ•°å­—">æ¡ˆä¾‹ï¼šåŒ¹é…<code>0-100</code>ä¹‹é—´çš„æ•°å­—ï¼š</h3>
<pre><code class="language-python">text = '99'
ret = re.match('[1-9]?\d$|100$',text)
print(ret.group())
&gt;&gt; 99
</code></pre>
<p>è€Œå¦‚æœ<code>text=101</code>ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = '101'
ret = re.match('[1-9]?\d$|100$',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<h3 id="è½¬ä¹‰å­—ç¬¦å’ŒåŸç”Ÿå­—ç¬¦ä¸²">è½¬ä¹‰å­—ç¬¦å’ŒåŸç”Ÿå­—ç¬¦ä¸²ï¼š</h3>
<p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œæœ‰äº›å­—ç¬¦æ˜¯æœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦ã€‚å› æ­¤å¦‚æœæƒ³è¦åŒ¹é…è¿™äº›å­—ç¬¦ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ã€‚æ¯”å¦‚<code>$</code>ä»£è¡¨çš„æ˜¯ä»¥...ç»“å°¾ï¼Œå¦‚æœæƒ³è¦åŒ¹é…<code>$</code>ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨<code>\$</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;apple price is \$99,orange paice is $88&quot;
ret = re.search('\$(\d+)',text)
print(ret.group())
&gt;&gt; $99
</code></pre>
<p>åŸç”Ÿå­—ç¬¦ä¸²ï¼š<br>
åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ<code>\</code>æ˜¯ä¸“é—¨ç”¨æ¥åšè½¬ä¹‰çš„ã€‚åœ¨Pythonä¸­<code>\</code>ä¹Ÿæ˜¯ç”¨æ¥åšè½¬ä¹‰çš„ã€‚å› æ­¤å¦‚æœæƒ³è¦åœ¨æ™®é€šçš„å­—ç¬¦ä¸²ä¸­åŒ¹é…å‡º<code>\</code>ï¼Œé‚£ä¹ˆè¦ç»™å‡ºå››ä¸ª<code>\</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;apple \c&quot;
ret = re.search('\\\\c',text)
print(ret.group())
</code></pre>
<p>å› æ­¤è¦ä½¿ç”¨åŸç”Ÿå­—ç¬¦ä¸²å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="language-python">text = &quot;apple \c&quot;
ret = re.search(r'\\c',text)
print(ret.group())
</code></pre>
<hr>
<h2 id="reæ¨¡å—ä¸­å¸¸ç”¨å‡½æ•°">reæ¨¡å—ä¸­å¸¸ç”¨å‡½æ•°ï¼š</h2>
<h3 id="match">matchï¼š</h3>
<p>ä»å¼€å§‹çš„ä½ç½®è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœå¼€å§‹çš„ä½ç½®æ²¡æœ‰åŒ¹é…åˆ°ã€‚å°±ç›´æ¥å¤±è´¥äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = 'hello'
ret = re.match('h',text)
print(ret.group())
&gt;&gt; h
</code></pre>
<p>å¦‚æœç¬¬ä¸€ä¸ªå­—æ¯ä¸æ˜¯<code>h</code>ï¼Œé‚£ä¹ˆå°±ä¼šå¤±è´¥ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = 'ahello'
ret = re.match('h',text)
print(ret.group())
&gt;&gt; AttributeError: 'NoneType' object has no attribute 'group'
</code></pre>
<p>å¦‚æœæƒ³è¦åŒ¹é…æ¢è¡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆå°±è¦ä¼ å…¥ä¸€ä¸ª<code>flag=re.DOTALL</code>ï¼Œå°±å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;abc\nabc&quot;
ret = re.match('abc.*abc',text,re.DOTALL)
print(ret.group())
</code></pre>
<h3 id="search">searchï¼š</h3>
<p>åœ¨å­—ç¬¦ä¸²ä¸­æ‰¾æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚å¦‚æœæ‰¾åˆ°ï¼Œå°±è¿”å›ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯åªä¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.search('\d+',text)
print(ret.group())
&gt;&gt; 99
</code></pre>
<h3 id="åˆ†ç»„">åˆ†ç»„ï¼š</h3>
<p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå¯ä»¥å¯¹è¿‡æ»¤åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œåˆ†ç»„ã€‚åˆ†ç»„ä½¿ç”¨åœ†æ‹¬å·çš„æ–¹å¼ã€‚</p>
<ol>
<li><code>group</code>ï¼šå’Œ<code>group(0)</code>æ˜¯ç­‰ä»·çš„ï¼Œè¿”å›çš„æ˜¯æ•´ä¸ªæ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ã€‚</li>
<li><code>groups</code>ï¼šè¿”å›çš„æ˜¯é‡Œé¢çš„å­ç»„ã€‚ç´¢å¼•ä»1å¼€å§‹ã€‚</li>
<li><code>group(1)</code>ï¼šè¿”å›çš„æ˜¯ç¬¬ä¸€ä¸ªå­ç»„ï¼Œå¯ä»¥ä¼ å…¥å¤šä¸ªã€‚<br>
ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-python">text = &quot;apple price is $99,orange price is $10&quot;
ret = re.search(r&quot;.*(\$\d+).*(\$\d+)&quot;,text)
print(ret.group())
print(ret.group(0))
print(ret.group(1))
print(ret.group(2))
print(ret.groups())
</code></pre>
<h3 id="findall">findallï¼š</h3>
<p>æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.findall('\d+',text)
print(ret)
&gt;&gt; ['99', '88']
</code></pre>
<h3 id="sub">subï¼š</h3>
<p>ç”¨æ¥æ›¿æ¢å­—ç¬¦ä¸²ã€‚å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºå…¶ä»–å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-python">text = 'apple price $99 orange price $88'
ret = re.sub('\d+','0',text)
print(ret)
&gt;&gt; apple price $0 orange price $0
</code></pre>
<p><code>sub</code>å‡½æ•°çš„æ¡ˆä¾‹ï¼Œè·å–æ‹‰å‹¾ç½‘ä¸­çš„æ•°æ®ï¼š</p>
<pre><code class="language-python">html = &quot;&quot;&quot;
&lt;div&gt;
&lt;p&gt;åŸºæœ¬è¦æ±‚ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç²¾é€šHTML5ã€CSS3ã€ JavaScriptç­‰Webå‰ç«¯å¼€å‘æŠ€æœ¯ï¼Œå¯¹html5é¡µé¢é€‚é…å……åˆ†äº†è§£ï¼Œç†Ÿæ‚‰ä¸åŒæµè§ˆå™¨é—´çš„å·®å¼‚ï¼Œç†Ÿç»ƒå†™å‡ºå…¼å®¹å„ç§æµè§ˆå™¨çš„ä»£ç ï¼›&lt;/p&gt;
&lt;p&gt;2ã€ç†Ÿæ‚‰è¿ç”¨å¸¸è§JSå¼€å‘æ¡†æ¶ï¼Œå¦‚JQueryã€vueã€angularï¼Œèƒ½å¿«é€Ÿé«˜æ•ˆå®ç°å„ç§äº¤äº’æ•ˆæœï¼›&lt;/p&gt;
&lt;p&gt;3ã€ç†Ÿæ‚‰ç¼–å†™èƒ½å¤Ÿè‡ªåŠ¨é€‚åº”HTML5ç•Œé¢ï¼Œèƒ½è®©ç½‘é¡µæ ¼å¼è‡ªåŠ¨é€‚åº”å„æ¬¾å„å¤§å°çš„æ‰‹æœºï¼›&lt;/p&gt;
&lt;p&gt;4ã€åˆ©ç”¨HTML5ç›¸å…³æŠ€æœ¯å¼€å‘ç§»åŠ¨å¹³å°ã€PCç»ˆç«¯çš„å‰ç«¯é¡µé¢ï¼Œå®ç°HTML5æ¨¡æ¿åŒ–ï¼›&lt;/p&gt;
&lt;p&gt;5ã€ç†Ÿæ‚‰æ‰‹æœºç«¯å’ŒPCç«¯webå®ç°çš„å·®å¼‚ï¼Œæœ‰ç§»åŠ¨å¹³å°webå‰ç«¯å¼€å‘ç»éªŒï¼Œäº†è§£ç§»åŠ¨äº’è”ç½‘äº§å“å’Œè¡Œä¸šï¼Œæœ‰åœ¨Android,iOSç­‰å¹³å°ä¸‹HTML5+CSS+JavaScriptï¼ˆæˆ–ç§»åŠ¨JSæ¡†æ¶ï¼‰å¼€å‘ç»éªŒè€…ä¼˜å…ˆè€ƒè™‘ï¼›6ã€è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåä½œç²¾ç¥ï¼Œå¯¹ç§»åŠ¨äº’è”ç½‘è¡Œä¸šæœ‰æµ“åšå…´è¶£ï¼Œæœ‰è¾ƒå¼ºçš„ç ”ç©¶èƒ½åŠ›å’Œå­¦ä¹ èƒ½åŠ›ï¼›&lt;/p&gt;
&lt;p&gt;7ã€èƒ½å¤Ÿæ‰¿æ‹…å…¬å¸å‰ç«¯åŸ¹è®­å·¥ä½œï¼Œå¯¹å…¬å¸å„ä¸šåŠ¡çº¿çš„å‰ç«¯ï¼ˆHTML5\CSS3ï¼‰å·¥ä½œè¿›è¡Œæ”¯æ’‘å’ŒæŒ‡å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;å²—ä½èŒè´£ï¼š&lt;/p&gt;
&lt;p&gt;1ã€åˆ©ç”¨html5åŠç›¸å…³æŠ€æœ¯å¼€å‘ç§»åŠ¨å¹³å°ã€å¾®ä¿¡ã€APPç­‰å‰ç«¯é¡µé¢ï¼Œå„ç±»äº¤äº’çš„å®ç°ï¼›&lt;/p&gt;
&lt;p&gt;2ã€æŒç»­çš„ä¼˜åŒ–å‰ç«¯ä½“éªŒå’Œé¡µé¢å“åº”é€Ÿåº¦ï¼Œå¹¶ä¿è¯å…¼å®¹æ€§å’Œæ‰§è¡Œæ•ˆç‡ï¼›&lt;/p&gt;
&lt;p&gt;3ã€æ ¹æ®äº§å“éœ€æ±‚ï¼Œåˆ†æå¹¶ç»™å‡ºæœ€ä¼˜çš„é¡µé¢å‰ç«¯ç»“æ„è§£å†³æ–¹æ¡ˆï¼›&lt;/p&gt;
&lt;p&gt;4ã€ååŠ©åå°åŠå®¢æˆ·ç«¯å¼€å‘äººå‘˜å®ŒæˆåŠŸèƒ½å¼€å‘å’Œè°ƒè¯•ï¼›&lt;/p&gt;
&lt;p&gt;5ã€ç§»åŠ¨ç«¯ä¸»æµæµè§ˆå™¨çš„é€‚é…ã€ç§»åŠ¨ç«¯ç•Œé¢è‡ªé€‚åº”ç ”å‘ã€‚&lt;/p&gt;
&lt;/div&gt;
&quot;&quot;&quot;

ret = re.sub('&lt;/?[a-zA-Z0-9]+&gt;',&quot;&quot;,html)
print(ret)
</code></pre>
<h3 id="split">splitï¼š</h3>
<p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ†å‰²å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-python">text = &quot;hello world ni hao&quot;
ret = re.split('\W',text)
print(ret)
&gt;&gt; [&quot;hello&quot;,&quot;world&quot;,&quot;ni&quot;,&quot;hao&quot;]
</code></pre>
<h3 id="compile">compileï¼š</h3>
<p>å¯¹äºä¸€äº›ç»å¸¸è¦ç”¨åˆ°çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>compile</code>è¿›è¡Œç¼–è¯‘ï¼ŒåæœŸå†ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥æ‹¿è¿‡æ¥ç”¨ï¼Œæ‰§è¡Œæ•ˆç‡ä¼šæ›´å¿«ã€‚è€Œä¸”<code>compile</code>è¿˜å¯ä»¥æŒ‡å®š<code>flag=re.VERBOSE</code>ï¼Œåœ¨å†™æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™å¯ä»¥åšå¥½æ³¨é‡Šã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">text = &quot;the number is 20.50&quot;
r = re.compile(r&quot;&quot;&quot;
                \d+ # å°æ•°ç‚¹å‰é¢çš„æ•°å­—
                \.? # å°æ•°ç‚¹
                \d* # å°æ•°ç‚¹åé¢çš„æ•°å­—
                &quot;&quot;&quot;,re.VERBOSE)
ret = re.search(r,text)
print(ret.group())
</code></pre>
]]></content>
    </entry>
</feed>