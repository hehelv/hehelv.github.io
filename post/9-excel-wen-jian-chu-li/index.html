<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ğŸ’¤ISpiker
</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta name="author" content="ğŸ’¤ISpiker">
<meta name="description" content="The proof is in the pudding.">
<meta name="keywords" content="The proof is in the pudding.">
<link rel="stylesheet" href="https://hehelv.github.io//media/css/main.css" />
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
<script src="https://hehelv.github.io//media/script/tocbot.min.js"></script>
<script src="https://hehelv.github.io//media/script/script.js"></script>
<!--<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/default.min.css">
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>-->
<script src="https://cdn.bootcss.com/highlight.js/9.13.1/highlight.min.js"></script>
<link href="https://cdn.bootcss.com/highlight.js/9.13.1/styles/atelier-estuary-dark.min.css" rel="stylesheet">
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://hehelv.github.io/">
                    ğŸ’¤ISpiker
                </a>
            </div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        Home
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        Archives
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        Tags
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        About
                    </a>
                    
                    <a class="menu-item" href="/tag/algorithm">
                        Algorithm
                    </a>
                    
                    <a class="menu-item" href="/tag/networking">
                        Computer Networking
                    </a>
                    
                    <a class="menu-item" href="/tag/Spider Note">
                        Spider Note
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://hehelv.github.io/">
                            ğŸ’¤ISpiker
                        </a>
                        <a id="mobile-toggle-theme">&nbsp;Light</a>
                    </div>
                    <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            Home
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            Archives
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            Tags
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            About
                        </a>
                        
                        <a class="menu-item" href="/tag/algorithm">
                            Algorithm
                        </a>
                        
                        <a class="menu-item" href="/tag/networking">
                            Computer Networking
                        </a>
                        
                        <a class="menu-item" href="/tag/Spider Note">
                            Spider Note
                        </a>
                        
                </div>
            </div>
        </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                9-excelæ–‡ä»¶å¤„ç†
                            </h1>
                            <div class="post-meta">
                                Author:
                                <a itemprop="author" rel="author" href="/">
                                    ğŸ’¤ISpiker
                                </a>
                                <span class="post-time">
                                Date: <a href="#">2020-03-02</a>
                            </span>
                                
                                    <span class="post-category">
                                Category:
                                
                                <a href="https://hehelv.github.io//tag/Spider Note">Pythonçˆ¬è™«ç¬”è®°</a>
                                
                            </span>
                                    
                            </div>
                        </header>

                        <div class="post-content">
                            <h1 id="9-excelæ–‡ä»¶å¤„ç†">9-excelæ–‡ä»¶å¤„ç†</h1>
<h2 id="å®‰è£…ç¯å¢ƒ">å®‰è£…ç¯å¢ƒ</h2>
<ol>
<li>
<p>pandasä¾èµ–å¤„ç†Excelçš„xlrdæ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰å®‰è£…è¿™ä¸ªï¼Œå®‰è£…å‘½ä»¤æ˜¯ï¼špip install xlrd</p>
</li>
<li>
<p>å®‰è£…pandasæ¨¡å—è¿˜éœ€è¦ä¸€å®šçš„ç¼–ç ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±åœ¨å®‰è£…çš„æ—¶å€™ï¼Œç¡®ä¿ä½ çš„ç”µè„‘æœ‰è¿™äº›ç¯å¢ƒï¼šNet.4 ã€VC-Compilerä»¥åŠwinsdk_webï¼Œå¦‚æœå¤§å®¶æ²¡æœ‰è¿™äº›è½¯ä»¶~å¯ä»¥å’¨è¯¢æˆ‘ä»¬çš„è¾…å¯¼å‘˜ç´¢è¦ç›¸å…³å®‰è£…å·¥å…·ã€‚</p>
</li>
<li>
<p>æ­¥éª¤1å’Œ2 å‡†å¤‡å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®‰è£…pandasäº†ï¼Œå®‰è£…å‘½ä»¤æ˜¯ï¼špip install pandas</p>
</li>
</ol>
<h2 id="pandasæ“ä½œexcelè¡¨å•">pandasæ“ä½œExcelè¡¨å•</h2>
<p>æ•°æ®å‡†å¤‡ï¼Œæœ‰ä¸€ä¸ªExcelæ–‡ä»¶ï¼šlemon.xlsxæœ‰ä¸¤ä¸ªè¡¨å•ï¼Œè¡¨å•ååˆ†åˆ«ä¸ºï¼šPython ä»¥åŠstudentï¼Œ</p>
<p>Pythonçš„è¡¨å•æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="1"><img src="../images/pandas-01.png" alt=""></figure>
<p>studentçš„è¡¨å•æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="2"><img src="../images/pandas-02.png" alt=""></figure>
<p>1ï¼šåœ¨åˆ©ç”¨pandasæ¨¡å—è¿›è¡Œæ“ä½œå‰ï¼Œå¯ä»¥å…ˆå¼•å…¥è¿™ä¸ªæ¨¡å—ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>import  pandas  as pd
</code></pre>
<p>2:è¯»å–Excelæ–‡ä»¶çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<pre><code class="language-sheel">#æ–¹æ³•ä¸€ï¼šé»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªè¡¨å•df=pd.read_excel('lemon.xlsx')#è¿™ä¸ªä¼šç›´æ¥é»˜è®¤è¯»å–åˆ°è¿™ä¸ªExcelçš„ç¬¬ä¸€ä¸ªè¡¨å•
data=df.head()#é»˜è®¤è¯»å–å‰5è¡Œçš„æ•°æ®
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure data-type="image" tabindex="3"><img src="../images/pandas-03.png" alt=""></figure>
<pre><code class="language-sheel">#æ–¹æ³•äºŒï¼šé€šè¿‡æŒ‡å®šè¡¨å•åçš„æ–¹å¼æ¥è¯»å–
df=pd.read_excel('lemon.xlsx',sheet_name='student')#å¯ä»¥é€šè¿‡sheet_nameæ¥æŒ‡å®šè¯»å–çš„è¡¨å•
data=df.head()#é»˜è®¤è¯»å–å‰5è¡Œçš„æ•°æ®
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œä¹Ÿæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼š<br>
<img src="../images/pandas-04.png" alt=""></p>
<pre><code class="language-shell">#æ–¹æ³•ä¸‰ï¼šé€šè¿‡è¡¨å•ç´¢å¼•æ¥æŒ‡å®šè¦è®¿é—®çš„è¡¨å•ï¼Œ0è¡¨ç¤ºç¬¬ä¸€ä¸ªè¡¨å•
#ä¹Ÿå¯ä»¥é‡‡ç”¨è¡¨å•åå’Œç´¢å¼•çš„åŒé‡æ–¹å¼æ¥å®šä½è¡¨å•
#ä¹Ÿå¯ä»¥åŒæ—¶å®šä½å¤šä¸ªè¡¨å•ï¼Œæ–¹å¼éƒ½ç½—åˆ—å¦‚ä¸‹æ‰€ç¤º
df=pd.read_excel('lemon.xlsx',sheet_name=['python','student'])#å¯ä»¥é€šè¿‡è¡¨å•ååŒæ—¶æŒ‡å®šå¤šä¸ª
# df=pd.read_excel('lemon.xlsx',sheet_name=0)#å¯ä»¥é€šè¿‡è¡¨å•ç´¢å¼•æ¥æŒ‡å®šè¯»å–çš„è¡¨å•
# df=pd.read_excel('lemon.xlsx',sheet_name=['python',1])#å¯ä»¥æ··åˆçš„æ–¹å¼æ¥æŒ‡å®š
# df=pd.read_excel('lemon.xlsx',sheet_name=[1,2])#å¯ä»¥é€šè¿‡ç´¢å¼• åŒæ—¶æŒ‡å®šå¤šä¸ª
data=df.values#è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œæ³¨æ„è¿™é‡Œä¸èƒ½ç”¨head()æ–¹æ³•å“¦~
print(&quot;è·å–åˆ°æ‰€æœ‰çš„å€¼:\n{0}&quot;.format(data))#æ ¼å¼åŒ–è¾“å‡º
</code></pre>
<h2 id="pandasæ“ä½œexcelçš„è¡Œåˆ—">pandasæ“ä½œExcelçš„è¡Œåˆ—</h2>
<p><strong>1ï¼šè¯»å–æŒ‡å®šçš„å•è¡Œï¼Œæ•°æ®ä¼šå­˜åœ¨åˆ—è¡¨é‡Œé¢</strong></p>
<pre><code>#1ï¼šè¯»å–æŒ‡å®šè¡Œdf=pd.read_excel('lemon.xlsx')#è¿™ä¸ªä¼šç›´æ¥é»˜è®¤è¯»å–åˆ°è¿™ä¸ªExcelçš„ç¬¬ä¸€ä¸ªè¡¨å•
data=df.ix[0].values#0è¡¨ç¤ºç¬¬ä¸€è¡Œ è¿™é‡Œè¯»å–æ•°æ®å¹¶ä¸åŒ…å«è¡¨å¤´ï¼Œè¦æ³¨æ„å“¦ï¼
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤º:</p>
<figure data-type="image" tabindex="4"><img src="../images/pandas-05.png" alt=""></figure>
<p><strong>2ï¼šè¯»å–æŒ‡å®šçš„å¤šè¡Œï¼Œæ•°æ®ä¼šå­˜åœ¨åµŒå¥—çš„åˆ—è¡¨é‡Œé¢ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[[1,2]].values#è¯»å–æŒ‡å®šå¤šè¡Œçš„è¯ï¼Œå°±è¦åœ¨ix[]é‡Œé¢åµŒå¥—åˆ—è¡¨æŒ‡å®šè¡Œæ•°
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>3ï¼šè¯»å–æŒ‡å®šçš„è¡Œåˆ—ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[1,2]#è¯»å–ç¬¬ä¸€è¡Œç¬¬äºŒåˆ—çš„å€¼ï¼Œè¿™é‡Œä¸éœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>4ï¼šè¯»å–æŒ‡å®šçš„å¤šè¡Œå¤šåˆ—å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[[1,2],['title','data']].values#è¯»å–ç¬¬ä¸€è¡Œç¬¬äºŒè¡Œçš„titleä»¥åŠdataåˆ—çš„å€¼ï¼Œè¿™é‡Œéœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>5ï¼šè·å–æ‰€æœ‰è¡Œçš„æŒ‡å®šåˆ—</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
data=df.ix[:,['title','data']].values#è¯»æ‰€æœ‰è¡Œçš„titleä»¥åŠdataåˆ—çš„å€¼ï¼Œè¿™é‡Œéœ€è¦åµŒå¥—åˆ—è¡¨
print(&quot;è¯»å–æŒ‡å®šè¡Œçš„æ•°æ®ï¼š\n{0}&quot;.format(data))
</code></pre>
<p><strong>6ï¼šè·å–è¡Œå·å¹¶æ‰“å°è¾“å‡º</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºè¡Œå·åˆ—è¡¨&quot;,df.index.values)

è¾“å‡ºç»“æœæ˜¯ï¼š
è¾“å‡ºè¡Œå·åˆ—è¡¨ [0 1 2 3]
</code></pre>
<p><strong>7ï¼šè·å–åˆ—åå¹¶æ‰“å°è¾“å‡º</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºåˆ—æ ‡é¢˜&quot;,df.columns.values)

è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
è¾“å‡ºåˆ—æ ‡é¢˜ ['case_id' 'title' 'data']
</code></pre>
<p><strong>8ï¼šè·å–æŒ‡å®šè¡Œæ•°çš„å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºå€¼&quot;,df.sample(3).values)#è¿™ä¸ªæ–¹æ³•ç±»ä¼¼äºhead()æ–¹æ³•ä»¥åŠdf.valuesæ–¹æ³•

è¾“å‡ºå€¼
 [[2 'è¾“å…¥é”™è¯¯çš„å¯†ç ' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;12345678&quot;}']
 [3 'æ­£å¸¸å……å€¼' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;1000&quot;}']
 [1 'æ­£å¸¸ç™»å½•' '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;123456&quot;}']]
</code></pre>
<p><strong>9ï¼šè·å–æŒ‡å®šåˆ—çš„å€¼ï¼š</strong></p>
<pre><code>df=pd.read_excel('lemon.xlsx')
print(&quot;è¾“å‡ºå€¼\n&quot;,df['data'].values)
</code></pre>
<h2 id="pandaså¤„ç†excelæ•°æ®æˆä¸ºå­—å…¸">pandaså¤„ç†Excelæ•°æ®æˆä¸ºå­—å…¸</h2>
<p>æœ‰å¦‚ä¸‹çš„æ•°æ®ï¼Œå¤„ç†æˆåˆ—è¡¨åµŒå¥—å­—å…¸ï¼Œä¸”å­—å…¸çš„keyä¸ºè¡¨å¤´åã€‚</p>
<h2 id=""><img src="../images/pandas-06.png" alt=""></h2>
<p>å®ç°çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>df=pd.read_excel('lemon.xlsx')
test_data=[]
for i in df.index.values:#è·å–è¡Œå·çš„ç´¢å¼•ï¼Œå¹¶å¯¹å…¶è¿›è¡Œéå†ï¼š
    #æ ¹æ®iæ¥è·å–æ¯ä¸€è¡ŒæŒ‡å®šçš„æ•°æ® å¹¶åˆ©ç”¨to_dictè½¬æˆå­—å…¸
    row_data=df.ix[i,['case_id','module','title','http_method','url','data','expected']].to_dict()
    test_data.append(row_data)
print(&quot;æœ€ç»ˆè·å–åˆ°çš„æ•°æ®æ˜¯ï¼š{0}&quot;.format(test_data))
</code></pre>
<p>æœ€åå¾—åˆ°çš„ç»“æœæ˜¯ï¼š</p>
<pre><code>æœ€ç»ˆè·å–åˆ°çš„æ•°æ®æ˜¯ï¼š
[{'title': 'æ­£å¸¸ç™»å½•', 'case_id': 1, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;123456&quot;}'}, 
{'title': 'è¾“å…¥é”™è¯¯çš„å¯†ç ', 'case_id': 2, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;pwd&quot;:&quot;12345678&quot;}'}, 
{'title': 'æ­£å¸¸å……å€¼', 'case_id': 3, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;1000&quot;}'}, 
{'title': 'å……å€¼è¾“å…¥è´Ÿæ•°', 'case_id': 4, 'data': '{&quot;mobilephone&quot;:&quot;18688773467&quot;,&quot;amount&quot;:&quot;-100&quot;}'}]
</code></pre>

                        </div>
                        <section class="post-copyright">

                            <p class="copyright-item">
                                <span>Author:</span>
                                <span>ğŸ’¤ISpiker</span>
                            </p>

                            <p class="copyright-item">
                                <span>Permalink:</span>
                                <span><a href="https://hehelv.github.io//post/9-excel-wen-jian-chu-li">https://hehelv.github.io//post/9-excel-wen-jian-chu-li</a></span>
                            </p>

                            <p class="copyright-item">
                                <span>License:</span>
                                <span>MIT License</span>
                            </p>

                        </section>
                        <section class="post-tags">
                            <div>
                                <span>Tag(s):</span>
                                <span class="tag">
                                
                                
                                <a href="https://hehelv.github.io//tag/Spider Note"># Pythonçˆ¬è™«ç¬”è®°</a>
                                
                                
                            </span>
                            </div>
                            <div>
                                <a href="javascript:window.history.back();">back</a>
                                <span>Â·</span>
                                <a href="#">home</a>
                            </div>
                        </section>
                        <section class="post-nav">
                            
                                <a class="prev" rel="prev" href="https://hehelv.github.io//post/10-mysql-shu-ju-ku">
                                    10-MySQLæ•°æ®åº“
                                </a>
                                
                                    
                                        <a class="next" rel="next" href="https://hehelv.github.io//post/8-csv-wen-jian-chu-li">
                                            8-csvæ–‡ä»¶å¤„ç†
                                        </a>
                                        
                        </section>

                    </article>
                </div>
                
            </div>
    </div>
    </div>

    </div>
    <footer id="footer" class="footer">
    <div class="copyright">
        

            <script>
                var xhr = new XMLHttpRequest();
                xhr.open('get', 'https://v1.hitokoto.cn');
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        var data = JSON.parse(xhr.responseText);
                        var hitokoto = document.getElementById('hitokoto');
                        hitokoto.innerText = data.hitokoto;
                    }
                }
                xhr.send();
                (function() {
                    var bp = document.createElement('script');
                    var curProtocol = window.location.protocol.split(':')[0];
                    if (curProtocol === 'https') {
                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                    } else {
                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                    }
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(bp, s);
                })();
            </script>
            <b id="hitokoto"></b><br>
            <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face"><path d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z" fill="#93b5cf"></path></svg>
            <script>
                var date = new Date();
                document.write(" " + date.getFullYear() + "å¹´" + (date.getMonth() + 1) + "æœˆ" + date.getDate() + "æ—¥" + " æ˜ŸæœŸ" + "æ—¥ä¸€äºŒä¸‰å››äº”å…­".charAt(date.getDay()));
            </script> Copyright&copy;
            ğŸ’¤ISpiker | Powered by <a href="https://coding.net" target="_blank">Coding.net</a>

    </div>
</footer>
<script>
    hljs.initHighlighting();
</script>
        </div>
</body>

</html>