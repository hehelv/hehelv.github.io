<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ğŸ’¤ISpiker
</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta name="author" content="ğŸ’¤ISpiker">
<meta name="description" content="The proof is in the pudding.">
<meta name="keywords" content="The proof is in the pudding.">
<link rel="stylesheet" href="https://hehelv.github.io//media/css/main.css" />
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
<script src="https://hehelv.github.io//media/script/tocbot.min.js"></script>
<script src="https://hehelv.github.io//media/script/script.js"></script>
<!--<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/default.min.css">
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>-->
<script src="https://cdn.bootcss.com/highlight.js/9.13.1/highlight.min.js"></script>
<link href="https://cdn.bootcss.com/highlight.js/9.13.1/styles/atelier-estuary-dark.min.css" rel="stylesheet">
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://hehelv.github.io/">
                    ğŸ’¤ISpiker
                </a>
            </div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        Home
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        Archives
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        Tags
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        About
                    </a>
                    
                    <a class="menu-item" href="/tag/algorithm">
                        Algorithm
                    </a>
                    
                    <a class="menu-item" href="/tag/networking">
                        Computer Networking
                    </a>
                    
                    <a class="menu-item" href="/tag/Spider Note">
                        Spider Note
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://hehelv.github.io/">
                            ğŸ’¤ISpiker
                        </a>
                        <a id="mobile-toggle-theme">&nbsp;Light</a>
                    </div>
                    <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            Home
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            Archives
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            Tags
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            About
                        </a>
                        
                        <a class="menu-item" href="/tag/algorithm">
                            Algorithm
                        </a>
                        
                        <a class="menu-item" href="/tag/networking">
                            Computer Networking
                        </a>
                        
                        <a class="menu-item" href="/tag/Spider Note">
                            Spider Note
                        </a>
                        
                </div>
            </div>
        </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                2-urllibåº“
                            </h1>
                            <div class="post-meta">
                                Author:
                                <a itemprop="author" rel="author" href="/">
                                    ğŸ’¤ISpiker
                                </a>
                                <span class="post-time">
                                Date: <a href="#">2020-02-28</a>
                            </span>
                                
                                    <span class="post-category">
                                Category:
                                
                                <a href="https://hehelv.github.io//tag/Spider Note">Pythonçˆ¬è™«ç¬”è®°</a>
                                
                            </span>
                                    
                            </div>
                        </header>

                        <div class="post-content">
                            <h1 id="2-urllibåº“">2-urllibåº“</h1>
<p><code>urllib</code>åº“æ˜¯<code>Python</code>ä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„ç½‘ç»œè¯·æ±‚åº“ã€‚å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºï¼Œå‘æŒ‡å®šçš„æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶å¯ä»¥ä¿å­˜æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚</p>
<h3 id="urlopenå‡½æ•°">urlopenå‡½æ•°ï¼š</h3>
<p>åœ¨<code>Python3</code>çš„<code>urllib</code>åº“ä¸­ï¼Œæ‰€æœ‰å’Œç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ–¹æ³•ï¼Œéƒ½è¢«é›†åˆ°<code>urllib.request</code>æ¨¡å—ä¸‹é¢äº†ï¼Œä»¥å…ˆæ¥çœ‹ä¸‹<code>urlopen</code>å‡½æ•°åŸºæœ¬çš„ä½¿ç”¨ï¼š</p>
<pre><code class="language-python">from urllib import request
resp = request.urlopen('http://www.baidu.com')
print(resp.read())
</code></pre>
<p>å®é™…ä¸Šï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®ç™¾åº¦ï¼Œå³é”®æŸ¥çœ‹æºä»£ç ã€‚ä½ ä¼šå‘ç°ï¼Œè·Ÿæˆ‘ä»¬åˆšæ‰æ‰“å°å‡ºæ¥çš„æ•°æ®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä¸‰è¡Œä»£ç å°±å·²ç»å¸®æˆ‘ä»¬æŠŠç™¾åº¦çš„é¦–é¡µçš„å…¨éƒ¨ä»£ç çˆ¬ä¸‹æ¥äº†ã€‚ä¸€ä¸ªåŸºæœ¬çš„urlè¯·æ±‚å¯¹åº”çš„pythonä»£ç çœŸçš„éå¸¸ç®€å•ã€‚<br>
ä»¥ä¸‹å¯¹<code>urlopen</code>å‡½æ•°çš„è¿›è¡Œè¯¦ç»†è®²è§£ï¼š</p>
<ol>
<li><code>url</code>ï¼šè¯·æ±‚çš„urlã€‚</li>
<li><code>data</code>ï¼šè¯·æ±‚çš„<code>data</code>ï¼Œå¦‚æœè®¾ç½®äº†è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆå°†å˜æˆ<code>post</code>è¯·æ±‚ã€‚</li>
<li>è¿”å›å€¼ï¼šè¿”å›å€¼æ˜¯ä¸€ä¸ª<code>http.client.HTTPResponse</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªç±»æ–‡ä»¶å¥æŸ„å¯¹è±¡ã€‚æœ‰<code>read(size)</code>ã€<code>readline</code>ã€<code>readlines</code>ä»¥åŠ<code>getcode</code>ç­‰æ–¹æ³•ã€‚</li>
</ol>
<h3 id="urlretrieveå‡½æ•°">urlretrieveå‡½æ•°ï¼š</h3>
<p>è¿™ä¸ªå‡½æ•°å¯ä»¥æ–¹ä¾¿çš„å°†ç½‘é¡µä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ã€‚ä»¥ä¸‹ä»£ç å¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†ç™¾åº¦çš„é¦–é¡µä¸‹è½½åˆ°æœ¬åœ°ï¼š</p>
<pre><code class="language-python">from urllib import request
request.urlretrieve('http://www.baidu.com/','baidu.html')
</code></pre>
<h3 id="urlencodeå‡½æ•°">urlencodeå‡½æ•°ï¼š</h3>
<p>ç”¨æµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœurlä¸­åŒ…å«äº†ä¸­æ–‡æˆ–è€…å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬è¿›è¡Œç¼–ç ã€‚è€Œå¦‚æœä½¿ç”¨ä»£ç å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨çš„è¿›è¡Œç¼–ç ï¼Œè¿™æ—¶å€™å°±åº”è¯¥ä½¿ç”¨<code>urlencode</code>å‡½æ•°æ¥å®ç°ã€‚<code>urlencode</code>å¯ä»¥æŠŠå­—å…¸æ•°æ®è½¬æ¢ä¸º<code>URL</code>ç¼–ç çš„æ•°æ®ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
data = {'name':'çˆ¬è™«åŸºç¡€','greet':'hello world','age':100}
qs = parse.urlencode(data)
print(qs)
</code></pre>
<h3 id="parse_qså‡½æ•°">parse_qså‡½æ•°ï¼š</h3>
<p>å¯ä»¥å°†ç»è¿‡ç¼–ç åçš„urlå‚æ•°è¿›è¡Œè§£ç ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import parse
qs = &quot;name=%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80&amp;greet=hello+world&amp;age=100&quot;
print(parse.parse_qs(qs))
</code></pre>
<h3 id="urlparseå’Œurlsplit">urlparseå’Œurlsplitï¼š</h3>
<p>æœ‰æ—¶å€™æ‹¿åˆ°ä¸€ä¸ªurlï¼Œæƒ³è¦å¯¹è¿™ä¸ªurlä¸­çš„å„ä¸ªç»„æˆéƒ¨åˆ†è¿›è¡Œåˆ†å‰²ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<code>urlparse</code>æˆ–è€…æ˜¯<code>urlsplit</code>æ¥è¿›è¡Œåˆ†å‰²ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse

url = 'http://www.baidu.com/s?username=python'

result = parse.urlsplit(url)
# result = parse.urlparse(url)

print('scheme:',result.scheme)
print('netloc:',result.netloc)
print('path:',result.path)
print('query:',result.query)
</code></pre>
<p><code>urlparse</code>å’Œ<code>urlsplit</code>åŸºæœ¬ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å”¯ä¸€ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œ<code>urlparse</code>é‡Œé¢å¤šäº†ä¸€ä¸ª<code>params</code>å±æ€§ï¼Œè€Œ<code>urlsplit</code>æ²¡æœ‰è¿™ä¸ª<code>params</code>å±æ€§ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª<code>url</code>ä¸ºï¼š<code>url = 'http://www.baidu.com/s;hello?wd=python&amp;username=abc#1'</code>ï¼Œ<br>
é‚£ä¹ˆ<code>urlparse</code>å¯ä»¥è·å–åˆ°<code>hello</code>ï¼Œè€Œ<code>urlsplit</code>ä¸å¯ä»¥è·å–åˆ°ã€‚<code>url</code>ä¸­çš„<code>params</code>ä¹Ÿç”¨å¾—æ¯”è¾ƒå°‘ã€‚</p>
<h3 id="requestrequestç±»">request.Requestç±»ï¼š</h3>
<p>å¦‚æœæƒ³è¦åœ¨è¯·æ±‚çš„æ—¶å€™å¢åŠ ä¸€äº›è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨<code>request.Request</code>ç±»æ¥å®ç°ã€‚æ¯”å¦‚è¦å¢åŠ ä¸€ä¸ª<code>User-Agent</code>ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request(&quot;http://www.baidu.com/&quot;,headers=headers)
resp = request.urlopen(req)
print(resp.read())
</code></pre>
<h3 id="å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸š">å†…æ¶µæ®µå­çˆ¬è™«å®æˆ˜ä½œä¸šï¼š</h3>
<ol>
<li>urlé“¾æ¥ï¼šhttp://neihanshequ.com/bar/1/</li>
<li>è¦æ±‚ï¼šèƒ½çˆ¬å–ä¸€é¡µçš„æ•°æ®å°±å¯ä»¥äº†ã€‚</li>
</ol>
<h3 id="proxyhandlerå¤„ç†å™¨ä»£ç†è®¾ç½®">ProxyHandlerå¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰</h3>
<p>å¾ˆå¤šç½‘ç«™ä¼šæ£€æµ‹æŸä¸€æ®µæ—¶é—´æŸä¸ªIPçš„è®¿é—®æ¬¡æ•°(é€šè¿‡æµé‡ç»Ÿè®¡ï¼Œç³»ç»Ÿæ—¥å¿—ç­‰)ï¼Œå¦‚æœè®¿é—®æ¬¡æ•°å¤šçš„ä¸åƒæ­£å¸¸äººï¼Œå®ƒä¼šç¦æ­¢è¿™ä¸ªIPçš„è®¿é—®ã€‚<br>
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›ä»£ç†æœåŠ¡å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ¢ä¸€ä¸ªä»£ç†ï¼Œå°±ç®—IPè¢«ç¦æ­¢ï¼Œä¾ç„¶å¯ä»¥æ¢ä¸ªIPç»§ç»­çˆ¬å–ã€‚<br>
urllibä¸­é€šè¿‡ProxyHandleræ¥è®¾ç½®ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸‹é¢ä»£ç è¯´æ˜å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰openeræ¥ä½¿ç”¨ä»£ç†ï¼š</p>
<pre><code class="language-python">from urllib import request

# è¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨ä»£ç†çš„
# resp = request.urlopen('http://httpbin.org/get')
# print(resp.read().decode(&quot;utf-8&quot;))

# è¿™ä¸ªæ˜¯ä½¿ç”¨äº†ä»£ç†çš„
handler = request.ProxyHandler({&quot;http&quot;:&quot;218.66.161.88:31769&quot;})

opener = request.build_opener(handler)
req = request.Request(&quot;http://httpbin.org/ip&quot;)
resp = opener.open(req)
print(resp.read())
</code></pre>
<p>å¸¸ç”¨çš„ä»£ç†æœ‰ï¼š</p>
<ul>
<li>è¥¿åˆºå…è´¹ä»£ç†IPï¼šhttp://www.xicidaili.com/</li>
<li>å¿«ä»£ç†ï¼šhttp://www.kuaidaili.com/</li>
<li>ä»£ç†äº‘ï¼šhttp://www.dailiyun.com/</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯cookie">ä»€ä¹ˆæ˜¯cookieï¼š</h3>
<p>åœ¨ç½‘ç«™ä¸­ï¼Œhttpè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å³ä½¿ç¬¬ä¸€æ¬¡å’ŒæœåŠ¡å™¨è¿æ¥åå¹¶ä¸”ç™»å½•æˆåŠŸåï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶ä¸èƒ½çŸ¥é“å½“å‰è¯·æ±‚æ˜¯å“ªä¸ªç”¨æˆ·ã€‚<code>cookie</code>çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ¬¡ç™»å½•åæœåŠ¡å™¨è¿”å›ä¸€äº›æ•°æ®ï¼ˆcookieï¼‰ç»™æµè§ˆå™¨ï¼Œç„¶åæµè§ˆå™¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œå½“è¯¥ç”¨æˆ·å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨çš„æŠŠä¸Šæ¬¡è¯·æ±‚å­˜å‚¨çš„<code>cookie</code>æ•°æ®è‡ªåŠ¨çš„æºå¸¦ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡æµè§ˆå™¨æºå¸¦çš„æ•°æ®å°±èƒ½åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å“ªä¸ªäº†ã€‚<code>cookie</code>å­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å­˜å‚¨å¤§å°ï¼Œä½†ä¸€èˆ¬ä¸è¶…è¿‡4KBã€‚å› æ­¤ä½¿ç”¨<code>cookie</code>åªèƒ½å­˜å‚¨ä¸€äº›å°é‡çš„æ•°æ®ã€‚</p>
<h4 id="cookieçš„æ ¼å¼">cookieçš„æ ¼å¼ï¼š</h4>
<pre><code>Set-Cookie: NAME=VALUEï¼›Expires/Max-age=DATEï¼›Path=PATHï¼›Domain=DOMAIN_NAMEï¼›SECURE
</code></pre>
<p>å‚æ•°æ„ä¹‰ï¼š</p>
<ul>
<li>NAMEï¼šcookieçš„åå­—ã€‚</li>
<li>VALUEï¼šcookieçš„å€¼ã€‚</li>
<li>Expiresï¼šcookieçš„è¿‡æœŸæ—¶é—´ã€‚</li>
<li>Pathï¼šcookieä½œç”¨çš„è·¯å¾„ã€‚</li>
<li>Domainï¼šcookieä½œç”¨çš„åŸŸåã€‚</li>
<li>SECUREï¼šæ˜¯å¦åªåœ¨httpsåè®®ä¸‹èµ·ä½œç”¨ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨cookielibåº“å’Œhttpcookieprocessoræ¨¡æ‹Ÿç™»å½•">ä½¿ç”¨cookielibåº“å’ŒHTTPCookieProcessoræ¨¡æ‹Ÿç™»å½•ï¼š</h3>
<p>Cookie æ˜¯æŒ‡ç½‘ç«™æœåŠ¡å™¨ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½å’Œè¿›è¡ŒSessionè·Ÿè¸ªï¼Œè€Œå‚¨å­˜åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„æ–‡æœ¬æ–‡ä»¶ï¼ŒCookieå¯ä»¥ä¿æŒç™»å½•ä¿¡æ¯åˆ°ç”¨æˆ·ä¸‹æ¬¡ä¸æœåŠ¡å™¨çš„ä¼šè¯ã€‚<br>
è¿™é‡Œä»¥äººäººç½‘ä¸ºä¾‹ã€‚äººäººç½‘ä¸­ï¼Œè¦è®¿é—®æŸä¸ªäººçš„ä¸»é¡µï¼Œå¿…é¡»å…ˆç™»å½•æ‰èƒ½è®¿é—®ï¼Œç™»å½•è¯´ç™½äº†å°±æ˜¯è¦æœ‰cookieä¿¡æ¯ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦ç”¨ä»£ç çš„æ–¹å¼è®¿é—®ï¼Œå°±å¿…é¡»è¦æœ‰æ­£ç¡®çš„cookieä¿¡æ¯æ‰èƒ½è®¿é—®ã€‚è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œç„¶åå°†cookieä¿¡æ¯å¤åˆ¶ä¸‹æ¥ï¼Œæ”¾åˆ°headersä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',
    'Cookie': 'anonymid=jacdwz2x-8bjldx; depovince=GW; _r01_=1; _ga=GA1.2.1455063316.1511436360; _gid=GA1.2.862627163.1511436360; wp=1; JSESSIONID=abczwY8ecd4xz8RJcyP-v; jebecookies=d4497791-9d41-4269-9e2b-3858d4989785|||||; ick_login=884e75d4-f361-4cff-94bb-81fe6c42b220; _de=EA5778F44555C091303554EBBEB4676C696BF75400CE19CC; p=61a3c7d0d4b2d1e991095353f83fa2141; first_login_flag=1; ln_uact=970138074@qq.com; ln_hurl=http://hdn.xnimg.cn/photos/hdn121/20170428/1700/main_nhiB_aebd0000854a1986.jpg; t=3dd84a3117737e819dd2c32f1cdb91d01; societyguester=3dd84a3117737e819dd2c32f1cdb91d01; id=443362311; xnsid=169efdc0; loginfrom=syshome; ch_id=10016; jebe_key=9c062f5a-4335-4a91-bf7a-970f8b86a64e%7Ca022c303305d1b2ab6b5089643e4b5de%7C1511449232839%7C1; wp_fold=0'
}

url = 'http://www.renren.com/880151247/profile'

req = request.Request(url,headers=headers)
resp = request.urlopen(req)
with open('renren.html','w') as fp:
    fp.write(resp.read().decode('utf-8'))
</code></pre>
<p>ä½†æ˜¯æ¯æ¬¡åœ¨è®¿é—®éœ€è¦cookieçš„é¡µé¢éƒ½è¦ä»æµè§ˆå™¨ä¸­å¤åˆ¶cookieæ¯”è¾ƒéº»çƒ¦ã€‚åœ¨Pythonå¤„ç†Cookieï¼Œä¸€èˆ¬æ˜¯é€šè¿‡<code>http.cookiejar</code>æ¨¡å—å’Œ<code>urllibæ¨¡å—çš„HTTPCookieProcessor</code>å¤„ç†å™¨ç±»ä¸€èµ·ä½¿ç”¨ã€‚<code>http.cookiejar</code>æ¨¡å—ä¸»è¦ä½œç”¨æ˜¯æä¾›ç”¨äºå­˜å‚¨cookieçš„å¯¹è±¡ã€‚è€Œ<code>HTTPCookieProcessor</code>å¤„ç†å™¨ä¸»è¦ä½œç”¨æ˜¯å¤„ç†è¿™äº›cookieå¯¹è±¡ï¼Œå¹¶æ„å»ºhandlerå¯¹è±¡ã€‚</p>
<h4 id="httpcookiejaræ¨¡å—">http.cookiejaræ¨¡å—ï¼š</h4>
<p>è¯¥æ¨¡å—ä¸»è¦çš„ç±»æœ‰CookieJarã€FileCookieJarã€MozillaCookieJarã€LWPCookieJarã€‚è¿™å››ä¸ªç±»çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ol>
<li>CookieJarï¼šç®¡ç†HTTP cookieå€¼ã€å­˜å‚¨HTTPè¯·æ±‚ç”Ÿæˆçš„cookieã€å‘ä¼ å‡ºçš„HTTPè¯·æ±‚æ·»åŠ cookieçš„å¯¹è±¡ã€‚æ•´ä¸ªcookieéƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯¹CookieJarå®ä¾‹è¿›è¡Œåƒåœ¾å›æ”¶åcookieä¹Ÿå°†ä¸¢å¤±ã€‚</li>
<li>FileCookieJar (filename,delayload=None,policy=None)ï¼šä»CookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œç”¨æ¥åˆ›å»ºFileCookieJarå®ä¾‹ï¼Œæ£€ç´¢cookieä¿¡æ¯å¹¶å°†cookieå­˜å‚¨åˆ°æ–‡ä»¶ä¸­ã€‚filenameæ˜¯å­˜å‚¨cookieçš„æ–‡ä»¶åã€‚delayloadä¸ºTrueæ—¶æ”¯æŒå»¶è¿Ÿè®¿é—®è®¿é—®æ–‡ä»¶ï¼Œå³åªæœ‰åœ¨éœ€è¦æ—¶æ‰è¯»å–æ–‡ä»¶æˆ–åœ¨æ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®ã€‚</li>
<li>MozillaCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸Mozillaæµè§ˆå™¨ cookies.txtå…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
<li>LWPCookieJar (filename,delayload=None,policy=None)ï¼šä»FileCookieJaræ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸libwww-perlæ ‡å‡†çš„ Set-Cookie3 æ–‡ä»¶æ ¼å¼å…¼å®¹çš„FileCookieJarå®ä¾‹ã€‚</li>
</ol>
<h4 id="ç™»å½•äººäººç½‘">ç™»å½•äººäººç½‘ï¼š</h4>
<p>åˆ©ç”¨<code>http.cookiejar</code>å’Œ<code>request.HTTPCookieProcessor</code>ç™»å½•äººäººç½‘ã€‚ç›¸å…³ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from urllib import request,parse
from http.cookiejar import CookieJar

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}

def get_opener():
    cookiejar = CookieJar()
    handler = request.HTTPCookieProcessor(cookiejar)
    opener = request.build_opener(handler)
    return opener

def login_renren(opener):
    data = {&quot;email&quot;: &quot;970138074@qq.com&quot;, &quot;password&quot;: &quot;pythonspider&quot;}
    data = parse.urlencode(data).encode('utf-8')
    login_url = &quot;http://www.renren.com/PLogin.do&quot;
    req = request.Request(login_url, headers=headers, data=data)
    opener.open(req)

def visit_profile(opener):
    url = 'http://www.renren.com/880151247/profile'
    req = request.Request(url,headers=headers)
    resp = opener.open(req)
    with open('renren.html','w') as fp:
        fp.write(resp.read().decode(&quot;utf-8&quot;))

if __name__ == '__main__':
    opener = get_opener()
    login_renren(opener)
    visit_profile(opener)
</code></pre>
<h4 id="ä¿å­˜cookieåˆ°æœ¬åœ°">ä¿å­˜cookieåˆ°æœ¬åœ°ï¼š</h4>
<p>ä¿å­˜<code>cookie</code>åˆ°æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨<code>cookiejar</code>çš„<code>save</code>æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
cookiejar.save(ignore_discard=True,ignore_expires=True)
</code></pre>
<h4 id="ä»æœ¬åœ°åŠ è½½cookie">ä»æœ¬åœ°åŠ è½½cookieï¼š</h4>
<p>ä»æœ¬åœ°åŠ è½½<code>cookie</code>ï¼Œéœ€è¦ä½¿ç”¨<code>cookiejar</code>çš„<code>load</code>æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿéœ€è¦æŒ‡å®šæ–¹æ³•ï¼š</p>
<pre><code class="language-python">from urllib import request
from http.cookiejar import MozillaCookieJar

cookiejar = MozillaCookieJar(&quot;cookie.txt&quot;)
cookiejar.load(ignore_expires=True,ignore_discard=True)
handler = request.HTTPCookieProcessor(cookiejar)
opener = request.build_opener(handler)

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36'
}
req = request.Request('http://httpbin.org/cookies',headers=headers)

resp = opener.open(req)
print(resp.read())
</code></pre>
<!-- more -->

                        </div>
                        <section class="post-copyright">

                            <p class="copyright-item">
                                <span>Author:</span>
                                <span>ğŸ’¤ISpiker</span>
                            </p>

                            <p class="copyright-item">
                                <span>Permalink:</span>
                                <span><a href="https://hehelv.github.io//post/2-urllib-ku">https://hehelv.github.io//post/2-urllib-ku</a></span>
                            </p>

                            <p class="copyright-item">
                                <span>License:</span>
                                <span>MIT License</span>
                            </p>

                        </section>
                        <section class="post-tags">
                            <div>
                                <span>Tag(s):</span>
                                <span class="tag">
                                
                                
                                <a href="https://hehelv.github.io//tag/Spider Note"># Pythonçˆ¬è™«ç¬”è®°</a>
                                
                                
                            </span>
                            </div>
                            <div>
                                <a href="javascript:window.history.back();">back</a>
                                <span>Â·</span>
                                <a href="#">home</a>
                            </div>
                        </section>
                        <section class="post-nav">
                            
                                <a class="prev" rel="prev" href="https://hehelv.github.io//post/3-requests-ku">
                                    3-requestsåº“
                                </a>
                                
                                    
                                        <a class="next" rel="next" href="https://hehelv.github.io//post/1-http-xie-yi-yu-chrome-zhua-bao-gong-ju">
                                            1-httpåè®®ä¸chromeæŠ“åŒ…å·¥å…·
                                        </a>
                                        
                        </section>

                    </article>
                </div>
                
            </div>
    </div>
    </div>

    </div>
    <footer id="footer" class="footer">
    <div class="copyright">
        

            <script>
                var xhr = new XMLHttpRequest();
                xhr.open('get', 'https://v1.hitokoto.cn');
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        var data = JSON.parse(xhr.responseText);
                        var hitokoto = document.getElementById('hitokoto');
                        hitokoto.innerText = data.hitokoto;
                    }
                }
                xhr.send();
                (function() {
                    var bp = document.createElement('script');
                    var curProtocol = window.location.protocol.split(':')[0];
                    if (curProtocol === 'https') {
                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                    } else {
                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                    }
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(bp, s);
                })();
            </script>
            <b id="hitokoto"></b><br>
            <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face"><path d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z" fill="#93b5cf"></path></svg>
            <script>
                var date = new Date();
                document.write(" " + date.getFullYear() + "å¹´" + (date.getMonth() + 1) + "æœˆ" + date.getDate() + "æ—¥" + " æ˜ŸæœŸ" + "æ—¥ä¸€äºŒä¸‰å››äº”å…­".charAt(date.getDay()));
            </script> Copyright&copy;
            ğŸ’¤ISpiker | Powered by <a href="https://coding.net" target="_blank">Coding.net</a>

    </div>
</footer>
<script>
    hljs.initHighlighting();
</script>
        </div>
</body>

</html>